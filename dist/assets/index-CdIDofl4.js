(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();function ui(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fu={exports:{}},ms={},pu={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jo=Symbol.for("react.element"),jf=Symbol.for("react.portal"),Nf=Symbol.for("react.fragment"),Sf=Symbol.for("react.strict_mode"),Cf=Symbol.for("react.profiler"),Tf=Symbol.for("react.provider"),Ef=Symbol.for("react.context"),If=Symbol.for("react.forward_ref"),Mf=Symbol.for("react.suspense"),Pf=Symbol.for("react.memo"),Rf=Symbol.for("react.lazy"),Dc=Symbol.iterator;function Df(e){return e===null||typeof e!="object"?null:(e=Dc&&e[Dc]||e["@@iterator"],typeof e=="function"?e:null)}var xu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gu=Object.assign,bu={};function to(e,t,n){this.props=e,this.context=t,this.refs=bu,this.updater=n||xu}to.prototype.isReactComponent={};to.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};to.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vu(){}vu.prototype=to.prototype;function hi(e,t,n){this.props=e,this.context=t,this.refs=bu,this.updater=n||xu}var mi=hi.prototype=new vu;mi.constructor=hi;gu(mi,to.prototype);mi.isPureReactComponent=!0;var Lc=Array.isArray,yu=Object.prototype.hasOwnProperty,fi={current:null},wu={key:!0,ref:!0,__self:!0,__source:!0};function ku(e,t,n){var o,a={},s=null,i=null;if(t!=null)for(o in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)yu.call(t,o)&&!wu.hasOwnProperty(o)&&(a[o]=t[o]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(o in c=e.defaultProps,c)a[o]===void 0&&(a[o]=c[o]);return{$$typeof:Jo,type:e,key:s,ref:i,props:a,_owner:fi.current}}function Lf(e,t){return{$$typeof:Jo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function pi(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jo}function $f(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var $c=/\/+/g;function _s(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$f(""+e.key):t.toString(36)}function Pa(e,t,n,o,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Jo:case jf:i=!0}}if(i)return i=e,a=a(i),e=o===""?"."+_s(i,0):o,Lc(a)?(n="",e!=null&&(n=e.replace($c,"$&/")+"/"),Pa(a,t,n,"",function(u){return u})):a!=null&&(pi(a)&&(a=Lf(a,n+(!a.key||i&&i.key===a.key?"":(""+a.key).replace($c,"$&/")+"/")+e)),t.push(a)),1;if(i=0,o=o===""?".":o+":",Lc(e))for(var c=0;c<e.length;c++){s=e[c];var l=o+_s(s,c);i+=Pa(s,t,n,l,a)}else if(l=Df(e),typeof l=="function")for(e=l.call(e),c=0;!(s=e.next()).done;)s=s.value,l=o+_s(s,c++),i+=Pa(s,t,n,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function ia(e,t,n){if(e==null)return e;var o=[],a=0;return Pa(e,o,"","",function(s){return t.call(n,s,a++)}),o}function Af(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var vt={current:null},Ra={transition:null},_f={ReactCurrentDispatcher:vt,ReactCurrentBatchConfig:Ra,ReactCurrentOwner:fi};function ju(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:ia,forEach:function(e,t,n){ia(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ia(e,function(){t++}),t},toArray:function(e){return ia(e,function(t){return t})||[]},only:function(e){if(!pi(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ge.Component=to;ge.Fragment=Nf;ge.Profiler=Cf;ge.PureComponent=hi;ge.StrictMode=Sf;ge.Suspense=Mf;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_f;ge.act=ju;ge.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=gu({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=fi.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)yu.call(t,l)&&!wu.hasOwnProperty(l)&&(o[l]=t[l]===void 0&&c!==void 0?c[l]:t[l])}var l=arguments.length-2;if(l===1)o.children=n;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}return{$$typeof:Jo,type:e.type,key:a,ref:s,props:o,_owner:i}};ge.createContext=function(e){return e={$$typeof:Ef,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Tf,_context:e},e.Consumer=e};ge.createElement=ku;ge.createFactory=function(e){var t=ku.bind(null,e);return t.type=e,t};ge.createRef=function(){return{current:null}};ge.forwardRef=function(e){return{$$typeof:If,render:e}};ge.isValidElement=pi;ge.lazy=function(e){return{$$typeof:Rf,_payload:{_status:-1,_result:e},_init:Af}};ge.memo=function(e,t){return{$$typeof:Pf,type:e,compare:t===void 0?null:t}};ge.startTransition=function(e){var t=Ra.transition;Ra.transition={};try{e()}finally{Ra.transition=t}};ge.unstable_act=ju;ge.useCallback=function(e,t){return vt.current.useCallback(e,t)};ge.useContext=function(e){return vt.current.useContext(e)};ge.useDebugValue=function(){};ge.useDeferredValue=function(e){return vt.current.useDeferredValue(e)};ge.useEffect=function(e,t){return vt.current.useEffect(e,t)};ge.useId=function(){return vt.current.useId()};ge.useImperativeHandle=function(e,t,n){return vt.current.useImperativeHandle(e,t,n)};ge.useInsertionEffect=function(e,t){return vt.current.useInsertionEffect(e,t)};ge.useLayoutEffect=function(e,t){return vt.current.useLayoutEffect(e,t)};ge.useMemo=function(e,t){return vt.current.useMemo(e,t)};ge.useReducer=function(e,t,n){return vt.current.useReducer(e,t,n)};ge.useRef=function(e){return vt.current.useRef(e)};ge.useState=function(e){return vt.current.useState(e)};ge.useSyncExternalStore=function(e,t,n){return vt.current.useSyncExternalStore(e,t,n)};ge.useTransition=function(){return vt.current.useTransition()};ge.version="18.3.1";pu.exports=ge;var T=pu.exports;const xi=ui(T);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Of=T,Wf=Symbol.for("react.element"),Ff=Symbol.for("react.fragment"),Bf=Object.prototype.hasOwnProperty,zf=Of.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Hf={key:!0,ref:!0,__self:!0,__source:!0};function Nu(e,t,n){var o,a={},s=null,i=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(o in t)Bf.call(t,o)&&!Hf.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)a[o]===void 0&&(a[o]=t[o]);return{$$typeof:Wf,type:e,key:s,ref:i,props:a,_owner:zf.current}}ms.Fragment=Ff;ms.jsx=Nu;ms.jsxs=Nu;fu.exports=ms;var r=fu.exports,xl={},Su={exports:{}},$t={},Cu={exports:{}},Tu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(I,L){var Y=I.length;I.push(L);e:for(;0<Y;){var J=Y-1>>>1,$=I[J];if(0<a($,L))I[J]=L,I[Y]=$,Y=J;else break e}}function n(I){return I.length===0?null:I[0]}function o(I){if(I.length===0)return null;var L=I[0],Y=I.pop();if(Y!==L){I[0]=Y;e:for(var J=0,$=I.length,F=$>>>1;J<F;){var X=2*(J+1)-1,oe=I[X],H=X+1,he=I[H];if(0>a(oe,Y))H<$&&0>a(he,oe)?(I[J]=he,I[H]=Y,J=H):(I[J]=oe,I[X]=Y,J=X);else if(H<$&&0>a(he,Y))I[J]=he,I[H]=Y,J=H;else break e}}return L}function a(I,L){var Y=I.sortIndex-L.sortIndex;return Y!==0?Y:I.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,c=i.now();e.unstable_now=function(){return i.now()-c}}var l=[],u=[],h=1,g=null,f=3,w=!1,S=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,d=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(I){for(var L=n(u);L!==null;){if(L.callback===null)o(u);else if(L.startTime<=I)o(u),L.sortIndex=L.expirationTime,t(l,L);else break;L=n(u)}}function k(I){if(y=!1,b(I),!S)if(n(l)!==null)S=!0,V(C);else{var L=n(u);L!==null&&z(k,L.startTime-I)}}function C(I,L){S=!1,y&&(y=!1,m(E),E=-1),w=!0;var Y=f;try{for(b(L),g=n(l);g!==null&&(!(g.expirationTime>L)||I&&!M());){var J=g.callback;if(typeof J=="function"){g.callback=null,f=g.priorityLevel;var $=J(g.expirationTime<=L);L=e.unstable_now(),typeof $=="function"?g.callback=$:g===n(l)&&o(l),b(L)}else o(l);g=n(l)}if(g!==null)var F=!0;else{var X=n(u);X!==null&&z(k,X.startTime-L),F=!1}return F}finally{g=null,f=Y,w=!1}}var x=!1,j=null,E=-1,N=5,p=-1;function M(){return!(e.unstable_now()-p<N)}function P(){if(j!==null){var I=e.unstable_now();p=I;var L=!0;try{L=j(!0,I)}finally{L?A():(x=!1,j=null)}}else x=!1}var A;if(typeof d=="function")A=function(){d(P)};else if(typeof MessageChannel<"u"){var _=new MessageChannel,O=_.port2;_.port1.onmessage=P,A=function(){O.postMessage(null)}}else A=function(){v(P,0)};function V(I){j=I,x||(x=!0,A())}function z(I,L){E=v(function(){I(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_continueExecution=function(){S||w||(S=!0,V(C))},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(I){switch(f){case 1:case 2:case 3:var L=3;break;default:L=f}var Y=f;f=L;try{return I()}finally{f=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(I,L){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var Y=f;f=I;try{return L()}finally{f=Y}},e.unstable_scheduleCallback=function(I,L,Y){var J=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?J+Y:J):Y=J,I){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=Y+$,I={id:h++,callback:L,priorityLevel:I,startTime:Y,expirationTime:$,sortIndex:-1},Y>J?(I.sortIndex=Y,t(u,I),n(l)===null&&I===n(u)&&(y?(m(E),E=-1):y=!0,z(k,Y-J))):(I.sortIndex=$,t(l,I),S||w||(S=!0,V(C))),I},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(I){var L=f;return function(){var Y=f;f=L;try{return I.apply(this,arguments)}finally{f=Y}}}})(Tu);Cu.exports=Tu;var Uf=Cu.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vf=T,Lt=Uf;function ne(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Eu=new Set,Do={};function vn(e,t){Yn(e,t),Yn(e+"Capture",t)}function Yn(e,t){for(Do[e]=t,e=0;e<t.length;e++)Eu.add(t[e])}var yr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gl=Object.prototype.hasOwnProperty,Gf=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ac={},_c={};function Yf(e){return gl.call(_c,e)?!0:gl.call(Ac,e)?!1:Gf.test(e)?_c[e]=!0:(Ac[e]=!0,!1)}function Xf(e,t,n,o){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Kf(e,t,n,o){if(t===null||typeof t>"u"||Xf(e,t,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function yt(e,t,n,o,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var it={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){it[e]=new yt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];it[t]=new yt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){it[e]=new yt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){it[e]=new yt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){it[e]=new yt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){it[e]=new yt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){it[e]=new yt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){it[e]=new yt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){it[e]=new yt(e,5,!1,e.toLowerCase(),null,!1,!1)});var gi=/[\-:]([a-z])/g;function bi(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gi,bi);it[t]=new yt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gi,bi);it[t]=new yt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gi,bi);it[t]=new yt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){it[e]=new yt(e,1,!1,e.toLowerCase(),null,!1,!1)});it.xlinkHref=new yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){it[e]=new yt(e,1,!1,e.toLowerCase(),null,!0,!0)});function vi(e,t,n,o){var a=it.hasOwnProperty(t)?it[t]:null;(a!==null?a.type!==0:o||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Kf(t,n,a,o)&&(n=null),o||a===null?Yf(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,o=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}var Sr=Vf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ca=Symbol.for("react.element"),Tn=Symbol.for("react.portal"),En=Symbol.for("react.fragment"),yi=Symbol.for("react.strict_mode"),bl=Symbol.for("react.profiler"),Iu=Symbol.for("react.provider"),Mu=Symbol.for("react.context"),wi=Symbol.for("react.forward_ref"),vl=Symbol.for("react.suspense"),yl=Symbol.for("react.suspense_list"),ki=Symbol.for("react.memo"),Lr=Symbol.for("react.lazy"),Pu=Symbol.for("react.offscreen"),Oc=Symbol.iterator;function ao(e){return e===null||typeof e!="object"?null:(e=Oc&&e[Oc]||e["@@iterator"],typeof e=="function"?e:null)}var Be=Object.assign,Os;function bo(e){if(Os===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Os=t&&t[1]||""}return`
`+Os+e}var Ws=!1;function Fs(e,t){if(!e||Ws)return"";Ws=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var o=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){o=u}e.call(t.prototype)}else{try{throw Error()}catch(u){o=u}e()}}catch(u){if(u&&o&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=o.stack.split(`
`),i=a.length-1,c=s.length-1;1<=i&&0<=c&&a[i]!==s[c];)c--;for(;1<=i&&0<=c;i--,c--)if(a[i]!==s[c]){if(i!==1||c!==1)do if(i--,c--,0>c||a[i]!==s[c]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=c);break}}}finally{Ws=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?bo(e):""}function Qf(e){switch(e.tag){case 5:return bo(e.type);case 16:return bo("Lazy");case 13:return bo("Suspense");case 19:return bo("SuspenseList");case 0:case 2:case 15:return e=Fs(e.type,!1),e;case 11:return e=Fs(e.type.render,!1),e;case 1:return e=Fs(e.type,!0),e;default:return""}}function wl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case En:return"Fragment";case Tn:return"Portal";case bl:return"Profiler";case yi:return"StrictMode";case vl:return"Suspense";case yl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Mu:return(e.displayName||"Context")+".Consumer";case Iu:return(e._context.displayName||"Context")+".Provider";case wi:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ki:return t=e.displayName||null,t!==null?t:wl(e.type)||"Memo";case Lr:t=e._payload,e=e._init;try{return wl(e(t))}catch{}}return null}function Jf(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wl(t);case 8:return t===yi?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Qr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ru(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function qf(e){var t=Ru(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){o=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(i){o=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function da(e){e._valueTracker||(e._valueTracker=qf(e))}function Du(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=Ru(e)?e.checked?"true":"false":e.value),e=o,e!==n?(t.setValue(e),!0):!1}function Ha(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function kl(e,t){var n=t.checked;return Be({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Wc(e,t){var n=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;n=Qr(t.value!=null?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Lu(e,t){t=t.checked,t!=null&&vi(e,"checked",t,!1)}function jl(e,t){Lu(e,t);var n=Qr(t.value),o=t.type;if(n!=null)o==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nl(e,t.type,n):t.hasOwnProperty("defaultValue")&&Nl(e,t.type,Qr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Fc(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Nl(e,t,n){(t!=="number"||Ha(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var vo=Array.isArray;function Bn(e,t,n,o){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&o&&(e[n].defaultSelected=!0)}else{for(n=""+Qr(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,o&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Sl(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ne(91));return Be({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Bc(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ne(92));if(vo(n)){if(1<n.length)throw Error(ne(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Qr(n)}}function $u(e,t){var n=Qr(t.value),o=Qr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),o!=null&&(e.defaultValue=""+o)}function zc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Au(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Au(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ua,_u=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,o,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,o,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ua=ua||document.createElement("div"),ua.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ua.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Lo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ko={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zf=["Webkit","ms","Moz","O"];Object.keys(ko).forEach(function(e){Zf.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ko[t]=ko[e]})});function Ou(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ko.hasOwnProperty(e)&&ko[e]?(""+t).trim():t+"px"}function Wu(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var o=n.indexOf("--")===0,a=Ou(n,t[n],o);n==="float"&&(n="cssFloat"),o?e.setProperty(n,a):e[n]=a}}var ep=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tl(e,t){if(t){if(ep[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ne(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ne(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ne(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ne(62))}}function El(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Il=null;function ji(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ml=null,zn=null,Hn=null;function Hc(e){if(e=ea(e)){if(typeof Ml!="function")throw Error(ne(280));var t=e.stateNode;t&&(t=bs(t),Ml(e.stateNode,e.type,t))}}function Fu(e){zn?Hn?Hn.push(e):Hn=[e]:zn=e}function Bu(){if(zn){var e=zn,t=Hn;if(Hn=zn=null,Hc(e),t)for(e=0;e<t.length;e++)Hc(t[e])}}function zu(e,t){return e(t)}function Hu(){}var Bs=!1;function Uu(e,t,n){if(Bs)return e(t,n);Bs=!0;try{return zu(e,t,n)}finally{Bs=!1,(zn!==null||Hn!==null)&&(Hu(),Bu())}}function $o(e,t){var n=e.stateNode;if(n===null)return null;var o=bs(n);if(o===null)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ne(231,t,typeof n));return n}var Pl=!1;if(yr)try{var so={};Object.defineProperty(so,"passive",{get:function(){Pl=!0}}),window.addEventListener("test",so,so),window.removeEventListener("test",so,so)}catch{Pl=!1}function tp(e,t,n,o,a,s,i,c,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(h){this.onError(h)}}var jo=!1,Ua=null,Va=!1,Rl=null,rp={onError:function(e){jo=!0,Ua=e}};function np(e,t,n,o,a,s,i,c,l){jo=!1,Ua=null,tp.apply(rp,arguments)}function op(e,t,n,o,a,s,i,c,l){if(np.apply(this,arguments),jo){if(jo){var u=Ua;jo=!1,Ua=null}else throw Error(ne(198));Va||(Va=!0,Rl=u)}}function yn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Vu(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Uc(e){if(yn(e)!==e)throw Error(ne(188))}function ap(e){var t=e.alternate;if(!t){if(t=yn(e),t===null)throw Error(ne(188));return t!==e?null:e}for(var n=e,o=t;;){var a=n.return;if(a===null)break;var s=a.alternate;if(s===null){if(o=a.return,o!==null){n=o;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return Uc(a),e;if(s===o)return Uc(a),t;s=s.sibling}throw Error(ne(188))}if(n.return!==o.return)n=a,o=s;else{for(var i=!1,c=a.child;c;){if(c===n){i=!0,n=a,o=s;break}if(c===o){i=!0,o=a,n=s;break}c=c.sibling}if(!i){for(c=s.child;c;){if(c===n){i=!0,n=s,o=a;break}if(c===o){i=!0,o=s,n=a;break}c=c.sibling}if(!i)throw Error(ne(189))}}if(n.alternate!==o)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?e:t}function Gu(e){return e=ap(e),e!==null?Yu(e):null}function Yu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Yu(e);if(t!==null)return t;e=e.sibling}return null}var Xu=Lt.unstable_scheduleCallback,Vc=Lt.unstable_cancelCallback,sp=Lt.unstable_shouldYield,lp=Lt.unstable_requestPaint,Ge=Lt.unstable_now,ip=Lt.unstable_getCurrentPriorityLevel,Ni=Lt.unstable_ImmediatePriority,Ku=Lt.unstable_UserBlockingPriority,Ga=Lt.unstable_NormalPriority,cp=Lt.unstable_LowPriority,Qu=Lt.unstable_IdlePriority,fs=null,ir=null;function dp(e){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(fs,e,void 0,(e.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:mp,up=Math.log,hp=Math.LN2;function mp(e){return e>>>=0,e===0?32:31-(up(e)/hp|0)|0}var ha=64,ma=4194304;function yo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ya(e,t){var n=e.pendingLanes;if(n===0)return 0;var o=0,a=e.suspendedLanes,s=e.pingedLanes,i=n&268435455;if(i!==0){var c=i&~a;c!==0?o=yo(c):(s&=i,s!==0&&(o=yo(s)))}else i=n&~a,i!==0?o=yo(i):s!==0&&(o=yo(s));if(o===0)return 0;if(t!==0&&t!==o&&!(t&a)&&(a=o&-o,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(o&4&&(o|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)n=31-Kt(t),a=1<<n,o|=e[n],t&=~a;return o}function fp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pp(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Kt(s),c=1<<i,l=a[i];l===-1?(!(c&n)||c&o)&&(a[i]=fp(c,t)):l<=t&&(e.expiredLanes|=c),s&=~c}}function Dl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ju(){var e=ha;return ha<<=1,!(ha&4194240)&&(ha=64),e}function zs(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function qo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Kt(t),e[t]=n}function xp(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-Kt(n),s=1<<a;t[a]=0,o[a]=-1,e[a]=-1,n&=~s}}function Si(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-Kt(n),a=1<<o;a&t|e[o]&t&&(e[o]|=t),n&=~a}}var Ee=0;function qu(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Zu,Ci,eh,th,rh,Ll=!1,fa=[],zr=null,Hr=null,Ur=null,Ao=new Map,_o=new Map,Ar=[],gp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gc(e,t){switch(e){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":Hr=null;break;case"mouseover":case"mouseout":Ur=null;break;case"pointerover":case"pointerout":Ao.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_o.delete(t.pointerId)}}function lo(e,t,n,o,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:s,targetContainers:[a]},t!==null&&(t=ea(t),t!==null&&Ci(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function bp(e,t,n,o,a){switch(t){case"focusin":return zr=lo(zr,e,t,n,o,a),!0;case"dragenter":return Hr=lo(Hr,e,t,n,o,a),!0;case"mouseover":return Ur=lo(Ur,e,t,n,o,a),!0;case"pointerover":var s=a.pointerId;return Ao.set(s,lo(Ao.get(s)||null,e,t,n,o,a)),!0;case"gotpointercapture":return s=a.pointerId,_o.set(s,lo(_o.get(s)||null,e,t,n,o,a)),!0}return!1}function nh(e){var t=ln(e.target);if(t!==null){var n=yn(t);if(n!==null){if(t=n.tag,t===13){if(t=Vu(n),t!==null){e.blockedOn=t,rh(e.priority,function(){eh(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Da(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=$l(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var o=new n.constructor(n.type,n);Il=o,n.target.dispatchEvent(o),Il=null}else return t=ea(n),t!==null&&Ci(t),e.blockedOn=n,!1;t.shift()}return!0}function Yc(e,t,n){Da(e)&&n.delete(t)}function vp(){Ll=!1,zr!==null&&Da(zr)&&(zr=null),Hr!==null&&Da(Hr)&&(Hr=null),Ur!==null&&Da(Ur)&&(Ur=null),Ao.forEach(Yc),_o.forEach(Yc)}function io(e,t){e.blockedOn===t&&(e.blockedOn=null,Ll||(Ll=!0,Lt.unstable_scheduleCallback(Lt.unstable_NormalPriority,vp)))}function Oo(e){function t(a){return io(a,e)}if(0<fa.length){io(fa[0],e);for(var n=1;n<fa.length;n++){var o=fa[n];o.blockedOn===e&&(o.blockedOn=null)}}for(zr!==null&&io(zr,e),Hr!==null&&io(Hr,e),Ur!==null&&io(Ur,e),Ao.forEach(t),_o.forEach(t),n=0;n<Ar.length;n++)o=Ar[n],o.blockedOn===e&&(o.blockedOn=null);for(;0<Ar.length&&(n=Ar[0],n.blockedOn===null);)nh(n),n.blockedOn===null&&Ar.shift()}var Un=Sr.ReactCurrentBatchConfig,Xa=!0;function yp(e,t,n,o){var a=Ee,s=Un.transition;Un.transition=null;try{Ee=1,Ti(e,t,n,o)}finally{Ee=a,Un.transition=s}}function wp(e,t,n,o){var a=Ee,s=Un.transition;Un.transition=null;try{Ee=4,Ti(e,t,n,o)}finally{Ee=a,Un.transition=s}}function Ti(e,t,n,o){if(Xa){var a=$l(e,t,n,o);if(a===null)qs(e,t,o,Ka,n),Gc(e,o);else if(bp(a,e,t,n,o))o.stopPropagation();else if(Gc(e,o),t&4&&-1<gp.indexOf(e)){for(;a!==null;){var s=ea(a);if(s!==null&&Zu(s),s=$l(e,t,n,o),s===null&&qs(e,t,o,Ka,n),s===a)break;a=s}a!==null&&o.stopPropagation()}else qs(e,t,o,null,n)}}var Ka=null;function $l(e,t,n,o){if(Ka=null,e=ji(o),e=ln(e),e!==null)if(t=yn(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Vu(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ka=e,null}function oh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ip()){case Ni:return 1;case Ku:return 4;case Ga:case cp:return 16;case Qu:return 536870912;default:return 16}default:return 16}}var Or=null,Ei=null,La=null;function ah(){if(La)return La;var e,t=Ei,n=t.length,o,a="value"in Or?Or.value:Or.textContent,s=a.length;for(e=0;e<n&&t[e]===a[e];e++);var i=n-e;for(o=1;o<=i&&t[n-o]===a[s-o];o++);return La=a.slice(e,1<o?1-o:void 0)}function $a(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function pa(){return!0}function Xc(){return!1}function At(e){function t(n,o,a,s,i){this._reactName=n,this._targetInst=a,this.type=o,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(s):s[c]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?pa:Xc,this.isPropagationStopped=Xc,this}return Be(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=pa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=pa)},persist:function(){},isPersistent:pa}),t}var ro={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ii=At(ro),Zo=Be({},ro,{view:0,detail:0}),kp=At(Zo),Hs,Us,co,ps=Be({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mi,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==co&&(co&&e.type==="mousemove"?(Hs=e.screenX-co.screenX,Us=e.screenY-co.screenY):Us=Hs=0,co=e),Hs)},movementY:function(e){return"movementY"in e?e.movementY:Us}}),Kc=At(ps),jp=Be({},ps,{dataTransfer:0}),Np=At(jp),Sp=Be({},Zo,{relatedTarget:0}),Vs=At(Sp),Cp=Be({},ro,{animationName:0,elapsedTime:0,pseudoElement:0}),Tp=At(Cp),Ep=Be({},ro,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ip=At(Ep),Mp=Be({},ro,{data:0}),Qc=At(Mp),Pp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Dp[e])?!!t[e]:!1}function Mi(){return Lp}var $p=Be({},Zo,{key:function(e){if(e.key){var t=Pp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=$a(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Rp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mi,charCode:function(e){return e.type==="keypress"?$a(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?$a(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ap=At($p),_p=Be({},ps,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jc=At(_p),Op=Be({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mi}),Wp=At(Op),Fp=Be({},ro,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bp=At(Fp),zp=Be({},ps,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Hp=At(zp),Up=[9,13,27,32],Pi=yr&&"CompositionEvent"in window,No=null;yr&&"documentMode"in document&&(No=document.documentMode);var Vp=yr&&"TextEvent"in window&&!No,sh=yr&&(!Pi||No&&8<No&&11>=No),qc=" ",Zc=!1;function lh(e,t){switch(e){case"keyup":return Up.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ih(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var In=!1;function Gp(e,t){switch(e){case"compositionend":return ih(t);case"keypress":return t.which!==32?null:(Zc=!0,qc);case"textInput":return e=t.data,e===qc&&Zc?null:e;default:return null}}function Yp(e,t){if(In)return e==="compositionend"||!Pi&&lh(e,t)?(e=ah(),La=Ei=Or=null,In=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sh&&t.locale!=="ko"?null:t.data;default:return null}}var Xp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ed(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xp[e.type]:t==="textarea"}function ch(e,t,n,o){Fu(o),t=Qa(t,"onChange"),0<t.length&&(n=new Ii("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var So=null,Wo=null;function Kp(e){yh(e,0)}function xs(e){var t=Rn(e);if(Du(t))return e}function Qp(e,t){if(e==="change")return t}var dh=!1;if(yr){var Gs;if(yr){var Ys="oninput"in document;if(!Ys){var td=document.createElement("div");td.setAttribute("oninput","return;"),Ys=typeof td.oninput=="function"}Gs=Ys}else Gs=!1;dh=Gs&&(!document.documentMode||9<document.documentMode)}function rd(){So&&(So.detachEvent("onpropertychange",uh),Wo=So=null)}function uh(e){if(e.propertyName==="value"&&xs(Wo)){var t=[];ch(t,Wo,e,ji(e)),Uu(Kp,t)}}function Jp(e,t,n){e==="focusin"?(rd(),So=t,Wo=n,So.attachEvent("onpropertychange",uh)):e==="focusout"&&rd()}function qp(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xs(Wo)}function Zp(e,t){if(e==="click")return xs(t)}function ex(e,t){if(e==="input"||e==="change")return xs(t)}function tx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zt=typeof Object.is=="function"?Object.is:tx;function Fo(e,t){if(Zt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var a=n[o];if(!gl.call(t,a)||!Zt(e[a],t[a]))return!1}return!0}function nd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function od(e,t){var n=nd(e);e=0;for(var o;n;){if(n.nodeType===3){if(o=e+n.textContent.length,e<=t&&o>=t)return{node:n,offset:t-e};e=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=nd(n)}}function hh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?hh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function mh(){for(var e=window,t=Ha();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ha(e.document)}return t}function Ri(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function rx(e){var t=mh(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hh(n.ownerDocument.documentElement,n)){if(o!==null&&Ri(n)){if(t=o.start,e=o.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,s=Math.min(o.start,a);o=o.end===void 0?s:Math.min(o.end,a),!e.extend&&s>o&&(a=o,o=s,s=a),a=od(n,s);var i=od(n,o);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>o?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nx=yr&&"documentMode"in document&&11>=document.documentMode,Mn=null,Al=null,Co=null,_l=!1;function ad(e,t,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;_l||Mn==null||Mn!==Ha(o)||(o=Mn,"selectionStart"in o&&Ri(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Co&&Fo(Co,o)||(Co=o,o=Qa(Al,"onSelect"),0<o.length&&(t=new Ii("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=Mn)))}function xa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Pn={animationend:xa("Animation","AnimationEnd"),animationiteration:xa("Animation","AnimationIteration"),animationstart:xa("Animation","AnimationStart"),transitionend:xa("Transition","TransitionEnd")},Xs={},fh={};yr&&(fh=document.createElement("div").style,"AnimationEvent"in window||(delete Pn.animationend.animation,delete Pn.animationiteration.animation,delete Pn.animationstart.animation),"TransitionEvent"in window||delete Pn.transitionend.transition);function gs(e){if(Xs[e])return Xs[e];if(!Pn[e])return e;var t=Pn[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in fh)return Xs[e]=t[n];return e}var ph=gs("animationend"),xh=gs("animationiteration"),gh=gs("animationstart"),bh=gs("transitionend"),vh=new Map,sd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qr(e,t){vh.set(e,t),vn(t,[e])}for(var Ks=0;Ks<sd.length;Ks++){var Qs=sd[Ks],ox=Qs.toLowerCase(),ax=Qs[0].toUpperCase()+Qs.slice(1);qr(ox,"on"+ax)}qr(ph,"onAnimationEnd");qr(xh,"onAnimationIteration");qr(gh,"onAnimationStart");qr("dblclick","onDoubleClick");qr("focusin","onFocus");qr("focusout","onBlur");qr(bh,"onTransitionEnd");Yn("onMouseEnter",["mouseout","mouseover"]);Yn("onMouseLeave",["mouseout","mouseover"]);Yn("onPointerEnter",["pointerout","pointerover"]);Yn("onPointerLeave",["pointerout","pointerover"]);vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vn("onBeforeInput",["compositionend","keypress","textInput","paste"]);vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sx=new Set("cancel close invalid load scroll toggle".split(" ").concat(wo));function ld(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,op(o,t,void 0,e),e.currentTarget=null}function yh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var o=e[n],a=o.event;o=o.listeners;e:{var s=void 0;if(t)for(var i=o.length-1;0<=i;i--){var c=o[i],l=c.instance,u=c.currentTarget;if(c=c.listener,l!==s&&a.isPropagationStopped())break e;ld(a,c,u),s=l}else for(i=0;i<o.length;i++){if(c=o[i],l=c.instance,u=c.currentTarget,c=c.listener,l!==s&&a.isPropagationStopped())break e;ld(a,c,u),s=l}}}if(Va)throw e=Rl,Va=!1,Rl=null,e}function De(e,t){var n=t[zl];n===void 0&&(n=t[zl]=new Set);var o=e+"__bubble";n.has(o)||(wh(t,e,2,!1),n.add(o))}function Js(e,t,n){var o=0;t&&(o|=4),wh(n,e,o,t)}var ga="_reactListening"+Math.random().toString(36).slice(2);function Bo(e){if(!e[ga]){e[ga]=!0,Eu.forEach(function(n){n!=="selectionchange"&&(sx.has(n)||Js(n,!1,e),Js(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ga]||(t[ga]=!0,Js("selectionchange",!1,t))}}function wh(e,t,n,o){switch(oh(t)){case 1:var a=yp;break;case 4:a=wp;break;default:a=Ti}n=a.bind(null,t,n,e),a=void 0,!Pl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),o?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function qs(e,t,n,o,a){var s=o;if(!(t&1)&&!(t&2)&&o!==null)e:for(;;){if(o===null)return;var i=o.tag;if(i===3||i===4){var c=o.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(i===4)for(i=o.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;c!==null;){if(i=ln(c),i===null)return;if(l=i.tag,l===5||l===6){o=s=i;continue e}c=c.parentNode}}o=o.return}Uu(function(){var u=s,h=ji(n),g=[];e:{var f=vh.get(e);if(f!==void 0){var w=Ii,S=e;switch(e){case"keypress":if($a(n)===0)break e;case"keydown":case"keyup":w=Ap;break;case"focusin":S="focus",w=Vs;break;case"focusout":S="blur",w=Vs;break;case"beforeblur":case"afterblur":w=Vs;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Kc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Np;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=Wp;break;case ph:case xh:case gh:w=Tp;break;case bh:w=Bp;break;case"scroll":w=kp;break;case"wheel":w=Hp;break;case"copy":case"cut":case"paste":w=Ip;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Jc}var y=(t&4)!==0,v=!y&&e==="scroll",m=y?f!==null?f+"Capture":null:f;y=[];for(var d=u,b;d!==null;){b=d;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,m!==null&&(k=$o(d,m),k!=null&&y.push(zo(d,k,b)))),v)break;d=d.return}0<y.length&&(f=new w(f,S,null,n,h),g.push({event:f,listeners:y}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",f&&n!==Il&&(S=n.relatedTarget||n.fromElement)&&(ln(S)||S[wr]))break e;if((w||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,w?(S=n.relatedTarget||n.toElement,w=u,S=S?ln(S):null,S!==null&&(v=yn(S),S!==v||S.tag!==5&&S.tag!==6)&&(S=null)):(w=null,S=u),w!==S)){if(y=Kc,k="onMouseLeave",m="onMouseEnter",d="mouse",(e==="pointerout"||e==="pointerover")&&(y=Jc,k="onPointerLeave",m="onPointerEnter",d="pointer"),v=w==null?f:Rn(w),b=S==null?f:Rn(S),f=new y(k,d+"leave",w,n,h),f.target=v,f.relatedTarget=b,k=null,ln(h)===u&&(y=new y(m,d+"enter",S,n,h),y.target=b,y.relatedTarget=v,k=y),v=k,w&&S)t:{for(y=w,m=S,d=0,b=y;b;b=Cn(b))d++;for(b=0,k=m;k;k=Cn(k))b++;for(;0<d-b;)y=Cn(y),d--;for(;0<b-d;)m=Cn(m),b--;for(;d--;){if(y===m||m!==null&&y===m.alternate)break t;y=Cn(y),m=Cn(m)}y=null}else y=null;w!==null&&id(g,f,w,y,!1),S!==null&&v!==null&&id(g,v,S,y,!0)}}e:{if(f=u?Rn(u):window,w=f.nodeName&&f.nodeName.toLowerCase(),w==="select"||w==="input"&&f.type==="file")var C=Qp;else if(ed(f))if(dh)C=ex;else{C=qp;var x=Jp}else(w=f.nodeName)&&w.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=Zp);if(C&&(C=C(e,u))){ch(g,C,n,h);break e}x&&x(e,f,u),e==="focusout"&&(x=f._wrapperState)&&x.controlled&&f.type==="number"&&Nl(f,"number",f.value)}switch(x=u?Rn(u):window,e){case"focusin":(ed(x)||x.contentEditable==="true")&&(Mn=x,Al=u,Co=null);break;case"focusout":Co=Al=Mn=null;break;case"mousedown":_l=!0;break;case"contextmenu":case"mouseup":case"dragend":_l=!1,ad(g,n,h);break;case"selectionchange":if(nx)break;case"keydown":case"keyup":ad(g,n,h)}var j;if(Pi)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else In?lh(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(sh&&n.locale!=="ko"&&(In||E!=="onCompositionStart"?E==="onCompositionEnd"&&In&&(j=ah()):(Or=h,Ei="value"in Or?Or.value:Or.textContent,In=!0)),x=Qa(u,E),0<x.length&&(E=new Qc(E,e,null,n,h),g.push({event:E,listeners:x}),j?E.data=j:(j=ih(n),j!==null&&(E.data=j)))),(j=Vp?Gp(e,n):Yp(e,n))&&(u=Qa(u,"onBeforeInput"),0<u.length&&(h=new Qc("onBeforeInput","beforeinput",null,n,h),g.push({event:h,listeners:u}),h.data=j))}yh(g,t)})}function zo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qa(e,t){for(var n=t+"Capture",o=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=$o(e,n),s!=null&&o.unshift(zo(e,s,a)),s=$o(e,t),s!=null&&o.push(zo(e,s,a))),e=e.return}return o}function Cn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function id(e,t,n,o,a){for(var s=t._reactName,i=[];n!==null&&n!==o;){var c=n,l=c.alternate,u=c.stateNode;if(l!==null&&l===o)break;c.tag===5&&u!==null&&(c=u,a?(l=$o(n,s),l!=null&&i.unshift(zo(n,l,c))):a||(l=$o(n,s),l!=null&&i.push(zo(n,l,c)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var lx=/\r\n?/g,ix=/\u0000|\uFFFD/g;function cd(e){return(typeof e=="string"?e:""+e).replace(lx,`
`).replace(ix,"")}function ba(e,t,n){if(t=cd(t),cd(e)!==t&&n)throw Error(ne(425))}function Ja(){}var Ol=null,Wl=null;function Fl(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bl=typeof setTimeout=="function"?setTimeout:void 0,cx=typeof clearTimeout=="function"?clearTimeout:void 0,dd=typeof Promise=="function"?Promise:void 0,dx=typeof queueMicrotask=="function"?queueMicrotask:typeof dd<"u"?function(e){return dd.resolve(null).then(e).catch(ux)}:Bl;function ux(e){setTimeout(function(){throw e})}function Zs(e,t){var n=t,o=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(o===0){e.removeChild(a),Oo(t);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=a}while(n);Oo(t)}function Vr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ud(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var no=Math.random().toString(36).slice(2),lr="__reactFiber$"+no,Ho="__reactProps$"+no,wr="__reactContainer$"+no,zl="__reactEvents$"+no,hx="__reactListeners$"+no,mx="__reactHandles$"+no;function ln(e){var t=e[lr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[wr]||n[lr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ud(e);e!==null;){if(n=e[lr])return n;e=ud(e)}return t}e=n,n=e.parentNode}return null}function ea(e){return e=e[lr]||e[wr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Rn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ne(33))}function bs(e){return e[Ho]||null}var Hl=[],Dn=-1;function Zr(e){return{current:e}}function Le(e){0>Dn||(e.current=Hl[Dn],Hl[Dn]=null,Dn--)}function Re(e,t){Dn++,Hl[Dn]=e.current,e.current=t}var Jr={},ft=Zr(Jr),St=Zr(!1),mn=Jr;function Xn(e,t){var n=e.type.contextTypes;if(!n)return Jr;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in n)a[s]=t[s];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ct(e){return e=e.childContextTypes,e!=null}function qa(){Le(St),Le(ft)}function hd(e,t,n){if(ft.current!==Jr)throw Error(ne(168));Re(ft,t),Re(St,n)}function kh(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var a in o)if(!(a in t))throw Error(ne(108,Jf(e)||"Unknown",a));return Be({},n,o)}function Za(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Jr,mn=ft.current,Re(ft,e),Re(St,St.current),!0}function md(e,t,n){var o=e.stateNode;if(!o)throw Error(ne(169));n?(e=kh(e,t,mn),o.__reactInternalMemoizedMergedChildContext=e,Le(St),Le(ft),Re(ft,e)):Le(St),Re(St,n)}var xr=null,vs=!1,el=!1;function jh(e){xr===null?xr=[e]:xr.push(e)}function fx(e){vs=!0,jh(e)}function en(){if(!el&&xr!==null){el=!0;var e=0,t=Ee;try{var n=xr;for(Ee=1;e<n.length;e++){var o=n[e];do o=o(!0);while(o!==null)}xr=null,vs=!1}catch(a){throw xr!==null&&(xr=xr.slice(e+1)),Xu(Ni,en),a}finally{Ee=t,el=!1}}return null}var Ln=[],$n=0,es=null,ts=0,Ot=[],Wt=0,fn=null,gr=1,br="";function nn(e,t){Ln[$n++]=ts,Ln[$n++]=es,es=e,ts=t}function Nh(e,t,n){Ot[Wt++]=gr,Ot[Wt++]=br,Ot[Wt++]=fn,fn=e;var o=gr;e=br;var a=32-Kt(o)-1;o&=~(1<<a),n+=1;var s=32-Kt(t)+a;if(30<s){var i=a-a%5;s=(o&(1<<i)-1).toString(32),o>>=i,a-=i,gr=1<<32-Kt(t)+a|n<<a|o,br=s+e}else gr=1<<s|n<<a|o,br=e}function Di(e){e.return!==null&&(nn(e,1),Nh(e,1,0))}function Li(e){for(;e===es;)es=Ln[--$n],Ln[$n]=null,ts=Ln[--$n],Ln[$n]=null;for(;e===fn;)fn=Ot[--Wt],Ot[Wt]=null,br=Ot[--Wt],Ot[Wt]=null,gr=Ot[--Wt],Ot[Wt]=null}var Rt=null,Pt=null,Oe=!1,Xt=null;function Sh(e,t){var n=Ft(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function fd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Rt=e,Pt=Vr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Rt=e,Pt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=fn!==null?{id:gr,overflow:br}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ft(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Rt=e,Pt=null,!0):!1;default:return!1}}function Ul(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Vl(e){if(Oe){var t=Pt;if(t){var n=t;if(!fd(e,t)){if(Ul(e))throw Error(ne(418));t=Vr(n.nextSibling);var o=Rt;t&&fd(e,t)?Sh(o,n):(e.flags=e.flags&-4097|2,Oe=!1,Rt=e)}}else{if(Ul(e))throw Error(ne(418));e.flags=e.flags&-4097|2,Oe=!1,Rt=e}}}function pd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Rt=e}function va(e){if(e!==Rt)return!1;if(!Oe)return pd(e),Oe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Fl(e.type,e.memoizedProps)),t&&(t=Pt)){if(Ul(e))throw Ch(),Error(ne(418));for(;t;)Sh(e,t),t=Vr(t.nextSibling)}if(pd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Pt=Vr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Pt=null}}else Pt=Rt?Vr(e.stateNode.nextSibling):null;return!0}function Ch(){for(var e=Pt;e;)e=Vr(e.nextSibling)}function Kn(){Pt=Rt=null,Oe=!1}function $i(e){Xt===null?Xt=[e]:Xt.push(e)}var px=Sr.ReactCurrentBatchConfig;function uo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var o=n.stateNode}if(!o)throw Error(ne(147,e));var a=o,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var c=a.refs;i===null?delete c[s]:c[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,e))}return e}function ya(e,t){throw e=Object.prototype.toString.call(t),Error(ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xd(e){var t=e._init;return t(e._payload)}function Th(e){function t(m,d){if(e){var b=m.deletions;b===null?(m.deletions=[d],m.flags|=16):b.push(d)}}function n(m,d){if(!e)return null;for(;d!==null;)t(m,d),d=d.sibling;return null}function o(m,d){for(m=new Map;d!==null;)d.key!==null?m.set(d.key,d):m.set(d.index,d),d=d.sibling;return m}function a(m,d){return m=Kr(m,d),m.index=0,m.sibling=null,m}function s(m,d,b){return m.index=b,e?(b=m.alternate,b!==null?(b=b.index,b<d?(m.flags|=2,d):b):(m.flags|=2,d)):(m.flags|=1048576,d)}function i(m){return e&&m.alternate===null&&(m.flags|=2),m}function c(m,d,b,k){return d===null||d.tag!==6?(d=ll(b,m.mode,k),d.return=m,d):(d=a(d,b),d.return=m,d)}function l(m,d,b,k){var C=b.type;return C===En?h(m,d,b.props.children,k,b.key):d!==null&&(d.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Lr&&xd(C)===d.type)?(k=a(d,b.props),k.ref=uo(m,d,b),k.return=m,k):(k=za(b.type,b.key,b.props,null,m.mode,k),k.ref=uo(m,d,b),k.return=m,k)}function u(m,d,b,k){return d===null||d.tag!==4||d.stateNode.containerInfo!==b.containerInfo||d.stateNode.implementation!==b.implementation?(d=il(b,m.mode,k),d.return=m,d):(d=a(d,b.children||[]),d.return=m,d)}function h(m,d,b,k,C){return d===null||d.tag!==7?(d=hn(b,m.mode,k,C),d.return=m,d):(d=a(d,b),d.return=m,d)}function g(m,d,b){if(typeof d=="string"&&d!==""||typeof d=="number")return d=ll(""+d,m.mode,b),d.return=m,d;if(typeof d=="object"&&d!==null){switch(d.$$typeof){case ca:return b=za(d.type,d.key,d.props,null,m.mode,b),b.ref=uo(m,null,d),b.return=m,b;case Tn:return d=il(d,m.mode,b),d.return=m,d;case Lr:var k=d._init;return g(m,k(d._payload),b)}if(vo(d)||ao(d))return d=hn(d,m.mode,b,null),d.return=m,d;ya(m,d)}return null}function f(m,d,b,k){var C=d!==null?d.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:c(m,d,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ca:return b.key===C?l(m,d,b,k):null;case Tn:return b.key===C?u(m,d,b,k):null;case Lr:return C=b._init,f(m,d,C(b._payload),k)}if(vo(b)||ao(b))return C!==null?null:h(m,d,b,k,null);ya(m,b)}return null}function w(m,d,b,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return m=m.get(b)||null,c(d,m,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ca:return m=m.get(k.key===null?b:k.key)||null,l(d,m,k,C);case Tn:return m=m.get(k.key===null?b:k.key)||null,u(d,m,k,C);case Lr:var x=k._init;return w(m,d,b,x(k._payload),C)}if(vo(k)||ao(k))return m=m.get(b)||null,h(d,m,k,C,null);ya(d,k)}return null}function S(m,d,b,k){for(var C=null,x=null,j=d,E=d=0,N=null;j!==null&&E<b.length;E++){j.index>E?(N=j,j=null):N=j.sibling;var p=f(m,j,b[E],k);if(p===null){j===null&&(j=N);break}e&&j&&p.alternate===null&&t(m,j),d=s(p,d,E),x===null?C=p:x.sibling=p,x=p,j=N}if(E===b.length)return n(m,j),Oe&&nn(m,E),C;if(j===null){for(;E<b.length;E++)j=g(m,b[E],k),j!==null&&(d=s(j,d,E),x===null?C=j:x.sibling=j,x=j);return Oe&&nn(m,E),C}for(j=o(m,j);E<b.length;E++)N=w(j,m,E,b[E],k),N!==null&&(e&&N.alternate!==null&&j.delete(N.key===null?E:N.key),d=s(N,d,E),x===null?C=N:x.sibling=N,x=N);return e&&j.forEach(function(M){return t(m,M)}),Oe&&nn(m,E),C}function y(m,d,b,k){var C=ao(b);if(typeof C!="function")throw Error(ne(150));if(b=C.call(b),b==null)throw Error(ne(151));for(var x=C=null,j=d,E=d=0,N=null,p=b.next();j!==null&&!p.done;E++,p=b.next()){j.index>E?(N=j,j=null):N=j.sibling;var M=f(m,j,p.value,k);if(M===null){j===null&&(j=N);break}e&&j&&M.alternate===null&&t(m,j),d=s(M,d,E),x===null?C=M:x.sibling=M,x=M,j=N}if(p.done)return n(m,j),Oe&&nn(m,E),C;if(j===null){for(;!p.done;E++,p=b.next())p=g(m,p.value,k),p!==null&&(d=s(p,d,E),x===null?C=p:x.sibling=p,x=p);return Oe&&nn(m,E),C}for(j=o(m,j);!p.done;E++,p=b.next())p=w(j,m,E,p.value,k),p!==null&&(e&&p.alternate!==null&&j.delete(p.key===null?E:p.key),d=s(p,d,E),x===null?C=p:x.sibling=p,x=p);return e&&j.forEach(function(P){return t(m,P)}),Oe&&nn(m,E),C}function v(m,d,b,k){if(typeof b=="object"&&b!==null&&b.type===En&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case ca:e:{for(var C=b.key,x=d;x!==null;){if(x.key===C){if(C=b.type,C===En){if(x.tag===7){n(m,x.sibling),d=a(x,b.props.children),d.return=m,m=d;break e}}else if(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Lr&&xd(C)===x.type){n(m,x.sibling),d=a(x,b.props),d.ref=uo(m,x,b),d.return=m,m=d;break e}n(m,x);break}else t(m,x);x=x.sibling}b.type===En?(d=hn(b.props.children,m.mode,k,b.key),d.return=m,m=d):(k=za(b.type,b.key,b.props,null,m.mode,k),k.ref=uo(m,d,b),k.return=m,m=k)}return i(m);case Tn:e:{for(x=b.key;d!==null;){if(d.key===x)if(d.tag===4&&d.stateNode.containerInfo===b.containerInfo&&d.stateNode.implementation===b.implementation){n(m,d.sibling),d=a(d,b.children||[]),d.return=m,m=d;break e}else{n(m,d);break}else t(m,d);d=d.sibling}d=il(b,m.mode,k),d.return=m,m=d}return i(m);case Lr:return x=b._init,v(m,d,x(b._payload),k)}if(vo(b))return S(m,d,b,k);if(ao(b))return y(m,d,b,k);ya(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,d!==null&&d.tag===6?(n(m,d.sibling),d=a(d,b),d.return=m,m=d):(n(m,d),d=ll(b,m.mode,k),d.return=m,m=d),i(m)):n(m,d)}return v}var Qn=Th(!0),Eh=Th(!1),rs=Zr(null),ns=null,An=null,Ai=null;function _i(){Ai=An=ns=null}function Oi(e){var t=rs.current;Le(rs),e._currentValue=t}function Gl(e,t,n){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function Vn(e,t){ns=e,Ai=An=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Nt=!0),e.firstContext=null)}function zt(e){var t=e._currentValue;if(Ai!==e)if(e={context:e,memoizedValue:t,next:null},An===null){if(ns===null)throw Error(ne(308));An=e,ns.dependencies={lanes:0,firstContext:e}}else An=An.next=e;return t}var cn=null;function Wi(e){cn===null?cn=[e]:cn.push(e)}function Ih(e,t,n,o){var a=t.interleaved;return a===null?(n.next=n,Wi(t)):(n.next=a.next,a.next=n),t.interleaved=n,kr(e,o)}function kr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var $r=!1;function Fi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mh(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function vr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Gr(e,t,n){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,ke&2){var a=o.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),o.pending=t,kr(e,n)}return a=o.interleaved,a===null?(t.next=t,Wi(o)):(t.next=a.next,a.next=t),o.interleaved=t,kr(e,n)}function Aa(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,Si(e,n)}}function gd(e,t){var n=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var a=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?a=s=i:s=s.next=i,n=n.next}while(n!==null);s===null?a=s=t:s=s.next=t}else a=s=t;n={baseState:o.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:o.shared,effects:o.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function os(e,t,n,o){var a=e.updateQueue;$r=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var l=c,u=l.next;l.next=null,i===null?s=u:i.next=u,i=l;var h=e.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==i&&(c===null?h.firstBaseUpdate=u:c.next=u,h.lastBaseUpdate=l))}if(s!==null){var g=a.baseState;i=0,h=u=l=null,c=s;do{var f=c.lane,w=c.eventTime;if((o&f)===f){h!==null&&(h=h.next={eventTime:w,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var S=e,y=c;switch(f=t,w=n,y.tag){case 1:if(S=y.payload,typeof S=="function"){g=S.call(w,g,f);break e}g=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=y.payload,f=typeof S=="function"?S.call(w,g,f):S,f==null)break e;g=Be({},g,f);break e;case 2:$r=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[c]:f.push(c))}else w={eventTime:w,lane:f,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(u=h=w,l=g):h=h.next=w,i|=f;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;f=c,c=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(h===null&&(l=g),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=h,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);xn|=i,e.lanes=i,e.memoizedState=g}}function bd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],a=o.callback;if(a!==null){if(o.callback=null,o=n,typeof a!="function")throw Error(ne(191,a));a.call(o)}}}var ta={},cr=Zr(ta),Uo=Zr(ta),Vo=Zr(ta);function dn(e){if(e===ta)throw Error(ne(174));return e}function Bi(e,t){switch(Re(Vo,t),Re(Uo,e),Re(cr,ta),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Cl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Cl(t,e)}Le(cr),Re(cr,t)}function Jn(){Le(cr),Le(Uo),Le(Vo)}function Ph(e){dn(Vo.current);var t=dn(cr.current),n=Cl(t,e.type);t!==n&&(Re(Uo,e),Re(cr,n))}function zi(e){Uo.current===e&&(Le(cr),Le(Uo))}var We=Zr(0);function as(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tl=[];function Hi(){for(var e=0;e<tl.length;e++)tl[e]._workInProgressVersionPrimary=null;tl.length=0}var _a=Sr.ReactCurrentDispatcher,rl=Sr.ReactCurrentBatchConfig,pn=0,Fe=null,Ze=null,rt=null,ss=!1,To=!1,Go=0,xx=0;function ct(){throw Error(ne(321))}function Ui(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zt(e[n],t[n]))return!1;return!0}function Vi(e,t,n,o,a,s){if(pn=s,Fe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_a.current=e===null||e.memoizedState===null?yx:wx,e=n(o,a),To){s=0;do{if(To=!1,Go=0,25<=s)throw Error(ne(301));s+=1,rt=Ze=null,t.updateQueue=null,_a.current=kx,e=n(o,a)}while(To)}if(_a.current=ls,t=Ze!==null&&Ze.next!==null,pn=0,rt=Ze=Fe=null,ss=!1,t)throw Error(ne(300));return e}function Gi(){var e=Go!==0;return Go=0,e}function ar(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?Fe.memoizedState=rt=e:rt=rt.next=e,rt}function Ht(){if(Ze===null){var e=Fe.alternate;e=e!==null?e.memoizedState:null}else e=Ze.next;var t=rt===null?Fe.memoizedState:rt.next;if(t!==null)rt=t,Ze=e;else{if(e===null)throw Error(ne(310));Ze=e,e={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},rt===null?Fe.memoizedState=rt=e:rt=rt.next=e}return rt}function Yo(e,t){return typeof t=="function"?t(e):t}function nl(e){var t=Ht(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var o=Ze,a=o.baseQueue,s=n.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}o.baseQueue=a=s,n.pending=null}if(a!==null){s=a.next,o=o.baseState;var c=i=null,l=null,u=s;do{var h=u.lane;if((pn&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),o=u.hasEagerState?u.eagerState:e(o,u.action);else{var g={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(c=l=g,i=o):l=l.next=g,Fe.lanes|=h,xn|=h}u=u.next}while(u!==null&&u!==s);l===null?i=o:l.next=c,Zt(o,t.memoizedState)||(Nt=!0),t.memoizedState=o,t.baseState=i,t.baseQueue=l,n.lastRenderedState=o}if(e=n.interleaved,e!==null){a=e;do s=a.lane,Fe.lanes|=s,xn|=s,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ol(e){var t=Ht(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var o=n.dispatch,a=n.pending,s=t.memoizedState;if(a!==null){n.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Zt(s,t.memoizedState)||(Nt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,o]}function Rh(){}function Dh(e,t){var n=Fe,o=Ht(),a=t(),s=!Zt(o.memoizedState,a);if(s&&(o.memoizedState=a,Nt=!0),o=o.queue,Yi(Ah.bind(null,n,o,e),[e]),o.getSnapshot!==t||s||rt!==null&&rt.memoizedState.tag&1){if(n.flags|=2048,Xo(9,$h.bind(null,n,o,a,t),void 0,null),nt===null)throw Error(ne(349));pn&30||Lh(n,t,a)}return a}function Lh(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $h(e,t,n,o){t.value=n,t.getSnapshot=o,_h(t)&&Oh(e)}function Ah(e,t,n){return n(function(){_h(t)&&Oh(e)})}function _h(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zt(e,n)}catch{return!0}}function Oh(e){var t=kr(e,1);t!==null&&Qt(t,e,1,-1)}function vd(e){var t=ar();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:e},t.queue=e,e=e.dispatch=vx.bind(null,Fe,e),[t.memoizedState,e]}function Xo(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e)),e}function Wh(){return Ht().memoizedState}function Oa(e,t,n,o){var a=ar();Fe.flags|=e,a.memoizedState=Xo(1|t,n,void 0,o===void 0?null:o)}function ys(e,t,n,o){var a=Ht();o=o===void 0?null:o;var s=void 0;if(Ze!==null){var i=Ze.memoizedState;if(s=i.destroy,o!==null&&Ui(o,i.deps)){a.memoizedState=Xo(t,n,s,o);return}}Fe.flags|=e,a.memoizedState=Xo(1|t,n,s,o)}function yd(e,t){return Oa(8390656,8,e,t)}function Yi(e,t){return ys(2048,8,e,t)}function Fh(e,t){return ys(4,2,e,t)}function Bh(e,t){return ys(4,4,e,t)}function zh(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Hh(e,t,n){return n=n!=null?n.concat([e]):null,ys(4,4,zh.bind(null,t,e),n)}function Xi(){}function Uh(e,t){var n=Ht();t=t===void 0?null:t;var o=n.memoizedState;return o!==null&&t!==null&&Ui(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function Vh(e,t){var n=Ht();t=t===void 0?null:t;var o=n.memoizedState;return o!==null&&t!==null&&Ui(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function Gh(e,t,n){return pn&21?(Zt(n,t)||(n=Ju(),Fe.lanes|=n,xn|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Nt=!0),e.memoizedState=n)}function gx(e,t){var n=Ee;Ee=n!==0&&4>n?n:4,e(!0);var o=rl.transition;rl.transition={};try{e(!1),t()}finally{Ee=n,rl.transition=o}}function Yh(){return Ht().memoizedState}function bx(e,t,n){var o=Xr(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},Xh(e))Kh(t,n);else if(n=Ih(e,t,n,o),n!==null){var a=bt();Qt(n,e,o,a),Qh(n,t,o)}}function vx(e,t,n){var o=Xr(e),a={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xh(e))Kh(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,c=s(i,n);if(a.hasEagerState=!0,a.eagerState=c,Zt(c,i)){var l=t.interleaved;l===null?(a.next=a,Wi(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}n=Ih(e,t,a,o),n!==null&&(a=bt(),Qt(n,e,o,a),Qh(n,t,o))}}function Xh(e){var t=e.alternate;return e===Fe||t!==null&&t===Fe}function Kh(e,t){To=ss=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qh(e,t,n){if(n&4194240){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,Si(e,n)}}var ls={readContext:zt,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},yx={readContext:zt,useCallback:function(e,t){return ar().memoizedState=[e,t===void 0?null:t],e},useContext:zt,useEffect:yd,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Oa(4194308,4,zh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oa(4,2,e,t)},useMemo:function(e,t){var n=ar();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=ar();return t=n!==void 0?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=bx.bind(null,Fe,e),[o.memoizedState,e]},useRef:function(e){var t=ar();return e={current:e},t.memoizedState=e},useState:vd,useDebugValue:Xi,useDeferredValue:function(e){return ar().memoizedState=e},useTransition:function(){var e=vd(!1),t=e[0];return e=gx.bind(null,e[1]),ar().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=Fe,a=ar();if(Oe){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=t(),nt===null)throw Error(ne(349));pn&30||Lh(o,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,yd(Ah.bind(null,o,s,e),[e]),o.flags|=2048,Xo(9,$h.bind(null,o,s,n,t),void 0,null),n},useId:function(){var e=ar(),t=nt.identifierPrefix;if(Oe){var n=br,o=gr;n=(o&~(1<<32-Kt(o)-1)).toString(32)+n,t=":"+t+"R"+n,n=Go++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=xx++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},wx={readContext:zt,useCallback:Uh,useContext:zt,useEffect:Yi,useImperativeHandle:Hh,useInsertionEffect:Fh,useLayoutEffect:Bh,useMemo:Vh,useReducer:nl,useRef:Wh,useState:function(){return nl(Yo)},useDebugValue:Xi,useDeferredValue:function(e){var t=Ht();return Gh(t,Ze.memoizedState,e)},useTransition:function(){var e=nl(Yo)[0],t=Ht().memoizedState;return[e,t]},useMutableSource:Rh,useSyncExternalStore:Dh,useId:Yh,unstable_isNewReconciler:!1},kx={readContext:zt,useCallback:Uh,useContext:zt,useEffect:Yi,useImperativeHandle:Hh,useInsertionEffect:Fh,useLayoutEffect:Bh,useMemo:Vh,useReducer:ol,useRef:Wh,useState:function(){return ol(Yo)},useDebugValue:Xi,useDeferredValue:function(e){var t=Ht();return Ze===null?t.memoizedState=e:Gh(t,Ze.memoizedState,e)},useTransition:function(){var e=ol(Yo)[0],t=Ht().memoizedState;return[e,t]},useMutableSource:Rh,useSyncExternalStore:Dh,useId:Yh,unstable_isNewReconciler:!1};function Gt(e,t){if(e&&e.defaultProps){t=Be({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Yl(e,t,n,o){t=e.memoizedState,n=n(o,t),n=n==null?t:Be({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ws={isMounted:function(e){return(e=e._reactInternals)?yn(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=bt(),a=Xr(e),s=vr(o,a);s.payload=t,n!=null&&(s.callback=n),t=Gr(e,s,a),t!==null&&(Qt(t,e,a,o),Aa(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=bt(),a=Xr(e),s=vr(o,a);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=Gr(e,s,a),t!==null&&(Qt(t,e,a,o),Aa(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=bt(),o=Xr(e),a=vr(n,o);a.tag=2,t!=null&&(a.callback=t),t=Gr(e,a,o),t!==null&&(Qt(t,e,o,n),Aa(t,e,o))}};function wd(e,t,n,o,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,s,i):t.prototype&&t.prototype.isPureReactComponent?!Fo(n,o)||!Fo(a,s):!0}function Jh(e,t,n){var o=!1,a=Jr,s=t.contextType;return typeof s=="object"&&s!==null?s=zt(s):(a=Ct(t)?mn:ft.current,o=t.contextTypes,s=(o=o!=null)?Xn(e,a):Jr),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ws,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function kd(e,t,n,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&ws.enqueueReplaceState(t,t.state,null)}function Xl(e,t,n,o){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Fi(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=zt(s):(s=Ct(t)?mn:ft.current,a.context=Xn(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Yl(e,t,s,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&ws.enqueueReplaceState(a,a.state,null),os(e,n,a,o),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function qn(e,t){try{var n="",o=t;do n+=Qf(o),o=o.return;while(o);var a=n}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function al(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Kl(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var jx=typeof WeakMap=="function"?WeakMap:Map;function qh(e,t,n){n=vr(-1,n),n.tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){cs||(cs=!0,ai=o),Kl(e,t)},n}function Zh(e,t,n){n=vr(-1,n),n.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var a=t.value;n.payload=function(){return o(a)},n.callback=function(){Kl(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Kl(e,t),typeof o!="function"&&(Yr===null?Yr=new Set([this]):Yr.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function jd(e,t,n){var o=e.pingCache;if(o===null){o=e.pingCache=new jx;var a=new Set;o.set(t,a)}else a=o.get(t),a===void 0&&(a=new Set,o.set(t,a));a.has(n)||(a.add(n),e=_x.bind(null,e,t,n),t.then(e,e))}function Nd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Sd(e,t,n,o,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=vr(-1,1),t.tag=2,Gr(n,t,1))),n.lanes|=1),e)}var Nx=Sr.ReactCurrentOwner,Nt=!1;function gt(e,t,n,o){t.child=e===null?Eh(t,null,n,o):Qn(t,e.child,n,o)}function Cd(e,t,n,o,a){n=n.render;var s=t.ref;return Vn(t,a),o=Vi(e,t,n,o,s,a),n=Gi(),e!==null&&!Nt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,jr(e,t,a)):(Oe&&n&&Di(t),t.flags|=1,gt(e,t,o,a),t.child)}function Td(e,t,n,o,a){if(e===null){var s=n.type;return typeof s=="function"&&!rc(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,em(e,t,s,o,a)):(e=za(n.type,null,o,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(n=n.compare,n=n!==null?n:Fo,n(i,o)&&e.ref===t.ref)return jr(e,t,a)}return t.flags|=1,e=Kr(s,o),e.ref=t.ref,e.return=t,t.child=e}function em(e,t,n,o,a){if(e!==null){var s=e.memoizedProps;if(Fo(s,o)&&e.ref===t.ref)if(Nt=!1,t.pendingProps=o=s,(e.lanes&a)!==0)e.flags&131072&&(Nt=!0);else return t.lanes=e.lanes,jr(e,t,a)}return Ql(e,t,n,o,a)}function tm(e,t,n){var o=t.pendingProps,a=o.children,s=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Re(On,Mt),Mt|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Re(On,Mt),Mt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=s!==null?s.baseLanes:n,Re(On,Mt),Mt|=o}else s!==null?(o=s.baseLanes|n,t.memoizedState=null):o=n,Re(On,Mt),Mt|=o;return gt(e,t,a,n),t.child}function rm(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ql(e,t,n,o,a){var s=Ct(n)?mn:ft.current;return s=Xn(t,s),Vn(t,a),n=Vi(e,t,n,o,s,a),o=Gi(),e!==null&&!Nt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,jr(e,t,a)):(Oe&&o&&Di(t),t.flags|=1,gt(e,t,n,a),t.child)}function Ed(e,t,n,o,a){if(Ct(n)){var s=!0;Za(t)}else s=!1;if(Vn(t,a),t.stateNode===null)Wa(e,t),Jh(t,n,o),Xl(t,n,o,a),o=!0;else if(e===null){var i=t.stateNode,c=t.memoizedProps;i.props=c;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=zt(u):(u=Ct(n)?mn:ft.current,u=Xn(t,u));var h=n.getDerivedStateFromProps,g=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function";g||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(c!==o||l!==u)&&kd(t,i,o,u),$r=!1;var f=t.memoizedState;i.state=f,os(t,o,i,a),l=t.memoizedState,c!==o||f!==l||St.current||$r?(typeof h=="function"&&(Yl(t,n,h,o),l=t.memoizedState),(c=$r||wd(t,n,c,o,f,l,u))?(g||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=l),i.props=o,i.state=l,i.context=u,o=c):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{i=t.stateNode,Mh(e,t),c=t.memoizedProps,u=t.type===t.elementType?c:Gt(t.type,c),i.props=u,g=t.pendingProps,f=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=zt(l):(l=Ct(n)?mn:ft.current,l=Xn(t,l));var w=n.getDerivedStateFromProps;(h=typeof w=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(c!==g||f!==l)&&kd(t,i,o,l),$r=!1,f=t.memoizedState,i.state=f,os(t,o,i,a);var S=t.memoizedState;c!==g||f!==S||St.current||$r?(typeof w=="function"&&(Yl(t,n,w,o),S=t.memoizedState),(u=$r||wd(t,n,u,o,f,S,l)||!1)?(h||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(o,S,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(o,S,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=S),i.props=o,i.state=S,i.context=l,o=u):(typeof i.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),o=!1)}return Jl(e,t,n,o,s,a)}function Jl(e,t,n,o,a,s){rm(e,t);var i=(t.flags&128)!==0;if(!o&&!i)return a&&md(t,n,!1),jr(e,t,s);o=t.stateNode,Nx.current=t;var c=i&&typeof n.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&i?(t.child=Qn(t,e.child,null,s),t.child=Qn(t,null,c,s)):gt(e,t,c,s),t.memoizedState=o.state,a&&md(t,n,!0),t.child}function nm(e){var t=e.stateNode;t.pendingContext?hd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&hd(e,t.context,!1),Bi(e,t.containerInfo)}function Id(e,t,n,o,a){return Kn(),$i(a),t.flags|=256,gt(e,t,n,o),t.child}var ql={dehydrated:null,treeContext:null,retryLane:0};function Zl(e){return{baseLanes:e,cachePool:null,transitions:null}}function om(e,t,n){var o=t.pendingProps,a=We.current,s=!1,i=(t.flags&128)!==0,c;if((c=i)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Re(We,a&1),e===null)return Vl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=o.children,e=o.fallback,s?(o=t.mode,s=t.child,i={mode:"hidden",children:i},!(o&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Ns(i,o,0,null),e=hn(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Zl(n),t.memoizedState=ql,e):Ki(t,i));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return Sx(e,t,i,o,c,a,n);if(s){s=o.fallback,i=t.mode,a=e.child,c=a.sibling;var l={mode:"hidden",children:o.children};return!(i&1)&&t.child!==a?(o=t.child,o.childLanes=0,o.pendingProps=l,t.deletions=null):(o=Kr(a,l),o.subtreeFlags=a.subtreeFlags&14680064),c!==null?s=Kr(c,s):(s=hn(s,i,n,null),s.flags|=2),s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,i=e.child.memoizedState,i=i===null?Zl(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~n,t.memoizedState=ql,o}return s=e.child,e=s.sibling,o=Kr(s,{mode:"visible",children:o.children}),!(t.mode&1)&&(o.lanes=n),o.return=t,o.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Ki(e,t){return t=Ns({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function wa(e,t,n,o){return o!==null&&$i(o),Qn(t,e.child,null,n),e=Ki(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Sx(e,t,n,o,a,s,i){if(n)return t.flags&256?(t.flags&=-257,o=al(Error(ne(422))),wa(e,t,i,o)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=o.fallback,a=t.mode,o=Ns({mode:"visible",children:o.children},a,0,null),s=hn(s,a,i,null),s.flags|=2,o.return=t,s.return=t,o.sibling=s,t.child=o,t.mode&1&&Qn(t,e.child,null,i),t.child.memoizedState=Zl(i),t.memoizedState=ql,s);if(!(t.mode&1))return wa(e,t,i,null);if(a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var c=o.dgst;return o=c,s=Error(ne(419)),o=al(s,o,void 0),wa(e,t,i,o)}if(c=(i&e.childLanes)!==0,Nt||c){if(o=nt,o!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(o.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,kr(e,a),Qt(o,e,a,-1))}return tc(),o=al(Error(ne(421))),wa(e,t,i,o)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Ox.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Pt=Vr(a.nextSibling),Rt=t,Oe=!0,Xt=null,e!==null&&(Ot[Wt++]=gr,Ot[Wt++]=br,Ot[Wt++]=fn,gr=e.id,br=e.overflow,fn=t),t=Ki(t,o.children),t.flags|=4096,t)}function Md(e,t,n){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),Gl(e.return,t,n)}function sl(e,t,n,o,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=o,s.tail=n,s.tailMode=a)}function am(e,t,n){var o=t.pendingProps,a=o.revealOrder,s=o.tail;if(gt(e,t,o.children,n),o=We.current,o&2)o=o&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Md(e,n,t);else if(e.tag===19)Md(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Re(We,o),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&as(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),sl(t,!1,a,n,s);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&as(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}sl(t,!0,n,null,s);break;case"together":sl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wa(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function jr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),xn|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ne(153));if(t.child!==null){for(e=t.child,n=Kr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Kr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Cx(e,t,n){switch(t.tag){case 3:nm(t),Kn();break;case 5:Ph(t);break;case 1:Ct(t.type)&&Za(t);break;case 4:Bi(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,a=t.memoizedProps.value;Re(rs,o._currentValue),o._currentValue=a;break;case 13:if(o=t.memoizedState,o!==null)return o.dehydrated!==null?(Re(We,We.current&1),t.flags|=128,null):n&t.child.childLanes?om(e,t,n):(Re(We,We.current&1),e=jr(e,t,n),e!==null?e.sibling:null);Re(We,We.current&1);break;case 19:if(o=(n&t.childLanes)!==0,e.flags&128){if(o)return am(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Re(We,We.current),o)break;return null;case 22:case 23:return t.lanes=0,tm(e,t,n)}return jr(e,t,n)}var sm,ei,lm,im;sm=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ei=function(){};lm=function(e,t,n,o){var a=e.memoizedProps;if(a!==o){e=t.stateNode,dn(cr.current);var s=null;switch(n){case"input":a=kl(e,a),o=kl(e,o),s=[];break;case"select":a=Be({},a,{value:void 0}),o=Be({},o,{value:void 0}),s=[];break;case"textarea":a=Sl(e,a),o=Sl(e,o),s=[];break;default:typeof a.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=Ja)}Tl(n,o);var i;n=null;for(u in a)if(!o.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var c=a[u];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Do.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in o){var l=o[u];if(c=a!=null?a[u]:void 0,o.hasOwnProperty(u)&&l!==c&&(l!=null||c!=null))if(u==="style")if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,c=c?c.__html:void 0,l!=null&&c!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Do.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&De("scroll",e),s||c===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};im=function(e,t,n,o){n!==o&&(t.flags|=4)};function ho(e,t){if(!Oe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function dt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,o=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,o|=a.subtreeFlags&14680064,o|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,o|=a.subtreeFlags,o|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function Tx(e,t,n){var o=t.pendingProps;switch(Li(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(t),null;case 1:return Ct(t.type)&&qa(),dt(t),null;case 3:return o=t.stateNode,Jn(),Le(St),Le(ft),Hi(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(va(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Xt!==null&&(ii(Xt),Xt=null))),ei(e,t),dt(t),null;case 5:zi(t);var a=dn(Vo.current);if(n=t.type,e!==null&&t.stateNode!=null)lm(e,t,n,o,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(t.stateNode===null)throw Error(ne(166));return dt(t),null}if(e=dn(cr.current),va(t)){o=t.stateNode,n=t.type;var s=t.memoizedProps;switch(o[lr]=t,o[Ho]=s,e=(t.mode&1)!==0,n){case"dialog":De("cancel",o),De("close",o);break;case"iframe":case"object":case"embed":De("load",o);break;case"video":case"audio":for(a=0;a<wo.length;a++)De(wo[a],o);break;case"source":De("error",o);break;case"img":case"image":case"link":De("error",o),De("load",o);break;case"details":De("toggle",o);break;case"input":Wc(o,s),De("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!s.multiple},De("invalid",o);break;case"textarea":Bc(o,s),De("invalid",o)}Tl(n,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var c=s[i];i==="children"?typeof c=="string"?o.textContent!==c&&(s.suppressHydrationWarning!==!0&&ba(o.textContent,c,e),a=["children",c]):typeof c=="number"&&o.textContent!==""+c&&(s.suppressHydrationWarning!==!0&&ba(o.textContent,c,e),a=["children",""+c]):Do.hasOwnProperty(i)&&c!=null&&i==="onScroll"&&De("scroll",o)}switch(n){case"input":da(o),Fc(o,s,!0);break;case"textarea":da(o),zc(o);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(o.onclick=Ja)}o=a,t.updateQueue=o,o!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Au(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=i.createElement(n,{is:o.is}):(e=i.createElement(n),n==="select"&&(i=e,o.multiple?i.multiple=!0:o.size&&(i.size=o.size))):e=i.createElementNS(e,n),e[lr]=t,e[Ho]=o,sm(e,t,!1,!1),t.stateNode=e;e:{switch(i=El(n,o),n){case"dialog":De("cancel",e),De("close",e),a=o;break;case"iframe":case"object":case"embed":De("load",e),a=o;break;case"video":case"audio":for(a=0;a<wo.length;a++)De(wo[a],e);a=o;break;case"source":De("error",e),a=o;break;case"img":case"image":case"link":De("error",e),De("load",e),a=o;break;case"details":De("toggle",e),a=o;break;case"input":Wc(e,o),a=kl(e,o),De("invalid",e);break;case"option":a=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},a=Be({},o,{value:void 0}),De("invalid",e);break;case"textarea":Bc(e,o),a=Sl(e,o),De("invalid",e);break;default:a=o}Tl(n,a),c=a;for(s in c)if(c.hasOwnProperty(s)){var l=c[s];s==="style"?Wu(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&_u(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Lo(e,l):typeof l=="number"&&Lo(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Do.hasOwnProperty(s)?l!=null&&s==="onScroll"&&De("scroll",e):l!=null&&vi(e,s,l,i))}switch(n){case"input":da(e),Fc(e,o,!1);break;case"textarea":da(e),zc(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Qr(o.value));break;case"select":e.multiple=!!o.multiple,s=o.value,s!=null?Bn(e,!!o.multiple,s,!1):o.defaultValue!=null&&Bn(e,!!o.multiple,o.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ja)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dt(t),null;case 6:if(e&&t.stateNode!=null)im(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(ne(166));if(n=dn(Vo.current),dn(cr.current),va(t)){if(o=t.stateNode,n=t.memoizedProps,o[lr]=t,(s=o.nodeValue!==n)&&(e=Rt,e!==null))switch(e.tag){case 3:ba(o.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ba(o.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[lr]=t,t.stateNode=o}return dt(t),null;case 13:if(Le(We),o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Oe&&Pt!==null&&t.mode&1&&!(t.flags&128))Ch(),Kn(),t.flags|=98560,s=!1;else if(s=va(t),o!==null&&o.dehydrated!==null){if(e===null){if(!s)throw Error(ne(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ne(317));s[lr]=t}else Kn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dt(t),s=!1}else Xt!==null&&(ii(Xt),Xt=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(t.child.flags|=8192,t.mode&1&&(e===null||We.current&1?et===0&&(et=3):tc())),t.updateQueue!==null&&(t.flags|=4),dt(t),null);case 4:return Jn(),ei(e,t),e===null&&Bo(t.stateNode.containerInfo),dt(t),null;case 10:return Oi(t.type._context),dt(t),null;case 17:return Ct(t.type)&&qa(),dt(t),null;case 19:if(Le(We),s=t.memoizedState,s===null)return dt(t),null;if(o=(t.flags&128)!==0,i=s.rendering,i===null)if(o)ho(s,!1);else{if(et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=as(e),i!==null){for(t.flags|=128,ho(s,!1),o=i.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;n!==null;)s=n,e=o,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Re(We,We.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ge()>Zn&&(t.flags|=128,o=!0,ho(s,!1),t.lanes=4194304)}else{if(!o)if(e=as(i),e!==null){if(t.flags|=128,o=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ho(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Oe)return dt(t),null}else 2*Ge()-s.renderingStartTime>Zn&&n!==1073741824&&(t.flags|=128,o=!0,ho(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(n=s.last,n!==null?n.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ge(),t.sibling=null,n=We.current,Re(We,o?n&1|2:n&1),t):(dt(t),null);case 22:case 23:return ec(),o=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(t.flags|=8192),o&&t.mode&1?Mt&1073741824&&(dt(t),t.subtreeFlags&6&&(t.flags|=8192)):dt(t),null;case 24:return null;case 25:return null}throw Error(ne(156,t.tag))}function Ex(e,t){switch(Li(t),t.tag){case 1:return Ct(t.type)&&qa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Jn(),Le(St),Le(ft),Hi(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return zi(t),null;case 13:if(Le(We),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ne(340));Kn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Le(We),null;case 4:return Jn(),null;case 10:return Oi(t.type._context),null;case 22:case 23:return ec(),null;case 24:return null;default:return null}}var ka=!1,mt=!1,Ix=typeof WeakSet=="function"?WeakSet:Set,ie=null;function _n(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){Ue(e,t,o)}else n.current=null}function ti(e,t,n){try{n()}catch(o){Ue(e,t,o)}}var Pd=!1;function Mx(e,t){if(Ol=Xa,e=mh(),Ri(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var a=o.anchorOffset,s=o.focusNode;o=o.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var i=0,c=-1,l=-1,u=0,h=0,g=e,f=null;t:for(;;){for(var w;g!==n||a!==0&&g.nodeType!==3||(c=i+a),g!==s||o!==0&&g.nodeType!==3||(l=i+o),g.nodeType===3&&(i+=g.nodeValue.length),(w=g.firstChild)!==null;)f=g,g=w;for(;;){if(g===e)break t;if(f===n&&++u===a&&(c=i),f===s&&++h===o&&(l=i),(w=g.nextSibling)!==null)break;g=f,f=g.parentNode}g=w}n=c===-1||l===-1?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Wl={focusedElem:e,selectionRange:n},Xa=!1,ie=t;ie!==null;)if(t=ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ie=e;else for(;ie!==null;){t=ie;try{var S=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var y=S.memoizedProps,v=S.memoizedState,m=t.stateNode,d=m.getSnapshotBeforeUpdate(t.elementType===t.type?y:Gt(t.type,y),v);m.__reactInternalSnapshotBeforeUpdate=d}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(k){Ue(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,ie=e;break}ie=t.return}return S=Pd,Pd=!1,S}function Eo(e,t,n){var o=t.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var a=o=o.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&ti(t,n,s)}a=a.next}while(a!==o)}}function ks(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function ri(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function cm(e){var t=e.alternate;t!==null&&(e.alternate=null,cm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[lr],delete t[Ho],delete t[zl],delete t[hx],delete t[mx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dm(e){return e.tag===5||e.tag===3||e.tag===4}function Rd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ni(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ja));else if(o!==4&&(e=e.child,e!==null))for(ni(e,t,n),e=e.sibling;e!==null;)ni(e,t,n),e=e.sibling}function oi(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(oi(e,t,n),e=e.sibling;e!==null;)oi(e,t,n),e=e.sibling}var st=null,Yt=!1;function Mr(e,t,n){for(n=n.child;n!==null;)um(e,t,n),n=n.sibling}function um(e,t,n){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(fs,n)}catch{}switch(n.tag){case 5:mt||_n(n,t);case 6:var o=st,a=Yt;st=null,Mr(e,t,n),st=o,Yt=a,st!==null&&(Yt?(e=st,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):st.removeChild(n.stateNode));break;case 18:st!==null&&(Yt?(e=st,n=n.stateNode,e.nodeType===8?Zs(e.parentNode,n):e.nodeType===1&&Zs(e,n),Oo(e)):Zs(st,n.stateNode));break;case 4:o=st,a=Yt,st=n.stateNode.containerInfo,Yt=!0,Mr(e,t,n),st=o,Yt=a;break;case 0:case 11:case 14:case 15:if(!mt&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){a=o=o.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&ti(n,t,i),a=a.next}while(a!==o)}Mr(e,t,n);break;case 1:if(!mt&&(_n(n,t),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(c){Ue(n,t,c)}Mr(e,t,n);break;case 21:Mr(e,t,n);break;case 22:n.mode&1?(mt=(o=mt)||n.memoizedState!==null,Mr(e,t,n),mt=o):Mr(e,t,n);break;default:Mr(e,t,n)}}function Dd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Ix),t.forEach(function(o){var a=Wx.bind(null,e,o);n.has(o)||(n.add(o),o.then(a,a))})}}function Ut(e,t){var n=t.deletions;if(n!==null)for(var o=0;o<n.length;o++){var a=n[o];try{var s=e,i=t,c=i;e:for(;c!==null;){switch(c.tag){case 5:st=c.stateNode,Yt=!1;break e;case 3:st=c.stateNode.containerInfo,Yt=!0;break e;case 4:st=c.stateNode.containerInfo,Yt=!0;break e}c=c.return}if(st===null)throw Error(ne(160));um(s,i,a),st=null,Yt=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){Ue(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)hm(t,e),t=t.sibling}function hm(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ut(t,e),nr(e),o&4){try{Eo(3,e,e.return),ks(3,e)}catch(y){Ue(e,e.return,y)}try{Eo(5,e,e.return)}catch(y){Ue(e,e.return,y)}}break;case 1:Ut(t,e),nr(e),o&512&&n!==null&&_n(n,n.return);break;case 5:if(Ut(t,e),nr(e),o&512&&n!==null&&_n(n,n.return),e.flags&32){var a=e.stateNode;try{Lo(a,"")}catch(y){Ue(e,e.return,y)}}if(o&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=n!==null?n.memoizedProps:s,c=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{c==="input"&&s.type==="radio"&&s.name!=null&&Lu(a,s),El(c,i);var u=El(c,s);for(i=0;i<l.length;i+=2){var h=l[i],g=l[i+1];h==="style"?Wu(a,g):h==="dangerouslySetInnerHTML"?_u(a,g):h==="children"?Lo(a,g):vi(a,h,g,u)}switch(c){case"input":jl(a,s);break;case"textarea":$u(a,s);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?Bn(a,!!s.multiple,w,!1):f!==!!s.multiple&&(s.defaultValue!=null?Bn(a,!!s.multiple,s.defaultValue,!0):Bn(a,!!s.multiple,s.multiple?[]:"",!1))}a[Ho]=s}catch(y){Ue(e,e.return,y)}}break;case 6:if(Ut(t,e),nr(e),o&4){if(e.stateNode===null)throw Error(ne(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(y){Ue(e,e.return,y)}}break;case 3:if(Ut(t,e),nr(e),o&4&&n!==null&&n.memoizedState.isDehydrated)try{Oo(t.containerInfo)}catch(y){Ue(e,e.return,y)}break;case 4:Ut(t,e),nr(e);break;case 13:Ut(t,e),nr(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(qi=Ge())),o&4&&Dd(e);break;case 22:if(h=n!==null&&n.memoizedState!==null,e.mode&1?(mt=(u=mt)||h,Ut(t,e),mt=u):Ut(t,e),nr(e),o&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(ie=e,h=e.child;h!==null;){for(g=ie=h;ie!==null;){switch(f=ie,w=f.child,f.tag){case 0:case 11:case 14:case 15:Eo(4,f,f.return);break;case 1:_n(f,f.return);var S=f.stateNode;if(typeof S.componentWillUnmount=="function"){o=f,n=f.return;try{t=o,S.props=t.memoizedProps,S.state=t.memoizedState,S.componentWillUnmount()}catch(y){Ue(o,n,y)}}break;case 5:_n(f,f.return);break;case 22:if(f.memoizedState!==null){$d(g);continue}}w!==null?(w.return=f,ie=w):$d(g)}h=h.sibling}e:for(h=null,g=e;;){if(g.tag===5){if(h===null){h=g;try{a=g.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(c=g.stateNode,l=g.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,c.style.display=Ou("display",i))}catch(y){Ue(e,e.return,y)}}}else if(g.tag===6){if(h===null)try{g.stateNode.nodeValue=u?"":g.memoizedProps}catch(y){Ue(e,e.return,y)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;h===g&&(h=null),g=g.return}h===g&&(h=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Ut(t,e),nr(e),o&4&&Dd(e);break;case 21:break;default:Ut(t,e),nr(e)}}function nr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(dm(n)){var o=n;break e}n=n.return}throw Error(ne(160))}switch(o.tag){case 5:var a=o.stateNode;o.flags&32&&(Lo(a,""),o.flags&=-33);var s=Rd(e);oi(e,s,a);break;case 3:case 4:var i=o.stateNode.containerInfo,c=Rd(e);ni(e,c,i);break;default:throw Error(ne(161))}}catch(l){Ue(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Px(e,t,n){ie=e,mm(e)}function mm(e,t,n){for(var o=(e.mode&1)!==0;ie!==null;){var a=ie,s=a.child;if(a.tag===22&&o){var i=a.memoizedState!==null||ka;if(!i){var c=a.alternate,l=c!==null&&c.memoizedState!==null||mt;c=ka;var u=mt;if(ka=i,(mt=l)&&!u)for(ie=a;ie!==null;)i=ie,l=i.child,i.tag===22&&i.memoizedState!==null?Ad(a):l!==null?(l.return=i,ie=l):Ad(a);for(;s!==null;)ie=s,mm(s),s=s.sibling;ie=a,ka=c,mt=u}Ld(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,ie=s):Ld(e)}}function Ld(e){for(;ie!==null;){var t=ie;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:mt||ks(5,t);break;case 1:var o=t.stateNode;if(t.flags&4&&!mt)if(n===null)o.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Gt(t.type,n.memoizedProps);o.componentDidUpdate(a,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&bd(t,s,o);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bd(t,i,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var g=h.dehydrated;g!==null&&Oo(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}mt||t.flags&512&&ri(t)}catch(f){Ue(t,t.return,f)}}if(t===e){ie=null;break}if(n=t.sibling,n!==null){n.return=t.return,ie=n;break}ie=t.return}}function $d(e){for(;ie!==null;){var t=ie;if(t===e){ie=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ie=n;break}ie=t.return}}function Ad(e){for(;ie!==null;){var t=ie;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ks(4,t)}catch(l){Ue(t,n,l)}break;case 1:var o=t.stateNode;if(typeof o.componentDidMount=="function"){var a=t.return;try{o.componentDidMount()}catch(l){Ue(t,a,l)}}var s=t.return;try{ri(t)}catch(l){Ue(t,s,l)}break;case 5:var i=t.return;try{ri(t)}catch(l){Ue(t,i,l)}}}catch(l){Ue(t,t.return,l)}if(t===e){ie=null;break}var c=t.sibling;if(c!==null){c.return=t.return,ie=c;break}ie=t.return}}var Rx=Math.ceil,is=Sr.ReactCurrentDispatcher,Qi=Sr.ReactCurrentOwner,Bt=Sr.ReactCurrentBatchConfig,ke=0,nt=null,Ke=null,lt=0,Mt=0,On=Zr(0),et=0,Ko=null,xn=0,js=0,Ji=0,Io=null,jt=null,qi=0,Zn=1/0,pr=null,cs=!1,ai=null,Yr=null,ja=!1,Wr=null,ds=0,Mo=0,si=null,Fa=-1,Ba=0;function bt(){return ke&6?Ge():Fa!==-1?Fa:Fa=Ge()}function Xr(e){return e.mode&1?ke&2&&lt!==0?lt&-lt:px.transition!==null?(Ba===0&&(Ba=Ju()),Ba):(e=Ee,e!==0||(e=window.event,e=e===void 0?16:oh(e.type)),e):1}function Qt(e,t,n,o){if(50<Mo)throw Mo=0,si=null,Error(ne(185));qo(e,n,o),(!(ke&2)||e!==nt)&&(e===nt&&(!(ke&2)&&(js|=n),et===4&&_r(e,lt)),Tt(e,o),n===1&&ke===0&&!(t.mode&1)&&(Zn=Ge()+500,vs&&en()))}function Tt(e,t){var n=e.callbackNode;pp(e,t);var o=Ya(e,e===nt?lt:0);if(o===0)n!==null&&Vc(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(n!=null&&Vc(n),t===1)e.tag===0?fx(_d.bind(null,e)):jh(_d.bind(null,e)),dx(function(){!(ke&6)&&en()}),n=null;else{switch(qu(o)){case 1:n=Ni;break;case 4:n=Ku;break;case 16:n=Ga;break;case 536870912:n=Qu;break;default:n=Ga}n=wm(n,fm.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function fm(e,t){if(Fa=-1,Ba=0,ke&6)throw Error(ne(327));var n=e.callbackNode;if(Gn()&&e.callbackNode!==n)return null;var o=Ya(e,e===nt?lt:0);if(o===0)return null;if(o&30||o&e.expiredLanes||t)t=us(e,o);else{t=o;var a=ke;ke|=2;var s=xm();(nt!==e||lt!==t)&&(pr=null,Zn=Ge()+500,un(e,t));do try{$x();break}catch(c){pm(e,c)}while(!0);_i(),is.current=s,ke=a,Ke!==null?t=0:(nt=null,lt=0,t=et)}if(t!==0){if(t===2&&(a=Dl(e),a!==0&&(o=a,t=li(e,a))),t===1)throw n=Ko,un(e,0),_r(e,o),Tt(e,Ge()),n;if(t===6)_r(e,o);else{if(a=e.current.alternate,!(o&30)&&!Dx(a)&&(t=us(e,o),t===2&&(s=Dl(e),s!==0&&(o=s,t=li(e,s))),t===1))throw n=Ko,un(e,0),_r(e,o),Tt(e,Ge()),n;switch(e.finishedWork=a,e.finishedLanes=o,t){case 0:case 1:throw Error(ne(345));case 2:on(e,jt,pr);break;case 3:if(_r(e,o),(o&130023424)===o&&(t=qi+500-Ge(),10<t)){if(Ya(e,0)!==0)break;if(a=e.suspendedLanes,(a&o)!==o){bt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Bl(on.bind(null,e,jt,pr),t);break}on(e,jt,pr);break;case 4:if(_r(e,o),(o&4194240)===o)break;for(t=e.eventTimes,a=-1;0<o;){var i=31-Kt(o);s=1<<i,i=t[i],i>a&&(a=i),o&=~s}if(o=a,o=Ge()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Rx(o/1960))-o,10<o){e.timeoutHandle=Bl(on.bind(null,e,jt,pr),o);break}on(e,jt,pr);break;case 5:on(e,jt,pr);break;default:throw Error(ne(329))}}}return Tt(e,Ge()),e.callbackNode===n?fm.bind(null,e):null}function li(e,t){var n=Io;return e.current.memoizedState.isDehydrated&&(un(e,t).flags|=256),e=us(e,t),e!==2&&(t=jt,jt=n,t!==null&&ii(t)),e}function ii(e){jt===null?jt=e:jt.push.apply(jt,e)}function Dx(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var a=n[o],s=a.getSnapshot;a=a.value;try{if(!Zt(s(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function _r(e,t){for(t&=~Ji,t&=~js,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Kt(t),o=1<<n;e[n]=-1,t&=~o}}function _d(e){if(ke&6)throw Error(ne(327));Gn();var t=Ya(e,0);if(!(t&1))return Tt(e,Ge()),null;var n=us(e,t);if(e.tag!==0&&n===2){var o=Dl(e);o!==0&&(t=o,n=li(e,o))}if(n===1)throw n=Ko,un(e,0),_r(e,t),Tt(e,Ge()),n;if(n===6)throw Error(ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,on(e,jt,pr),Tt(e,Ge()),null}function Zi(e,t){var n=ke;ke|=1;try{return e(t)}finally{ke=n,ke===0&&(Zn=Ge()+500,vs&&en())}}function gn(e){Wr!==null&&Wr.tag===0&&!(ke&6)&&Gn();var t=ke;ke|=1;var n=Bt.transition,o=Ee;try{if(Bt.transition=null,Ee=1,e)return e()}finally{Ee=o,Bt.transition=n,ke=t,!(ke&6)&&en()}}function ec(){Mt=On.current,Le(On)}function un(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,cx(n)),Ke!==null)for(n=Ke.return;n!==null;){var o=n;switch(Li(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&qa();break;case 3:Jn(),Le(St),Le(ft),Hi();break;case 5:zi(o);break;case 4:Jn();break;case 13:Le(We);break;case 19:Le(We);break;case 10:Oi(o.type._context);break;case 22:case 23:ec()}n=n.return}if(nt=e,Ke=e=Kr(e.current,null),lt=Mt=t,et=0,Ko=null,Ji=js=xn=0,jt=Io=null,cn!==null){for(t=0;t<cn.length;t++)if(n=cn[t],o=n.interleaved,o!==null){n.interleaved=null;var a=o.next,s=n.pending;if(s!==null){var i=s.next;s.next=a,o.next=i}n.pending=o}cn=null}return e}function pm(e,t){do{var n=Ke;try{if(_i(),_a.current=ls,ss){for(var o=Fe.memoizedState;o!==null;){var a=o.queue;a!==null&&(a.pending=null),o=o.next}ss=!1}if(pn=0,rt=Ze=Fe=null,To=!1,Go=0,Qi.current=null,n===null||n.return===null){et=1,Ko=t,Ke=null;break}e:{var s=e,i=n.return,c=n,l=t;if(t=lt,c.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=c,g=h.tag;if(!(h.mode&1)&&(g===0||g===11||g===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var w=Nd(i);if(w!==null){w.flags&=-257,Sd(w,i,c,s,t),w.mode&1&&jd(s,u,t),t=w,l=u;var S=t.updateQueue;if(S===null){var y=new Set;y.add(l),t.updateQueue=y}else S.add(l);break e}else{if(!(t&1)){jd(s,u,t),tc();break e}l=Error(ne(426))}}else if(Oe&&c.mode&1){var v=Nd(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Sd(v,i,c,s,t),$i(qn(l,c));break e}}s=l=qn(l,c),et!==4&&(et=2),Io===null?Io=[s]:Io.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var m=qh(s,l,t);gd(s,m);break e;case 1:c=l;var d=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof d.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Yr===null||!Yr.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var k=Zh(s,c,t);gd(s,k);break e}}s=s.return}while(s!==null)}bm(n)}catch(C){t=C,Ke===n&&n!==null&&(Ke=n=n.return);continue}break}while(!0)}function xm(){var e=is.current;return is.current=ls,e===null?ls:e}function tc(){(et===0||et===3||et===2)&&(et=4),nt===null||!(xn&268435455)&&!(js&268435455)||_r(nt,lt)}function us(e,t){var n=ke;ke|=2;var o=xm();(nt!==e||lt!==t)&&(pr=null,un(e,t));do try{Lx();break}catch(a){pm(e,a)}while(!0);if(_i(),ke=n,is.current=o,Ke!==null)throw Error(ne(261));return nt=null,lt=0,et}function Lx(){for(;Ke!==null;)gm(Ke)}function $x(){for(;Ke!==null&&!sp();)gm(Ke)}function gm(e){var t=ym(e.alternate,e,Mt);e.memoizedProps=e.pendingProps,t===null?bm(e):Ke=t,Qi.current=null}function bm(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Ex(n,t),n!==null){n.flags&=32767,Ke=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{et=6,Ke=null;return}}else if(n=Tx(n,t,Mt),n!==null){Ke=n;return}if(t=t.sibling,t!==null){Ke=t;return}Ke=t=e}while(t!==null);et===0&&(et=5)}function on(e,t,n){var o=Ee,a=Bt.transition;try{Bt.transition=null,Ee=1,Ax(e,t,n,o)}finally{Bt.transition=a,Ee=o}return null}function Ax(e,t,n,o){do Gn();while(Wr!==null);if(ke&6)throw Error(ne(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ne(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(xp(e,s),e===nt&&(Ke=nt=null,lt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ja||(ja=!0,wm(Ga,function(){return Gn(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Bt.transition,Bt.transition=null;var i=Ee;Ee=1;var c=ke;ke|=4,Qi.current=null,Mx(e,n),hm(n,e),rx(Wl),Xa=!!Ol,Wl=Ol=null,e.current=n,Px(n),lp(),ke=c,Ee=i,Bt.transition=s}else e.current=n;if(ja&&(ja=!1,Wr=e,ds=a),s=e.pendingLanes,s===0&&(Yr=null),dp(n.stateNode),Tt(e,Ge()),t!==null)for(o=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],o(a.value,{componentStack:a.stack,digest:a.digest});if(cs)throw cs=!1,e=ai,ai=null,e;return ds&1&&e.tag!==0&&Gn(),s=e.pendingLanes,s&1?e===si?Mo++:(Mo=0,si=e):Mo=0,en(),null}function Gn(){if(Wr!==null){var e=qu(ds),t=Bt.transition,n=Ee;try{if(Bt.transition=null,Ee=16>e?16:e,Wr===null)var o=!1;else{if(e=Wr,Wr=null,ds=0,ke&6)throw Error(ne(331));var a=ke;for(ke|=4,ie=e.current;ie!==null;){var s=ie,i=s.child;if(ie.flags&16){var c=s.deletions;if(c!==null){for(var l=0;l<c.length;l++){var u=c[l];for(ie=u;ie!==null;){var h=ie;switch(h.tag){case 0:case 11:case 15:Eo(8,h,s)}var g=h.child;if(g!==null)g.return=h,ie=g;else for(;ie!==null;){h=ie;var f=h.sibling,w=h.return;if(cm(h),h===u){ie=null;break}if(f!==null){f.return=w,ie=f;break}ie=w}}}var S=s.alternate;if(S!==null){var y=S.child;if(y!==null){S.child=null;do{var v=y.sibling;y.sibling=null,y=v}while(y!==null)}}ie=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,ie=i;else e:for(;ie!==null;){if(s=ie,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Eo(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,ie=m;break e}ie=s.return}}var d=e.current;for(ie=d;ie!==null;){i=ie;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,ie=b;else e:for(i=d;ie!==null;){if(c=ie,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:ks(9,c)}}catch(C){Ue(c,c.return,C)}if(c===i){ie=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,ie=k;break e}ie=c.return}}if(ke=a,en(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(fs,e)}catch{}o=!0}return o}finally{Ee=n,Bt.transition=t}}return!1}function Od(e,t,n){t=qn(n,t),t=qh(e,t,1),e=Gr(e,t,1),t=bt(),e!==null&&(qo(e,1,t),Tt(e,t))}function Ue(e,t,n){if(e.tag===3)Od(e,e,n);else for(;t!==null;){if(t.tag===3){Od(t,e,n);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Yr===null||!Yr.has(o))){e=qn(n,e),e=Zh(t,e,1),t=Gr(t,e,1),e=bt(),t!==null&&(qo(t,1,e),Tt(t,e));break}}t=t.return}}function _x(e,t,n){var o=e.pingCache;o!==null&&o.delete(t),t=bt(),e.pingedLanes|=e.suspendedLanes&n,nt===e&&(lt&n)===n&&(et===4||et===3&&(lt&130023424)===lt&&500>Ge()-qi?un(e,0):Ji|=n),Tt(e,t)}function vm(e,t){t===0&&(e.mode&1?(t=ma,ma<<=1,!(ma&130023424)&&(ma=4194304)):t=1);var n=bt();e=kr(e,t),e!==null&&(qo(e,t,n),Tt(e,n))}function Ox(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),vm(e,n)}function Wx(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(ne(314))}o!==null&&o.delete(t),vm(e,n)}var ym;ym=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||St.current)Nt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Nt=!1,Cx(e,t,n);Nt=!!(e.flags&131072)}else Nt=!1,Oe&&t.flags&1048576&&Nh(t,ts,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;Wa(e,t),e=t.pendingProps;var a=Xn(t,ft.current);Vn(t,n),a=Vi(null,t,o,e,a,n);var s=Gi();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ct(o)?(s=!0,Za(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Fi(t),a.updater=ws,t.stateNode=a,a._reactInternals=t,Xl(t,o,e,n),t=Jl(null,t,o,!0,s,n)):(t.tag=0,Oe&&s&&Di(t),gt(null,t,a,n),t=t.child),t;case 16:o=t.elementType;e:{switch(Wa(e,t),e=t.pendingProps,a=o._init,o=a(o._payload),t.type=o,a=t.tag=Bx(o),e=Gt(o,e),a){case 0:t=Ql(null,t,o,e,n);break e;case 1:t=Ed(null,t,o,e,n);break e;case 11:t=Cd(null,t,o,e,n);break e;case 14:t=Td(null,t,o,Gt(o.type,e),n);break e}throw Error(ne(306,o,""))}return t;case 0:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:Gt(o,a),Ql(e,t,o,a,n);case 1:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:Gt(o,a),Ed(e,t,o,a,n);case 3:e:{if(nm(t),e===null)throw Error(ne(387));o=t.pendingProps,s=t.memoizedState,a=s.element,Mh(e,t),os(t,o,null,n);var i=t.memoizedState;if(o=i.element,s.isDehydrated)if(s={element:o,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=qn(Error(ne(423)),t),t=Id(e,t,o,n,a);break e}else if(o!==a){a=qn(Error(ne(424)),t),t=Id(e,t,o,n,a);break e}else for(Pt=Vr(t.stateNode.containerInfo.firstChild),Rt=t,Oe=!0,Xt=null,n=Eh(t,null,o,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Kn(),o===a){t=jr(e,t,n);break e}gt(e,t,o,n)}t=t.child}return t;case 5:return Ph(t),e===null&&Vl(t),o=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,Fl(o,a)?i=null:s!==null&&Fl(o,s)&&(t.flags|=32),rm(e,t),gt(e,t,i,n),t.child;case 6:return e===null&&Vl(t),null;case 13:return om(e,t,n);case 4:return Bi(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=Qn(t,null,o,n):gt(e,t,o,n),t.child;case 11:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:Gt(o,a),Cd(e,t,o,a,n);case 7:return gt(e,t,t.pendingProps,n),t.child;case 8:return gt(e,t,t.pendingProps.children,n),t.child;case 12:return gt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Re(rs,o._currentValue),o._currentValue=i,s!==null)if(Zt(s.value,i)){if(s.children===a.children&&!St.current){t=jr(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var c=s.dependencies;if(c!==null){i=s.child;for(var l=c.firstContext;l!==null;){if(l.context===o){if(s.tag===1){l=vr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Gl(s.return,n,t),c.lanes|=n;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(ne(341));i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Gl(i,n,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}gt(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,o=t.pendingProps.children,Vn(t,n),a=zt(a),o=o(a),t.flags|=1,gt(e,t,o,n),t.child;case 14:return o=t.type,a=Gt(o,t.pendingProps),a=Gt(o.type,a),Td(e,t,o,a,n);case 15:return em(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:Gt(o,a),Wa(e,t),t.tag=1,Ct(o)?(e=!0,Za(t)):e=!1,Vn(t,n),Jh(t,o,a),Xl(t,o,a,n),Jl(null,t,o,!0,e,n);case 19:return am(e,t,n);case 22:return tm(e,t,n)}throw Error(ne(156,t.tag))};function wm(e,t){return Xu(e,t)}function Fx(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ft(e,t,n,o){return new Fx(e,t,n,o)}function rc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Bx(e){if(typeof e=="function")return rc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===wi)return 11;if(e===ki)return 14}return 2}function Kr(e,t){var n=e.alternate;return n===null?(n=Ft(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function za(e,t,n,o,a,s){var i=2;if(o=e,typeof e=="function")rc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case En:return hn(n.children,a,s,t);case yi:i=8,a|=8;break;case bl:return e=Ft(12,n,t,a|2),e.elementType=bl,e.lanes=s,e;case vl:return e=Ft(13,n,t,a),e.elementType=vl,e.lanes=s,e;case yl:return e=Ft(19,n,t,a),e.elementType=yl,e.lanes=s,e;case Pu:return Ns(n,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Iu:i=10;break e;case Mu:i=9;break e;case wi:i=11;break e;case ki:i=14;break e;case Lr:i=16,o=null;break e}throw Error(ne(130,e==null?e:typeof e,""))}return t=Ft(i,n,t,a),t.elementType=e,t.type=o,t.lanes=s,t}function hn(e,t,n,o){return e=Ft(7,e,o,t),e.lanes=n,e}function Ns(e,t,n,o){return e=Ft(22,e,o,t),e.elementType=Pu,e.lanes=n,e.stateNode={isHidden:!1},e}function ll(e,t,n){return e=Ft(6,e,null,t),e.lanes=n,e}function il(e,t,n){return t=Ft(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zx(e,t,n,o,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zs(0),this.expirationTimes=zs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zs(0),this.identifierPrefix=o,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function nc(e,t,n,o,a,s,i,c,l){return e=new zx(e,t,n,c,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ft(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fi(s),e}function Hx(e,t,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tn,key:o==null?null:""+o,children:e,containerInfo:t,implementation:n}}function km(e){if(!e)return Jr;e=e._reactInternals;e:{if(yn(e)!==e||e.tag!==1)throw Error(ne(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ct(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ne(171))}if(e.tag===1){var n=e.type;if(Ct(n))return kh(e,n,t)}return t}function jm(e,t,n,o,a,s,i,c,l){return e=nc(n,o,!0,e,a,s,i,c,l),e.context=km(null),n=e.current,o=bt(),a=Xr(n),s=vr(o,a),s.callback=t??null,Gr(n,s,a),e.current.lanes=a,qo(e,a,o),Tt(e,o),e}function Ss(e,t,n,o){var a=t.current,s=bt(),i=Xr(a);return n=km(n),t.context===null?t.context=n:t.pendingContext=n,t=vr(s,i),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),e=Gr(a,t,i),e!==null&&(Qt(e,a,i,s),Aa(e,a,i)),i}function hs(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Wd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function oc(e,t){Wd(e,t),(e=e.alternate)&&Wd(e,t)}function Ux(){return null}var Nm=typeof reportError=="function"?reportError:function(e){console.error(e)};function ac(e){this._internalRoot=e}Cs.prototype.render=ac.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ne(409));Ss(e,t,null,null)};Cs.prototype.unmount=ac.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;gn(function(){Ss(null,e,null,null)}),t[wr]=null}};function Cs(e){this._internalRoot=e}Cs.prototype.unstable_scheduleHydration=function(e){if(e){var t=th();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ar.length&&t!==0&&t<Ar[n].priority;n++);Ar.splice(n,0,e),n===0&&nh(e)}};function sc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ts(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Fd(){}function Vx(e,t,n,o,a){if(a){if(typeof o=="function"){var s=o;o=function(){var u=hs(i);s.call(u)}}var i=jm(t,o,e,0,null,!1,!1,"",Fd);return e._reactRootContainer=i,e[wr]=i.current,Bo(e.nodeType===8?e.parentNode:e),gn(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof o=="function"){var c=o;o=function(){var u=hs(l);c.call(u)}}var l=nc(e,0,!1,null,null,!1,!1,"",Fd);return e._reactRootContainer=l,e[wr]=l.current,Bo(e.nodeType===8?e.parentNode:e),gn(function(){Ss(t,l,n,o)}),l}function Es(e,t,n,o,a){var s=n._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var c=a;a=function(){var l=hs(i);c.call(l)}}Ss(t,i,e,a)}else i=Vx(n,t,e,a,o);return hs(i)}Zu=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=yo(t.pendingLanes);n!==0&&(Si(t,n|1),Tt(t,Ge()),!(ke&6)&&(Zn=Ge()+500,en()))}break;case 13:gn(function(){var o=kr(e,1);if(o!==null){var a=bt();Qt(o,e,1,a)}}),oc(e,1)}};Ci=function(e){if(e.tag===13){var t=kr(e,134217728);if(t!==null){var n=bt();Qt(t,e,134217728,n)}oc(e,134217728)}};eh=function(e){if(e.tag===13){var t=Xr(e),n=kr(e,t);if(n!==null){var o=bt();Qt(n,e,t,o)}oc(e,t)}};th=function(){return Ee};rh=function(e,t){var n=Ee;try{return Ee=e,t()}finally{Ee=n}};Ml=function(e,t,n){switch(t){case"input":if(jl(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var a=bs(o);if(!a)throw Error(ne(90));Du(o),jl(o,a)}}}break;case"textarea":$u(e,n);break;case"select":t=n.value,t!=null&&Bn(e,!!n.multiple,t,!1)}};zu=Zi;Hu=gn;var Gx={usingClientEntryPoint:!1,Events:[ea,Rn,bs,Fu,Bu,Zi]},mo={findFiberByHostInstance:ln,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Yx={bundleType:mo.bundleType,version:mo.version,rendererPackageName:mo.rendererPackageName,rendererConfig:mo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Gu(e),e===null?null:e.stateNode},findFiberByHostInstance:mo.findFiberByHostInstance||Ux,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Na=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Na.isDisabled&&Na.supportsFiber)try{fs=Na.inject(Yx),ir=Na}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gx;$t.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sc(t))throw Error(ne(200));return Hx(e,t,null,n)};$t.createRoot=function(e,t){if(!sc(e))throw Error(ne(299));var n=!1,o="",a=Nm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=nc(e,1,!1,null,null,n,!1,o,a),e[wr]=t.current,Bo(e.nodeType===8?e.parentNode:e),new ac(t)};$t.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ne(188)):(e=Object.keys(e).join(","),Error(ne(268,e)));return e=Gu(t),e=e===null?null:e.stateNode,e};$t.flushSync=function(e){return gn(e)};$t.hydrate=function(e,t,n){if(!Ts(t))throw Error(ne(200));return Es(null,e,t,!0,n)};$t.hydrateRoot=function(e,t,n){if(!sc(e))throw Error(ne(405));var o=n!=null&&n.hydratedSources||null,a=!1,s="",i=Nm;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=jm(t,null,e,1,n??null,a,!1,s,i),e[wr]=t.current,Bo(e),o)for(e=0;e<o.length;e++)n=o[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Cs(t)};$t.render=function(e,t,n){if(!Ts(t))throw Error(ne(200));return Es(null,e,t,!1,n)};$t.unmountComponentAtNode=function(e){if(!Ts(e))throw Error(ne(40));return e._reactRootContainer?(gn(function(){Es(null,null,e,!1,function(){e._reactRootContainer=null,e[wr]=null})}),!0):!1};$t.unstable_batchedUpdates=Zi;$t.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!Ts(n))throw Error(ne(200));if(e==null||e._reactInternals===void 0)throw Error(ne(38));return Es(e,t,n,!1,o)};$t.version="18.3.1-next-f1338f8080-20240426";function Sm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sm)}catch(e){console.error(e)}}Sm(),Su.exports=$t;var er=Su.exports,Bd=er;xl.createRoot=Bd.createRoot,xl.hydrateRoot=Bd.hydrateRoot;const Xx={},zd=e=>{let t;const n=new Set,o=(h,g)=>{const f=typeof h=="function"?h(t):h;if(!Object.is(f,t)){const w=t;t=g??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(S=>S(t,w))}},a=()=>t,l={setState:o,getState:a,getInitialState:()=>u,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(Xx?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(o,a,l);return l},Kx=e=>e?zd(e):zd;var Cm={exports:{}},Tm={},Em={exports:{}},Im={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eo=T;function Qx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Jx=typeof Object.is=="function"?Object.is:Qx,qx=eo.useState,Zx=eo.useEffect,eg=eo.useLayoutEffect,tg=eo.useDebugValue;function rg(e,t){var n=t(),o=qx({inst:{value:n,getSnapshot:t}}),a=o[0].inst,s=o[1];return eg(function(){a.value=n,a.getSnapshot=t,cl(a)&&s({inst:a})},[e,n,t]),Zx(function(){return cl(a)&&s({inst:a}),e(function(){cl(a)&&s({inst:a})})},[e]),tg(n),n}function cl(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Jx(e,n)}catch{return!0}}function ng(e,t){return t()}var og=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ng:rg;Im.useSyncExternalStore=eo.useSyncExternalStore!==void 0?eo.useSyncExternalStore:og;Em.exports=Im;var ag=Em.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Is=T,sg=ag;function lg(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ig=typeof Object.is=="function"?Object.is:lg,cg=sg.useSyncExternalStore,dg=Is.useRef,ug=Is.useEffect,hg=Is.useMemo,mg=Is.useDebugValue;Tm.useSyncExternalStoreWithSelector=function(e,t,n,o,a){var s=dg(null);if(s.current===null){var i={hasValue:!1,value:null};s.current=i}else i=s.current;s=hg(function(){function l(w){if(!u){if(u=!0,h=w,w=o(w),a!==void 0&&i.hasValue){var S=i.value;if(a(S,w))return g=S}return g=w}if(S=g,ig(h,w))return S;var y=o(w);return a!==void 0&&a(S,y)?(h=w,S):(h=w,g=y)}var u=!1,h,g,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,o,a]);var c=cg(e,s[0],s[1]);return ug(function(){i.hasValue=!0,i.value=c},[c]),mg(c),c};Cm.exports=Tm;var fg=Cm.exports;const pg=ui(fg),Mm={},{useDebugValue:xg}=xi,{useSyncExternalStoreWithSelector:gg}=pg;let Hd=!1;const bg=e=>e;function vg(e,t=bg,n){(Mm?"production":void 0)!=="production"&&n&&!Hd&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Hd=!0);const o=gg(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return xg(o),o}const Ud=e=>{(Mm?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Kx(e):e,n=(o,a)=>vg(t,o,a);return Object.assign(n,t),n},Cr=e=>e?Ud(e):Ud;let Sa;const yg=new Uint8Array(16);function wg(){if(!Sa&&(Sa=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Sa))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Sa(yg)}const at=[];for(let e=0;e<256;++e)at.push((e+256).toString(16).slice(1));function kg(e,t=0){return at[e[t+0]]+at[e[t+1]]+at[e[t+2]]+at[e[t+3]]+"-"+at[e[t+4]]+at[e[t+5]]+"-"+at[e[t+6]]+at[e[t+7]]+"-"+at[e[t+8]]+at[e[t+9]]+"-"+at[e[t+10]]+at[e[t+11]]+at[e[t+12]]+at[e[t+13]]+at[e[t+14]]+at[e[t+15]]}const jg=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Vd={randomUUID:jg};function Pe(e,t,n){if(Vd.randomUUID&&!e)return Vd.randomUUID();e=e||{};const o=e.random||(e.rng||wg)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,kg(o)}const Ng=50,Sg=300,sn=Cr((e,t)=>({past:[],future:[],isUndoRedoing:!1,takeSnapshot:(n,o,a)=>{const s=t();if(s.isUndoRedoing)return;const i=Date.now(),c=s.past.filter(u=>u.characterId===n).pop();if(c&&i-c.timestamp<Sg)return;const l={characterId:n,character:JSON.parse(JSON.stringify(o)),actionDescription:a,timestamp:i};e(u=>{const h=[...u.past,l];return h.length>Ng&&h.shift(),{past:h,future:u.future.filter(g=>g.characterId!==n)}})},undo:(n,o)=>{const s=t().past.filter(l=>l.characterId===n);if(s.length===0)return null;const i=s[s.length-1],c={characterId:n,character:JSON.parse(JSON.stringify(o)),actionDescription:"redo point",timestamp:Date.now()};return e(l=>({past:l.past.filter((u,h,g)=>!(u.characterId===n&&g.slice(h+1).filter(w=>w.characterId===n).length===0)),future:[...l.future,c]})),i.character},redo:(n,o)=>{const s=t().future.filter(l=>l.characterId===n);if(s.length===0)return null;const i=s[s.length-1],c={characterId:n,character:JSON.parse(JSON.stringify(o)),actionDescription:"undo point",timestamp:Date.now()};return e(l=>({past:[...l.past,c],future:l.future.filter((u,h,g)=>!(u.characterId===n&&g.slice(h+1).filter(w=>w.characterId===n).length===0))})),i.character},canUndo:n=>t().past.some(a=>a.characterId===n),canRedo:n=>t().future.some(a=>a.characterId===n),clearHistory:n=>{e(o=>({past:o.past.filter(a=>a.characterId!==n),future:o.future.filter(a=>a.characterId!==n)}))},clearAllHistory:()=>{e({past:[],future:[]})},setIsUndoRedoing:n=>{e({isUndoRedoing:n})}}));function Cg(e){return{...e,sheets:e.sheets.map(t=>({...t,widgets:t.widgets.map(n=>Tg(n))}))}}function Tg(e){return e.type==="IMAGE"?{...e,data:{...e.data,imageUrl:void 0}}:e.type==="MAP_SKETCHER"&&e.data.mapShapes?{...e,data:{...e.data,mapShapes:[]}}:e}const Gd="ucs:telemetry",Eg="https://script.google.com/macros/s/AKfycbyRj89srSi2oUB3ZYNkhALCf5LkAXVzzm5P4L2jYkWBmcB-8JLk9aUXfUtRW5XlZEPMYQ/exec",Ig=24*60*60*1e3,Mg=Cr((e,t)=>({lastSent:(()=>{try{const o=localStorage.getItem(Gd);return o?JSON.parse(o):{lastSent:{}}}catch(o){return console.error("Failed to load telemetry state",o),{lastSent:{}}}})().lastSent,shouldSend:o=>{const a=t().lastSent[o];return a?Date.now()-a>Ig:!0},sendTelemetry:o=>{const{shouldSend:a,lastSent:s}=t();if(!a(o.id))return;const i=Cg(o),c={...s,[o.id]:Date.now()};e({lastSent:c});try{localStorage.setItem(Gd,JSON.stringify({lastSent:c}))}catch(l){console.error("Failed to persist telemetry state",l)}fetch(Eg,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).catch(l=>{console.debug("Telemetry send failed (this is okay):",l)})}}));function or(e){const t=e.sheets.find(n=>n.id===e.activeSheetId);return(t==null?void 0:t.widgets)||[]}function He(e,t){return{...e,sheets:e.sheets.map(n=>n.id===e.activeSheetId?{...n,widgets:t(n.widgets)}:n)}}function dl(e){var s;const t=new Map,n=new Map,o=new Map;e.sheets.forEach(i=>{t.set(i.id,Pe()),i.widgets.forEach(c=>{n.set(c.id,Pe()),c.groupId&&!o.has(c.groupId)&&o.set(c.groupId,Pe())})});const a=e.sheets.map(i=>({...i,id:t.get(i.id),widgets:i.widgets.map(c=>{var l;return{...c,id:n.get(c.id),groupId:c.groupId?o.get(c.groupId):void 0,attachedTo:(l=c.attachedTo)==null?void 0:l.map(u=>n.get(u)||u)}})}));return{sheets:a,activeSheetId:t.get(e.activeSheetId)||((s=a[0])==null?void 0:s.id)}}function Pg(e){if(e.sheets&&e.sheets.length>0)return e;const t={id:Pe(),name:"Main",widgets:e.widgets||[]};return{id:e.id,name:e.name,theme:e.theme,sheets:[t],activeSheetId:t.id}}const q=Cr((e,t)=>{const n=(()=>{try{const c=localStorage.getItem("ucs:store");if(!c)return null;const l=JSON.parse(c);return{characters:l.characters.map(Pg),activeCharacterId:l.activeCharacterId,mode:l.mode}}catch(c){return console.error("Failed to load persisted store",c),null}})(),o=(n==null?void 0:n.characters)??[],a=(n==null?void 0:n.activeCharacterId)??null,s=(n==null?void 0:n.mode)??"play";return{characters:o,activeCharacterId:a,mode:s,editingWidgetId:null,selectedWidgetId:null,createCharacter:c=>e(l=>{const u={id:Pe(),name:"Main",widgets:[]},h={id:Pe(),name:c,sheets:[u],activeSheetId:u.id};return{characters:[...l.characters,h],activeCharacterId:h.id,mode:l.mode==="vertical"?"vertical":"play"}}),createCharacterFromPreset:(c,l)=>e(u=>{const{sheets:h,activeSheetId:g}=dl(c),f={id:Pe(),name:l||c.name,theme:c.theme,sheets:h,activeSheetId:g};return{characters:[...u.characters,f],activeCharacterId:f.id,mode:u.mode==="vertical"?"vertical":"play"}}),importCharacter:c=>e(l=>{const{sheets:u,activeSheetId:h}=dl(c),g={...c,id:Pe(),name:c.name,sheets:u,activeSheetId:h};return{characters:[...l.characters,g]}}),duplicateCharacter:c=>e(l=>{const u=l.characters.find(w=>w.id===c);if(!u)return l;const{sheets:h,activeSheetId:g}=dl(u),f={...u,id:Pe(),name:`${u.name} (copy)`,sheets:h,activeSheetId:g};return{characters:[...l.characters,f]}}),selectCharacter:c=>e(l=>({activeCharacterId:c,mode:l.mode==="vertical"?"vertical":"play"})),deleteCharacter:c=>e(l=>({characters:l.characters.filter(u=>u.id!==c),activeCharacterId:l.activeCharacterId===c?null:l.activeCharacterId})),updateCharacterName:(c,l)=>e(u=>({characters:u.characters.map(h=>h.id===c?{...h,name:l}:h)})),updateCharacterTheme:(c,l)=>e(u=>({characters:u.characters.map(h=>h.id===c?{...h,theme:l}:h)})),setMode:c=>e({mode:c,selectedWidgetId:null}),setEditingWidgetId:c=>e({editingWidgetId:c}),setSelectedWidgetId:c=>e({selectedWidgetId:c}),createSheet:c=>e(l=>{if(!l.activeCharacterId)return l;const u={id:Pe(),name:c,widgets:[]};return{characters:l.characters.map(h=>h.id===l.activeCharacterId?{...h,sheets:[...h.sheets,u],activeSheetId:u.id}:h)}}),selectSheet:c=>e(l=>l.activeCharacterId?{characters:l.characters.map(u=>u.id===l.activeCharacterId?{...u,activeSheetId:c}:u)}:l),deleteSheet:c=>{t()._takeSnapshot("Delete sheet"),e(l=>l.activeCharacterId?{characters:l.characters.map(u=>{if(u.id!==l.activeCharacterId||u.sheets.length<=1)return u;const h=u.sheets.filter(f=>f.id!==c),g=u.activeSheetId===c?h[0].id:u.activeSheetId;return{...u,sheets:h,activeSheetId:g}})}:l)},renameSheet:(c,l)=>e(u=>u.activeCharacterId?{characters:u.characters.map(h=>h.id!==u.activeCharacterId?h:{...h,sheets:h.sheets.map(g=>g.id===c?{...g,name:l}:g)})}:u),addWidget:(c,l,u,h)=>{t()._takeSnapshot("Add widget"),e(g=>{if(!g.activeCharacterId)return g;const f=g.characters.find(j=>j.id===g.activeCharacterId);if(!f)return g;const w=or(f);let S=l,y=u;const v=10,m=200,d=120,b=20,k=(j,E,N,p)=>w.some(M=>{const P=M.x+(M.w||m),A=M.y+(M.h||d),_=j+N,O=E+p;return!(j>=P||_<=M.x||E>=A||O<=M.y)});if(h){const j=-h.pan.x/h.scale,E=-h.pan.y/h.scale,N=h.width/h.scale,p=h.height/h.scale,M=j+N,P=E+p,A=40,_=Math.max(0,j+A),O=Math.max(0,E+A),V=M-A-m,z=P-A-d;let I=!1;const L=v*2;for(let Y=O;Y<=z&&!I;Y+=L)for(let J=_;J<=V&&!I;J+=L){const $=Math.round(J/v)*v,F=Math.round(Y/v)*v;k($,F,m,d)||(S=$,y=F,I=!0)}I||(S=Math.round((j+N/2-m/2)/v)*v,y=Math.round((E+p/2-d/2)/v)*v)}else if(w.length===0)S=Math.round(400/v)*v,y=Math.round(300/v)*v;else{const j=Math.min(...w.map(M=>M.x)),E=Math.max(...w.map(M=>M.x+(M.w||m))),N=Math.min(...w.map(M=>M.y)),p=Math.max(...w.map(M=>M.y+(M.h||d)));S=Math.round((E+b)/v)*v,y=Math.round(N/v)*v,S>1500&&(S=Math.round(j/v)*v,y=Math.round((p+b)/v)*v)}const C=j=>({NUMBER:"Trackers",NUMBER_DISPLAY:"Stats",LIST:"Inventory",TEXT:"Notes",CHECKBOX:"Checklist",HEALTH_BAR:"Health",DICE_ROLLER:"Roll",DICE_TRAY:"Dice Tray",SPELL_SLOT:"Spell Slots",IMAGE:"",POOL:"Resources",TOGGLE_GROUP:"Conditions",TABLE:"Table",TIME_TRACKER:"Temporary Effects",FORM:"Character Info",REST_BUTTON:"Rest",PROGRESS_BAR:"Progress",MAP_SKETCHER:"Map",ROLL_TABLE:"Random Table",INITIATIVE_TRACKER:"Initiative Tracker",DECK:"Deck"})[j]||"",x={id:Pe(),type:c,x:S,y,w:m,h:d,data:{label:C(c),value:0,items:[],text:""}};return{characters:g.characters.map(j=>j.id===g.activeCharacterId?He(j,E=>[...E,x]):j)}})},cloneWidget:c=>{t()._takeSnapshot("Clone widget"),e(l=>{if(!l.activeCharacterId)return l;const u=l.characters.find(S=>S.id===l.activeCharacterId);if(!u)return l;const g=or(u).find(S=>S.id===c);if(!g)return l;const f=30,w={id:Pe(),type:g.type,x:g.x+f,y:g.y+f,w:g.w,h:g.h,data:JSON.parse(JSON.stringify(g.data))};return{characters:l.characters.map(S=>S.id===l.activeCharacterId?He(S,y=>[...y,w]):S)}})},addWidgetFromTemplate:(c,l)=>{t()._takeSnapshot("Add widget from template"),e(u=>{if(!u.activeCharacterId)return u;const h=u.characters.find(k=>k.id===u.activeCharacterId);if(!h)return u;const g=or(h);let f=100,w=100;const S=10,y=20,v=c.w||200,m=c.h||120,d=(k,C,x,j)=>g.some(E=>{const N=E.x+(E.w||200),p=E.y+(E.h||120),M=k+x,P=C+j;return!(k>=N||M<=E.x||C>=p||P<=E.y)});if(l){const k=-l.pan.x/l.scale,C=-l.pan.y/l.scale,x=l.width/l.scale,j=l.height/l.scale,E=k+x,N=C+j,p=40,M=Math.max(0,k+p),P=Math.max(0,C+p),A=E-p-v,_=N-p-m;let O=!1;const V=S*2;for(let z=P;z<=_&&!O;z+=V)for(let I=M;I<=A&&!O;I+=V){const L=Math.round(I/S)*S,Y=Math.round(z/S)*S;d(L,Y,v,m)||(f=L,w=Y,O=!0)}O||(f=Math.round((k+x/2-v/2)/S)*S,w=Math.round((C+j/2-m/2)/S)*S)}else if(g.length===0)f=Math.round(400/S)*S,w=Math.round(300/S)*S;else{const k=Math.min(...g.map(E=>E.x)),C=Math.max(...g.map(E=>E.x+(E.w||200))),x=Math.min(...g.map(E=>E.y)),j=Math.max(...g.map(E=>E.y+(E.h||120)));f=Math.round((C+y)/S)*S,w=Math.round(x/S)*S,f>1500&&(f=Math.round(k/S)*S,w=Math.round((j+y)/S)*S)}const b={id:Pe(),type:c.type,x:f,y:w,w:c.w||200,h:c.h||120,data:JSON.parse(JSON.stringify(c.data))};return{characters:u.characters.map(k=>k.id===u.activeCharacterId?He(k,C=>[...C,b]):k)}})},addGroupFromTemplate:(c,l)=>{t()._takeSnapshot("Add group from template"),e(u=>{if(!u.activeCharacterId)return u;const h=u.characters.find(x=>x.id===u.activeCharacterId);if(!h)return u;const g=or(h);let f=0,w=0;c.widgets.forEach(x=>{const j=x.relativeX+(x.w||200),E=x.relativeY+(x.h||120);f=Math.max(f,j),w=Math.max(w,E)});let S=100,y=100;const v=10,m=20,d=(x,j,E,N)=>g.some(p=>{const M=p.x+(p.w||200),P=p.y+(p.h||120),A=x+E,_=j+N;return!(x>=M||A<=p.x||j>=P||_<=p.y)});if(l){const x=-l.pan.x/l.scale,j=-l.pan.y/l.scale,E=l.width/l.scale,N=l.height/l.scale,p=x+E,M=j+N,P=40,A=Math.max(0,x+P),_=Math.max(0,j+P),O=p-P-f,V=M-P-w;let z=!1;const I=v*2;for(let L=_;L<=V&&!z;L+=I)for(let Y=A;Y<=O&&!z;Y+=I){const J=Math.round(Y/v)*v,$=Math.round(L/v)*v;d(J,$,f,w)||(S=J,y=$,z=!0)}z||(S=Math.round((x+E/2-f/2)/v)*v,y=Math.round((j+N/2-w/2)/v)*v)}else if(g.length===0)S=Math.round(400/v)*v,y=Math.round(300/v)*v;else{const x=Math.min(...g.map(p=>p.x)),j=Math.max(...g.map(p=>p.x+(p.w||200))),E=Math.min(...g.map(p=>p.y)),N=Math.max(...g.map(p=>p.y+(p.h||120)));S=Math.round((j+m)/v)*v,y=Math.round(E/v)*v,S>1500&&(S=Math.round(x/v)*v,y=Math.round((N+m)/v)*v)}const b=Pe(),k=c.widgets.map(()=>Pe()),C=c.widgets.map((x,j)=>({id:k[j],type:x.type,x:S+x.relativeX,y:y+x.relativeY,w:x.w||200,h:x.h||120,groupId:b,data:JSON.parse(JSON.stringify(x.data))}));return c.attachments.forEach(([x,j])=>{const E=C[x],N=C[j];E&&N&&(E.attachedTo=E.attachedTo||[],N.attachedTo=N.attachedTo||[],E.attachedTo.includes(N.id)||E.attachedTo.push(N.id),N.attachedTo.includes(E.id)||N.attachedTo.push(E.id))}),{characters:u.characters.map(x=>x.id===u.activeCharacterId?He(x,j=>[...j,...C]):x)}})},updateWidgetPosition:(c,l,u)=>{t()._takeSnapshot("Move widget"),e(h=>({characters:h.characters.map(g=>g.id===h.activeCharacterId?He(g,f=>f.map(w=>w.id===c?{...w,x:l,y:u}:w)):g)}))},updateWidgetPositionNoSnapshot:(c,l,u)=>{e(h=>({characters:h.characters.map(g=>g.id===h.activeCharacterId?He(g,f=>f.map(w=>w.id===c?{...w,x:l,y:u}:w)):g)}))},updateWidgetSize:(c,l,u)=>e(h=>({characters:h.characters.map(g=>g.id===h.activeCharacterId?He(g,f=>f.map(w=>w.id===c?{...w,w:l,h:u}:w)):g)})),updateWidgetData:(c,l)=>{t()._takeSnapshot("Update widget"),e(u=>({characters:u.characters.map(h=>h.id===u.activeCharacterId?He(h,g=>g.map(f=>f.id===c?{...f,data:{...f.data,...l}}:f)):h)}))},removeWidget:c=>{t()._takeSnapshot("Delete widget"),e(l=>({characters:l.characters.map(u=>u.id===l.activeCharacterId?He(u,h=>h.filter(g=>g.id!==c)):u)}))},toggleWidgetLock:c=>{e(l=>({characters:l.characters.map(u=>u.id===l.activeCharacterId?He(u,h=>h.map(g=>g.id===c?{...g,locked:!g.locked}:g)):u)}))},moveWidgetToSheet:(c,l)=>{t()._takeSnapshot("Move widget to sheet"),e(u=>{if(!u.activeCharacterId)return u;const h=u.characters.find(y=>y.id===u.activeCharacterId);if(!h)return u;const g=h.sheets.find(y=>y.id===h.activeSheetId);if(!g)return u;const f=g.widgets.find(y=>y.id===c);if(!f||l===h.activeSheetId||!h.sheets.find(y=>y.id===l))return u;const S={...f,groupId:void 0,attachedTo:void 0};return{characters:u.characters.map(y=>y.id!==u.activeCharacterId?y:{...y,sheets:y.sheets.map(v=>v.id===h.activeSheetId?{...v,widgets:v.widgets.filter(m=>m.id!==c).map(m=>{var d;return{...m,attachedTo:(d=m.attachedTo)==null?void 0:d.filter(b=>b!==c)}})}:v.id===l?{...v,widgets:[...v.widgets,S]}:v)})}})},reorderWidget:(c,l)=>{t()._takeSnapshot("Reorder widget"),e(u=>u.activeCharacterId?{characters:u.characters.map(h=>h.id!==u.activeCharacterId?h:He(h,g=>{const f=g.findIndex(y=>y.id===c);if(f===-1)return g;const w=[...g],[S]=w.splice(f,1);return w.splice(l,0,S),w}))}:u)},attachWidgets:(c,l)=>{t()._takeSnapshot("Attach widgets"),e(u=>u.activeCharacterId?{characters:u.characters.map(h=>{var y;if(h.id!==u.activeCharacterId)return h;const g=or(h),f=g.find(v=>v.id===c),w=g.find(v=>v.id===l);if(!f||!w||(y=f.attachedTo)!=null&&y.includes(l))return h;let S;if(f.groupId&&w.groupId&&f.groupId!==w.groupId){S=f.groupId;const v=w.groupId;return He(h,m=>m.map(d=>d.groupId===v?{...d,groupId:S}:d.id===c?{...d,attachedTo:[...d.attachedTo||[],l]}:d.id===l?{...d,attachedTo:[...d.attachedTo||[],c]}:d))}else f.groupId?S=f.groupId:w.groupId?S=w.groupId:S=Pe();return He(h,v=>v.map(m=>m.id===c?{...m,groupId:S,attachedTo:[...m.attachedTo||[],l]}:m.id===l?{...m,groupId:S,attachedTo:[...m.attachedTo||[],c]}:m))})}:u)},detachWidgets:(c,l)=>{t()._takeSnapshot("Detach widget"),e(u=>u.activeCharacterId?{characters:u.characters.map(h=>{var x;if(h.id!==u.activeCharacterId)return h;const g=or(h),f=g.find(j=>j.id===c);if(!f||!f.groupId)return h;const w=f.groupId,S=f.attachedTo||[];let y=g.map(j=>j.id===c?{...j,groupId:void 0,attachedTo:void 0}:S.includes(j.id)?{...j,attachedTo:(j.attachedTo||[]).filter(E=>E!==c)}:j);const v=y.filter(j=>j.groupId===w).map(j=>j.id);if(v.length===0)return He(h,()=>y);const m=new Map;for(const j of v){const E=y.find(N=>N.id===j);m.set(j,((x=E==null?void 0:E.attachedTo)==null?void 0:x.filter(N=>v.includes(N)))||[])}const d=new Set,b=[];for(const j of v){if(d.has(j))continue;const E=[],N=[j];for(;N.length>0;){const p=N.shift();if(d.has(p))continue;d.add(p),E.push(p);const M=m.get(p)||[];for(const P of M)d.has(P)||N.push(P)}b.push(E)}const k=b.map((j,E)=>{if(!(j.length<=1))return E===0&&b.filter(N=>N.length>1).length<=1?w:Pe()}),C=new Map;return b.forEach((j,E)=>{for(const N of j)C.set(N,k[E])}),y=y.map(j=>{if(C.has(j.id)){const E=C.get(j.id);return E?{...j,groupId:E}:{...j,groupId:void 0,attachedTo:void 0}}return j}),He(h,()=>y)})}:u)},getWidgetsInGroup:c=>{const l=q.getState(),u=l.characters.find(g=>g.id===l.activeCharacterId);return u?or(u).filter(g=>g.groupId===c):[]},moveWidgetGroup:(c,l,u)=>{t()._takeSnapshot("Move widget"),e(h=>{if(!h.activeCharacterId)return h;const g=h.characters.find(y=>y.id===h.activeCharacterId);if(!g)return h;const w=or(g).find(y=>y.id===c);if(!w||!w.groupId)return{characters:h.characters.map(y=>y.id===h.activeCharacterId?He(y,v=>v.map(m=>m.id===c?{...m,x:m.x+l,y:m.y+u}:m)):y)};const S=w.groupId;return{characters:h.characters.map(y=>y.id===h.activeCharacterId?He(y,v=>v.map(m=>m.groupId===S?{...m,x:m.x+l,y:m.y+u}:m)):y)}})},cloneGroup:c=>{t()._takeSnapshot("Clone group"),e(l=>{if(!l.activeCharacterId)return l;const u=l.characters.find(v=>v.id===l.activeCharacterId);if(!u)return l;const g=or(u).filter(v=>v.groupId===c);if(g.length===0)return l;const f=30,w=Pe(),S=new Map;g.forEach(v=>{S.set(v.id,Pe())});const y=g.map(v=>{var m;return{id:S.get(v.id),type:v.type,x:v.x+f,y:v.y+f,w:v.w,h:v.h,groupId:w,attachedTo:(m=v.attachedTo)==null?void 0:m.map(d=>S.get(d)).filter(d=>d!==void 0),locked:v.locked,data:JSON.parse(JSON.stringify(v.data))}});return{characters:l.characters.map(v=>v.id===l.activeCharacterId?He(v,m=>[...m,...y]):v)}})},removeGroup:c=>{t()._takeSnapshot("Delete group"),e(l=>l.activeCharacterId?{characters:l.characters.map(u=>u.id===l.activeCharacterId?He(u,h=>h.filter(g=>g.groupId!==c)):u)}:l)},toggleGroupLock:c=>{e(l=>{if(!l.activeCharacterId)return l;const u=l.characters.find(S=>S.id===l.activeCharacterId);if(!u)return l;const w=or(u).filter(S=>S.groupId===c).some(S=>!S.locked);return{characters:l.characters.map(S=>S.id===l.activeCharacterId?He(S,y=>y.map(v=>v.groupId===c?{...v,locked:w}:v)):S)}})},moveGroupToSheet:(c,l)=>{t()._takeSnapshot("Move group to sheet"),e(u=>{if(!u.activeCharacterId)return u;const h=u.characters.find(y=>y.id===u.activeCharacterId);if(!h)return u;const g=h.sheets.find(y=>y.id===h.activeSheetId);if(!g||l===h.activeSheetId||!h.sheets.find(y=>y.id===l))return u;const w=g.widgets.filter(y=>y.groupId===c);if(w.length===0)return u;const S=new Set(w.map(y=>y.id));return{characters:u.characters.map(y=>y.id!==u.activeCharacterId?y:{...y,sheets:y.sheets.map(v=>v.id===h.activeSheetId?{...v,widgets:v.widgets.filter(m=>!S.has(m.id)).map(m=>{var d;return{...m,attachedTo:(d=m.attachedTo)==null?void 0:d.filter(b=>!S.has(b))}})}:v.id===l?{...v,widgets:[...v.widgets,...w]}:v)})}})},detachAllInGroup:c=>{t()._takeSnapshot("Detach all in group"),e(l=>l.activeCharacterId?{characters:l.characters.map(u=>u.id===l.activeCharacterId?He(u,h=>h.map(g=>g.groupId===c?{...g,groupId:void 0,attachedTo:void 0}:g)):u)}:l)},performRest:c=>{t()._takeSnapshot("Rest"),e(l=>{if(!l.activeCharacterId)return l;const{healAmount:u,clearConditions:h,resetSpellSlots:g,passTimeSeconds:f}=c;return{characters:l.characters.map(w=>w.id===l.activeCharacterId?He(w,S=>S.map(y=>{if(y.type==="HEALTH_BAR"&&u!==void 0){const v=y.data.currentValue??0,m=y.data.maxValue??10;let d;return u==="full"?d=m:d=Math.min(m,v+u),{...y,data:{...y.data,currentValue:d}}}if(y.type==="TOGGLE_GROUP"&&h){const m=(y.data.toggleItems||[]).map(d=>({...d,active:!1}));return{...y,data:{...y.data,toggleItems:m}}}if(y.type==="SPELL_SLOT"&&g){const m=(y.data.spellLevels||[]).map(d=>({...d,used:0}));return{...y,data:{...y.data,spellLevels:m}}}if(y.type==="TIME_TRACKER"&&f!==void 0&&f>0){const v=y.data.timedEffects||[],m=y.data.roundMode||!1,d=f,b=v.map(k=>({...k,remainingSeconds:Math.max(0,k.remainingSeconds-d)}));return{...y,data:{...y.data,timedEffects:b}}}return y})):w)}})},_takeSnapshot:c=>{const l=t();if(!l.activeCharacterId)return;const u=l.characters.find(h=>h.id===l.activeCharacterId);u&&sn.getState().takeSnapshot(l.activeCharacterId,u,c)},_replaceCharacter:(c,l)=>e(u=>({characters:u.characters.map(h=>h.id===c?l:h)})),undo:()=>{const c=t();if(!c.activeCharacterId)return;const l=c.characters.find(g=>g.id===c.activeCharacterId);if(!l)return;const u=sn.getState();u.setIsUndoRedoing(!0);const h=u.undo(c.activeCharacterId,l);h&&t()._replaceCharacter(c.activeCharacterId,h),u.setIsUndoRedoing(!1)},redo:()=>{const c=t();if(!c.activeCharacterId)return;const l=c.characters.find(g=>g.id===c.activeCharacterId);if(!l)return;const u=sn.getState();u.setIsUndoRedoing(!0);const h=u.redo(c.activeCharacterId,l);h&&t()._replaceCharacter(c.activeCharacterId,h),u.setIsUndoRedoing(!1)},canUndo:()=>{const c=t();return c.activeCharacterId?sn.getState().canUndo(c.activeCharacterId):!1},canRedo:()=>{const c=t();return c.activeCharacterId?sn.getState().canRedo(c.activeCharacterId):!1}}});{let e=null;q.subscribe(()=>{e&&window.clearTimeout(e),e=window.setTimeout(()=>{try{const t=q.getState(),n={characters:t.characters,activeCharacterId:t.activeCharacterId,mode:t.mode};if(localStorage.setItem("ucs:store",JSON.stringify(n)),t.activeCharacterId){const o=t.characters.find(a=>a.id===t.activeCharacterId);o&&Mg.getState().sendTelemetry(o)}}catch(t){console.error("Failed to persist store",t)}},150)})}const Pm="/UniversalCharacterSheet/assets/paper-BEAu-nxw.jpg",Rm="/UniversalCharacterSheet/assets/paper_2-CH9Rkn63.jpg",Dm="/UniversalCharacterSheet/assets/paper_3-kMWVO9hc.jpg",Lm="/UniversalCharacterSheet/assets/wood-CRUr5oIk.jpg",$m="/UniversalCharacterSheet/assets/arcs-D3YvlcmY.jpg",Am="/UniversalCharacterSheet/assets/circuit_board-DqNmZm31.jpg",_m="/UniversalCharacterSheet/assets/cloth-DQ1UH5v9.jpg",Om="/UniversalCharacterSheet/assets/fire-_GFizR-C.jpg",Wm="/UniversalCharacterSheet/assets/fog-DRMbxaR3.jpg",Fm="/UniversalCharacterSheet/assets/gears-DmesK-TK.jpg",Bm="/UniversalCharacterSheet/assets/glyphs-JJHDyMLG.jpg",zm="/UniversalCharacterSheet/assets/leaf-9JTNOToz.jpg",Hm="/UniversalCharacterSheet/assets/leather-gh3fCG9P.jpg",Um="/UniversalCharacterSheet/assets/metal-IUU3jIEo.jpg",Vm="/UniversalCharacterSheet/assets/smoke-j_Zmmo3C.jpg",Gm="/UniversalCharacterSheet/assets/snow-DoqVdj98.jpg",Ym="/UniversalCharacterSheet/assets/soil-DOAx3uxo.jpg",Xm="/UniversalCharacterSheet/assets/solar-BaBFVAiA.jpg",Km="/UniversalCharacterSheet/assets/stars-DnEgGp3s.jpg",Qm="/UniversalCharacterSheet/assets/stone-tbZqLald.jpg",Jm="/UniversalCharacterSheet/assets/tech-BxDJg7Fw.jpg",qm="/UniversalCharacterSheet/assets/water-CwLTClza.jpg",Zm="/UniversalCharacterSheet/assets/waves-C9RfNNeY.jpg",Wn={none:"none",paper:`url(${Pm})`,crumpledPaper:`url(${Rm})`,graphPaper:`url(${Dm})`,wood:`url(${Lm})`,arcs:`url(${$m})`,circuitBoard:`url(${Am})`,cloth:`url(${_m})`,fire:`url(${Om})`,fog:`url(${Wm})`,gears:`url(${Fm})`,glyphs:`url(${Bm})`,leaf:`url(${zm})`,leather:`url(${Hm})`,metal:`url(${Um})`,smoke:`url(${Vm})`,snow:`url(${Gm})`,soil:`url(${Ym})`,solar:`url(${Xm})`,stars:`url(${Km})`,stone:`url(${Qm})`,tech:`url(${Jm})`,water:`url(${qm})`,waves:`url(${Zm})`},Jt={paper:Pm,crumpledPaper:Rm,graphPaper:Dm,wood:Lm,arcs:$m,circuitBoard:Am,cloth:_m,fire:Om,fog:Wm,gears:Fm,glyphs:Bm,leaf:zm,leather:Hm,metal:Um,smoke:Vm,snow:Gm,soil:Ym,solar:Xm,stars:Km,stone:Qm,tech:Jm,water:qm,waves:Zm};function Et(e){return e in Jt}function Ms(e){return Nr.find(t=>t.id===e)}const Rg=[{value:"none",label:"None"},{value:"paper",label:"Paper"},{value:"crumpledPaper",label:"Crumpled Paper"},{value:"graphPaper",label:"Graph Paper"},{value:"wood",label:"Wood"},{value:"leather",label:"Leather"},{value:"cloth",label:"Cloth"},{value:"stone",label:"Stone"},{value:"metal",label:"Metal"},{value:"soil",label:"Soil"},{value:"leaf",label:"Leaf"},{value:"water",label:"Water"},{value:"waves",label:"Waves"},{value:"snow",label:"Snow"},{value:"fog",label:"Fog"},{value:"fire",label:"Fire"},{value:"smoke",label:"Smoke"},{value:"stars",label:"Stars"},{value:"solar",label:"Solar"},{value:"tech",label:"Technology"},{value:"circuitBoard",label:"Circuit Board"},{value:"gears",label:"Gears"},{value:"arcs",label:"Arcs"},{value:"glyphs",label:"Glyphs"}],Dg=[{value:"hard",label:"Hard Offset"},{value:"soft",label:"Soft Drop"},{value:"glow",label:"Glow"},{value:"inset",label:"Inset"},{value:"layered",label:"Layered"},{value:"none",label:"None"}],Lg=[{value:"solid",label:"Solid"},{value:"dashed",label:"Dashed"},{value:"dotted",label:"Dotted"},{value:"double",label:"Double"}];function lc(e,t,n=.15){return e==="none"||!e||Et(e)?"none":Wn[e]||Wn.none}function Qo(e,t="transparent"){switch(e){case"hard":return"4px 4px 0 0 var(--color-shadow)";case"soft":return"0 4px 12px var(--color-shadow)";case"glow":return`0 0 12px ${t}, 0 0 24px var(--color-shadow)`;case"inset":return"inset 0 2px 8px var(--color-shadow)";case"layered":return"2px 2px 0 var(--color-border), 4px 4px 8px var(--color-shadow)";case"none":return"none";default:return"4px 4px 0 0 var(--color-shadow)"}}const Nr=[{id:"default",name:"Classic",icon:"",description:"Clean black & white with hard shadows",colors:{background:"#e5e7eb",paper:"#ffffff",ink:"#000000",accent:"#000000",accentHover:"#374151",border:"#000000",shadow:"#000000",muted:"#6b7280",glow:"transparent"},fonts:{heading:'"Courier New", Courier, monospace',body:'"Courier New", Courier, monospace'},borderRadius:"0px",buttonRadius:"0px",borderWidth:"2px",shadowStyle:"4px 4px 0 0 var(--color-shadow)",cardTexture:Wn.none,borderStyle:"solid"},{id:"pen-and-paper",name:"Pen & Paper",icon:"",description:"Handwritten style with lined paper feel",colors:{background:"#d7d7d7",paper:"#d7d7d7",ink:"#2c3e50",accent:"#8b4513",accentHover:"#a0522d",border:"#8b7355",shadow:"#8b7355",muted:"#7f8c8d",glow:"transparent"},fonts:{heading:'"Comic Sans MS", "Segoe Print", cursive',body:'"Segoe Print", "Comic Sans MS", cursive'},borderRadius:"2px",buttonRadius:"2px",borderWidth:"1px",shadowStyle:"2px 2px 0 0 var(--color-shadow)",cardTexture:"graphPaper",textureOpacity:1,borderStyle:"solid"},{id:"medieval",name:"Medieval",icon:"",description:"Aged parchment with ornate styling",colors:{background:"#3d2914",paper:"#d4c4a8",ink:"#df7d57ff",accent:"#8b0000",accentHover:"#a52a2a",border:"#5c4033",shadow:"#2c1810",muted:"#6b5344",glow:"transparent"},fonts:{heading:'"Times New Roman", "Palatino Linotype", serif',body:'"Palatino Linotype", "Book Antiqua", serif'},borderRadius:"0px",buttonRadius:"0px",borderWidth:"3px",shadowStyle:"3px 3px 6px 0 var(--color-shadow)",cardTexture:"paper",textureOpacity:1,borderStyle:"double"},{id:"scifi",name:"Sci-Fi",icon:"",description:"Futuristic holographic interface",colors:{background:"#0a0a1a",paper:"#141428",ink:"#00ffff",accent:"#00ff88",accentHover:"#00cc6a",border:"#00ffff",shadow:"#00ffff40",muted:"#4a9eff",glow:"#008cffff"},fonts:{heading:'"Orbitron", "Segoe UI", sans-serif',body:'"Roboto Mono", "Consolas", monospace'},borderRadius:"4px",buttonRadius:"4px",borderWidth:"1px",shadowStyle:"0 0 8px var(--color-glow), 0 0 16px var(--color-shadow)",cardTexture:"circuitBoard",textureOpacity:.4,borderStyle:"solid"},{id:"classic-dark",name:"Classic Dark",icon:"",description:"Traditional dark theme with warm accents",colors:{background:"#1a1a1a",paper:"#2d2d2d",ink:"#e0e0e0",accent:"#d4a574",accentHover:"#c49464",border:"#404040",shadow:"#00000080",muted:"#888888",glow:"transparent"},fonts:{heading:'"Georgia", "Times New Roman", serif',body:'"Georgia", "Times New Roman", serif'},borderRadius:"4px",buttonRadius:"4px",borderWidth:"1px",shadowStyle:"0 4px 12px var(--color-shadow)",cardTexture:Wn.none,borderStyle:"solid"},{id:"modern-dark",name:"Modern Dark",icon:"",description:"Sleek contemporary dark interface",colors:{background:"#0f172a",paper:"#1e293b",ink:"#f1f5f9",accent:"#3b82f6",accentHover:"#2563eb",border:"#334155",shadow:"#00000060",muted:"#94a3b8",glow:"transparent"},fonts:{heading:'"Inter", "Segoe UI", sans-serif',body:'"Inter", "Segoe UI", sans-serif'},borderRadius:"8px",buttonRadius:"8px",borderWidth:"1px",shadowStyle:"0 4px 20px var(--color-shadow)",cardTexture:Wn.darkGrain,borderStyle:"solid"},{id:"high-magic",name:"High Magic",icon:"",description:"Arcane glyphs and mystical energy",colors:{background:"#1a0a2e",paper:"#2d1b4e",ink:"#e8d5ff",accent:"#bf7fff",accentHover:"#9966cc",border:"#bf7fff",shadow:"#bf7fff40",muted:"#9b8ab8",glow:"#bf7fff"},fonts:{heading:'"Cinzel", "Times New Roman", serif',body:'"Crimson Text", "Georgia", serif'},borderRadius:"8px",buttonRadius:"8px",borderWidth:"2px",shadowStyle:"0 0 12px var(--color-glow), 0 0 24px var(--color-shadow)",cardTexture:"arcs",textureOpacity:.15,borderStyle:"solid"},{id:"necrotic",name:"Necrotic",icon:"",description:"Dark and sinister undead aesthetic",colors:{background:"#0d0d0d",paper:"#1a1a1a",ink:"#c8c8c8",accent:"#4a0",accentHover:"#5b0",border:"#333333",shadow:"#00000080",muted:"#666666",glow:"#4a0"},fonts:{heading:'"Copperplate", "Copperplate Gothic Light", "Impact", fantasy',body:'"Courier New", monospace'},borderRadius:"0px",buttonRadius:"0px",borderWidth:"1px",shadowStyle:"0 0 10px var(--color-shadow), inset 0 0 30px rgba(74, 170, 0, 0.05)",cardTexture:"smoke",textureOpacity:.6,borderStyle:"solid"},{id:"modern",name:"Modern",icon:"",description:"Sleek contemporary design",colors:{background:"#f8fafc",paper:"#ffffff",ink:"#1e293b",accent:"#3b82f6",accentHover:"#2563eb",border:"#e2e8f0",shadow:"#64748b20",muted:"#64748b",glow:"transparent"},fonts:{heading:'"Inter", "Segoe UI", sans-serif',body:'"Inter", "Segoe UI", sans-serif'},borderRadius:"8px",buttonRadius:"8px",borderWidth:"1px",shadowStyle:"0 4px 16px var(--color-shadow)",cardTexture:Wn.none,borderStyle:"solid"},{id:"steampunk",name:"Steampunk",icon:"",description:"Victorian brass and gears",colors:{background:"#2a1f1a",paper:"#3d2b1f",ink:"#d4a574",accent:"#cd7f32",accentHover:"#b8860b",border:"#cd7f32",shadow:"#00000060",muted:"#8b7355",glow:"#cd7f32"},fonts:{heading:'"Spectral SC", "Georgia", serif',body:'"Cutive Mono", "Courier New", monospace'},borderRadius:"2px",buttonRadius:"2px",borderWidth:"2px",shadowStyle:"2px 2px 0 var(--color-border), 4px 4px 8px var(--color-shadow)",cardTexture:"gears",textureOpacity:.25,borderStyle:"solid"},{id:"cyberpunk",name:"Cyberpunk",icon:"",description:"Neon lights in a dark future",colors:{background:"#0f0f23",paper:"#24243fff",ink:"#eeff00",accent:"#ff00ff",accentHover:"#cc00cc",border:"#ff00ff",shadow:"#ff00ff40",muted:"#00ffff",glow:"#ff00ff"},fonts:{heading:'"Consolas", "Lucida Console", "Monaco", monospace',body:'"Consolas", "Lucida Console", "Monaco", monospace'},borderRadius:"0px",buttonRadius:"0px",borderWidth:"2px",shadowStyle:"0 0 10px var(--color-glow), 0 0 20px var(--color-shadow), 4px 4px 0 var(--color-border)",cardTexture:"tech",textureOpacity:.4,borderStyle:"solid"},{id:"nature",name:"Nature",icon:"",description:"Organic earthy woodland feel",colors:{background:"#2d4a3e",paper:"#f4f1e0cc",ink:"#7e9e7eff",accent:"#2d5a3e",accentHover:"#1e4a30",border:"#5a7247",shadow:"#2d3b2d40",muted:"#6b7c5a",glow:"transparent"},fonts:{heading:'"Amatic SC", "Trebuchet MS", sans-serif',body:'"Nunito", "Verdana", sans-serif'},borderRadius:"12px",buttonRadius:"12px",borderWidth:"2px",shadowStyle:"0 4px 12px var(--color-shadow)",cardTexture:"leaf",textureOpacity:.3,borderStyle:"solid"}];Cr(e=>({currentTheme:(()=>{try{const n=localStorage.getItem("ucs:theme");return n?JSON.parse(n):"default"}catch{return"default"}})(),setTheme:n=>{e({currentTheme:n}),localStorage.setItem("ucs:theme",JSON.stringify(n)),Fr(n)}}));function Fr(e){const t=Nr.find(a=>a.id===e)||Nr[0],n=document.documentElement;n.style.setProperty("--color-background",t.colors.background),n.style.setProperty("--color-paper",t.colors.paper),n.style.setProperty("--color-ink",t.colors.ink),n.style.setProperty("--color-accent",t.colors.accent),n.style.setProperty("--color-accent-hover",t.colors.accentHover),n.style.setProperty("--color-border",t.colors.border),n.style.setProperty("--color-shadow",t.colors.shadow),n.style.setProperty("--color-muted",t.colors.muted),n.style.setProperty("--color-glow",t.colors.glow),n.style.setProperty("--font-heading",t.fonts.heading),n.style.setProperty("--font-body",t.fonts.body),n.style.setProperty("--border-radius",t.borderRadius),n.style.setProperty("--button-radius",t.buttonRadius||t.borderRadius),n.style.setProperty("--border-width",t.borderWidth),n.style.setProperty("--shadow-style",t.shadowStyle),n.style.setProperty("--card-texture",t.cardTexture);const o=Et(t.cardTexture)?t.cardTexture:"none";n.style.setProperty("--card-texture-key",o),n.style.setProperty("--card-texture-color","#ffffff"),n.style.setProperty("--card-texture-opacity",String(t.textureOpacity??.15)),n.style.setProperty("--border-style",t.borderStyle)}function Po(e){const t=document.documentElement;t.style.setProperty("--color-background",e.colors.background),t.style.setProperty("--color-paper",e.colors.paper),t.style.setProperty("--color-ink",e.colors.ink),t.style.setProperty("--color-accent",e.colors.accent),t.style.setProperty("--color-accent-hover",e.colors.accentHover),t.style.setProperty("--color-border",e.colors.border),t.style.setProperty("--color-shadow",e.colors.shadow),t.style.setProperty("--color-muted",e.colors.muted),t.style.setProperty("--color-glow",e.colors.glow||"transparent"),t.style.setProperty("--font-heading",e.fonts.heading),t.style.setProperty("--font-body",e.fonts.body),t.style.setProperty("--border-radius",e.borderRadius),t.style.setProperty("--button-radius",e.buttonRadius||e.borderRadius),t.style.setProperty("--border-width",e.borderWidth);const n=Qo(e.shadowStyle||"hard",e.colors.glow||"transparent");t.style.setProperty("--shadow-style",n);const o=e.cardTexture||"none";t.style.setProperty("--card-texture-key",o);const a=lc(o,e.textureColor,e.textureOpacity??.15);t.style.setProperty("--card-texture",a),t.style.setProperty("--card-texture-color",e.textureColor||"#ffffff"),t.style.setProperty("--card-texture-opacity",String(e.textureOpacity??.15)),t.style.setProperty("--border-style",e.borderStyle||"solid")}const Yd=[{value:'"Arial", "Helvetica Neue", "Helvetica", sans-serif',label:"Arial"},{value:'"Arial Black", "Arial Bold", sans-serif',label:"Arial Black"},{value:'"Verdana", "Geneva", sans-serif',label:"Verdana"},{value:'"Trebuchet MS", "Lucida Sans Unicode", sans-serif',label:"Trebuchet MS"},{value:'"Tahoma", "Geneva", sans-serif',label:"Tahoma"},{value:'"Segoe UI", "Helvetica Neue", sans-serif',label:"Segoe UI"},{value:'"Calibri", "Candara", sans-serif',label:"Calibri"},{value:'"Candara", "Calibri", sans-serif',label:"Candara"},{value:'"Optima", "Segoe UI", sans-serif',label:"Optima"},{value:'"Lucida Sans", "Lucida Grande", sans-serif',label:"Lucida Sans"},{value:'"Times New Roman", "Times", serif',label:"Times New Roman"},{value:'"Georgia", "Palatino", serif',label:"Georgia"},{value:'"Palatino Linotype", "Book Antiqua", "Palatino", serif',label:"Palatino"},{value:'"Book Antiqua", "Palatino Linotype", serif',label:"Book Antiqua"},{value:'"Garamond", "Baskerville", serif',label:"Garamond"},{value:'"Baskerville", "Garamond", serif',label:"Baskerville"},{value:'"Cambria", "Georgia", serif',label:"Cambria"},{value:'"Didot", "Bodoni MT", serif',label:"Didot"},{value:'"Rockwell", "Courier Bold", serif',label:"Rockwell"},{value:'"Courier New", "Courier", monospace',label:"Courier New"},{value:'"Consolas", "Lucida Console", monospace',label:"Consolas"},{value:'"Lucida Console", "Monaco", monospace',label:"Lucida Console"},{value:'"Monaco", "Consolas", monospace',label:"Monaco"},{value:'"Andale Mono", "Consolas", monospace',label:"Andale Mono"},{value:'"Impact", "Haettenschweiler", sans-serif',label:"Impact"},{value:'"Copperplate", "Copperplate Gothic Light", fantasy',label:"Copperplate"},{value:'"Papyrus", fantasy',label:"Papyrus"},{value:'"Brush Script MT", cursive',label:"Brush Script"},{value:'"Comic Sans MS", "Segoe Print", cursive',label:"Comic Sans"},{value:'"Segoe Print", "Comic Sans MS", cursive',label:"Segoe Print"},{value:'"Lucida Handwriting", cursive',label:"Lucida Handwriting"}],$g=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],ef="ucs:custom-themes";function Ag(){try{const e=localStorage.getItem(ef);return e?JSON.parse(e):[]}catch{return[]}}function ul(e){localStorage.setItem(ef,JSON.stringify(e))}const Br=Cr((e,t)=>({customThemes:Ag(),addCustomTheme:n=>{const o=[...t().customThemes,n];ul(o),e({customThemes:o})},updateCustomTheme:(n,o)=>{const a=t().customThemes.map(s=>s.id===n?o:s);ul(a),e({customThemes:a})},deleteCustomTheme:n=>{const o=t().customThemes.filter(a=>a.id!==n);ul(o),e({customThemes:o})}}));function dr(e){return Br.getState().customThemes.find(t=>t.id===e)}function _g(){return{name:"My Custom Theme",icon:"",description:"A personalized theme",colors:{background:"#e5e7eb",paper:"#ffffff",ink:"#000000",accent:"#3b82f6",accentHover:"#2563eb",border:"#374151",shadow:"#1f2937",muted:"#6b7280",glow:"transparent"},fonts:{heading:'"Arial", "Helvetica Neue", sans-serif',body:'"Arial", "Helvetica Neue", sans-serif'},borderRadius:"4px",buttonRadius:"4px",borderWidth:"2px",shadowStyle:"hard",cardTexture:"none",textureColor:"#ffffff",textureOpacity:.15,borderStyle:"solid"}}function Og(e){return"isGroup"in e&&e.isGroup===!0}const bn=Cr(e=>{const t=(()=>{try{const a=localStorage.getItem("ucs:templates");return a?JSON.parse(a):null}catch(a){return console.error("Failed to load persisted templates",a),null}})(),n=(t==null?void 0:t.templates)??[],o=a=>{try{localStorage.setItem("ucs:templates",JSON.stringify({templates:a}))}catch(s){console.error("Failed to persist templates",s)}};return{templates:n,addTemplate:(a,s)=>{const i={id:Pe(),name:s||a.data.label||`${a.type} Template`,type:a.type,w:a.w,h:a.h,data:{...a.data},createdAt:Date.now()};e(c=>{const l=[...c.templates,i];return o(l),{templates:l}})},addGroupTemplate:(a,s)=>{if(a.length===0)return;const i=Math.min(...a.map(w=>w.x)),c=Math.min(...a.map(w=>w.y)),l=new Map;a.forEach((w,S)=>{l.set(w.id,S)});const u=new Set,h=[];a.forEach((w,S)=>{w.attachedTo&&w.attachedTo.forEach(y=>{const v=l.get(y);if(v!==void 0){const m=S<v?`${S}-${v}`:`${v}-${S}`;u.has(m)||(u.add(m),h.push(S<v?[S,v]:[v,S]))}})});const g=a.map(w=>({type:w.type,relativeX:w.x-i,relativeY:w.y-c,w:w.w,h:w.h,data:JSON.parse(JSON.stringify(w.data))})),f={id:Pe(),name:s,isGroup:!0,widgets:g,attachments:h,createdAt:Date.now()};e(w=>{const S=[...w.templates,f];return o(S),{templates:S}})},removeTemplate:a=>{e(s=>{const i=s.templates.filter(c=>c.id!==a);return o(i),{templates:i}})},renameTemplate:(a,s)=>{e(i=>{const c=i.templates.map(l=>l.id===a?{...l,name:s}:l);return o(c),{templates:c}})}}}),Ro=Cr(e=>{const t=(()=>{try{const a=localStorage.getItem("ucs:userPresets");return a?JSON.parse(a):null}catch(a){return console.error("Failed to load persisted user presets",a),null}})(),n=(t==null?void 0:t.userPresets)??[],o=a=>{try{localStorage.setItem("ucs:userPresets",JSON.stringify({userPresets:a}))}catch(s){console.error("Failed to persist user presets",s)}};return{userPresets:n,addPreset:(a,s,i=!1)=>{const{id:c,...l}=a,u={id:Pe(),name:s||`${a.name} Preset`,preset:l,theme:i?a.theme:void 0,createdAt:Date.now()};e(h=>{const g=[...h.userPresets,u];return o(g),{userPresets:g}})},removePreset:a=>{e(s=>{const i=s.userPresets.filter(c=>c.id!==a);return o(i),{userPresets:i}})},renamePreset:(a,s)=>{e(i=>{const c=i.userPresets.map(l=>l.id===a?{...l,name:s}:l);return o(c),{userPresets:c}})}}}),an="ucs:tutorialStep",_e=[{id:"create-character",title:"Create Your First Character",message:'Click the "Create New Character" button to get started with your first character sheet!',targetSelector:'[data-tutorial="create-character"]',position:"bottom",page:"character-list"},{id:"name-character",title:"Name Your Character",message:"Type a name for your character. This can be anything you like!",targetSelector:'[data-tutorial="character-name-input"]',position:"right",page:"character-list"},{id:"click-create",title:"Create Your Character",message:"You can also choose a preset to start with pre-made widgets, or pick a theme for different visual styles. For now, let's keep the defaults and click Create!",targetSelector:'[data-tutorial="create-button"]',position:"top",page:"character-list"},{id:"welcome-sheet",title:"Welcome to Your Character Sheet!",message:"This is where you'll build your character sheet. It's empty right now, so let's add some widgets! First, switch to Edit Mode.",targetSelector:'[data-tutorial="edit-mode-button"]',position:"bottom",page:"sheet"},{id:"add-widget",title:"Add Your First Widget",message:`Click "Add Widget" to open the widget toolbox. You'll find different types of widgets to build your character sheet!`,targetSelector:'[data-tutorial="add-widget-button"]',position:"bottom",page:"sheet"},{id:"add-image-widget",title:"Add an Image Widget",message:`Let's start with an Image widget! This is perfect for character portraits or reference images. Click on "Image" to add it.`,targetSelector:'[data-tutorial="widget-IMAGE"]',position:"right",page:"sheet"},{id:"add-health-widget",title:"Add a Health Bar",message:`Great! Now let's add a Health Bar to track your character's hit points. Click on "Health Bar".`,targetSelector:'[data-tutorial="widget-HEALTH_BAR"]',position:"right",page:"sheet"},{id:"add-form-widget",title:"Add a Form Widget",message:'Forms are great for character info like name, class, and background. Click on "Form" to add one.',targetSelector:'[data-tutorial="widget-FORM"]',position:"right",page:"sheet"},{id:"add-number-display-widget",title:"Add a Number Display",message:`Finally, let's add a Number Display for stats like Armor Class or Speed. Click on "Number Display".`,targetSelector:'[data-tutorial="widget-NUMBER_DISPLAY"]',position:"right",page:"sheet"},{id:"close-toolbox",title:"Close the Toolbox",message:"Great job! You've added some widgets. Now close the toolbox by clicking the X button to see your character sheet.",targetSelector:'[data-tutorial="close-toolbox"]',position:"bottom",page:"sheet"},{id:"pan-camera",title:"Move the Camera",message:"You can pan around your character sheet by clicking and dragging on the background. Try moving the view around!",position:"center",page:"sheet",requiresManualAdvance:!0},{id:"zoom-camera",title:"Zoom In and Out",message:"Use the scroll wheel (or pinch on touch devices) to zoom in and out. This helps you see details or get an overview!",position:"center",page:"sheet",requiresManualAdvance:!0},{id:"fit-button",title:"Fit All Widgets",message:'Click the "Fit" button to automatically center and zoom to show all your widgets at once. Very useful after moving around!',targetSelector:'[data-tutorial="fit-button"]',position:"bottom",page:"sheet"},{id:"move-widgets",title:"Move Your Widgets",message:"You can drag widgets around by clicking and holding the top bar (title area) of any widget. Try repositioning your widgets to create your ideal layout!",position:"center",page:"sheet",requiresManualAdvance:!0},{id:"resize-widgets",title:"Resize Your Widgets",message:"Drag the bottom-right corner of any widget to resize it. Make widgets bigger or smaller to fit your needs!",position:"center",page:"sheet",requiresManualAdvance:!0},{id:"attach-widgets",title:"Attach Widgets Together",message:"Move two widget edges close to each other and click the attach button that appears. Attached widgets will move together as a group, making it easy to organize your layout!",position:"center",page:"sheet",requiresManualAdvance:!0},{id:"widget-menu",title:"Widget Menu",message:"Click the menu button () in the top-right corner of the Form widget to access options like Edit, Clone, Save as Template, and Delete.",targetSelector:'[data-tutorial="widget-menu-FORM"]',position:"left",page:"sheet"},{id:"edit-widget",title:"Edit Widget",message:`Click "Edit" to open the widget editor. Here you can customize the widget's content, add fields, change labels, and more!`,targetSelector:'[data-tutorial="edit-button-FORM"]',position:"left",page:"sheet"},{id:"widget-label",title:"Widget Title",message:"You can rename the widget title here, or leave it empty if you don't want a title displayed.",targetSelector:'[data-tutorial="widget-label-input"]',position:"bottom",page:"sheet",requiresManualAdvance:!0},{id:"form-type-field",title:"Type a Field Name",message:'Type a field name like "Class", "Background", or "Alignment" in the text box.',targetSelector:'[data-tutorial="form-field-input"]',position:"top",page:"sheet"},{id:"form-click-add",title:"Click Add",message:'Click the "Add" button to add the field to your form.',targetSelector:'[data-tutorial="form-add-button"]',position:"top",page:"sheet"},{id:"form-click-done",title:"Finish Editing",message:`You can keep adding more fields if you want! When you're done, click "Done" to save your changes.`,targetSelector:'[data-tutorial="edit-done-button"]',position:"top",page:"sheet"},{id:"load-complete-sheet",title:"Let's Try a Complete Sheet!",message:`Great job! Now let's load a pre-made character sheet with many different widgets so you can see what's possible. Click "Next" to load it!`,position:"center",page:"sheet",requiresManualAdvance:!0},{id:"switch-to-play",title:"Switch to Play Mode",message:"This sheet has lots of widgets! Now switch to Play Mode to interact with them like you would during a game session.",targetSelector:'[data-tutorial="edit-mode-button"]',position:"bottom",page:"sheet"},{id:"try-widgets",title:"Try It Out!",message:"You're all set! Try clicking on different widgets - roll dice, track health, check conditions, and more. Have fun building your character sheets! ",position:"center",page:"sheet"}],ot=Cr((e,t)=>({tutorialStep:null,startTutorial:()=>{e({tutorialStep:0}),localStorage.setItem(an,"0")},exitTutorial:()=>{e({tutorialStep:null}),localStorage.removeItem(an)},advanceTutorial:()=>{const{tutorialStep:n}=t();if(n!==null&&n<_e.length-1){const o=n+1;e({tutorialStep:o}),localStorage.setItem(an,String(o))}else e({tutorialStep:null}),localStorage.removeItem(an)},setTutorialStep:n=>{e({tutorialStep:n}),n!==null?localStorage.setItem(an,String(n)):localStorage.removeItem(an)}})),Xd=localStorage.getItem(an);Xd!==null&&ot.setState({tutorialStep:parseInt(Xd,10)});const Ca=300,sr=16,Kd=600;function tf({darkMode:e=!1}){const t=ot(l=>l.tutorialStep),n=ot(l=>l.exitTutorial),o=ot(l=>l.advanceTutorial),[a,s]=T.useState(window.innerWidth<Kd),i=t!==null?_e[t]:null;if(T.useEffect(()=>{const l=()=>{s(window.innerWidth<Kd)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),!i)return null;const c=i.id==="form-click-done";return a?r.jsx("div",{className:"fixed z-[100] left-0 right-0 px-4",style:c?{top:sr+50}:{bottom:sr},children:r.jsxs("div",{className:`mx-auto p-4 rounded-lg shadow-lg max-w-[400px] ${e?"bg-black border border-white/30 text-white":"bg-white border border-gray-200 text-gray-800"}`,style:{animation:"subtle-pulse 3s ease-in-out infinite"},children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center bg-blue-500",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-bold text-sm mb-1",children:i.title}),r.jsx("p",{className:`text-sm ${e?"text-white/70":"text-gray-600"}`,children:i.message})]})]}),r.jsxs("div",{className:"mt-3 flex gap-2",children:[i.requiresManualAdvance&&r.jsx("button",{onClick:o,className:"flex-1 px-3 py-1.5 text-xs font-medium rounded transition-colors bg-blue-500 hover:bg-blue-600 text-white",children:"Next "}),r.jsx("button",{onClick:n,className:`${i.requiresManualAdvance?"":"flex-1"} px-3 py-1.5 text-xs font-medium rounded transition-colors ${i.id==="try-widgets"?"bg-green-500 hover:bg-green-600 text-white font-bold":e?"bg-white/10 hover:bg-white/20 text-white/70":"bg-gray-100 hover:bg-gray-200 text-gray-600"}`,children:i.id==="try-widgets"?" End of Tutorial":"Exit Tutorial"})]})]})}):r.jsx(Wg,{step:i,darkMode:e,exitTutorial:n,advanceTutorial:o})}function Wg({step:e,darkMode:t,exitTutorial:n,advanceTutorial:o}){const[a,s]=T.useState({top:0,left:0}),[i,c]=T.useState(""),[l,u]=T.useState(!1);T.useEffect(()=>{if((e==null?void 0:e.position)==="center"||!(e!=null&&e.targetSelector)){u(!0),s({top:window.innerHeight/2,left:window.innerWidth/2}),c("translate(-50%, -50%)");return}u(!1);const g=()=>{const S=document.querySelector(e.targetSelector);if(S){const y=S.getBoundingClientRect(),v=window.innerWidth;let m=0,d=0,b="";switch(e.position){case"bottom":m=y.bottom+12,d=y.left+y.width/2,d-Ca/2<sr?(d=sr,b="translateX(0)"):d+Ca/2>v-sr?(d=v-sr,b="translateX(-100%)"):b="translateX(-50%)";break;case"top":m=y.top-12,d=y.left+y.width/2,d-Ca/2<sr?(d=sr,b="translateX(0) translateY(-100%)"):d+Ca/2>v-sr?(d=v-sr,b="translateX(-100%) translateY(-100%)"):b="translateX(-50%) translateY(-100%)";break;case"left":m=y.top+y.height/2,d=y.left-12,b="translateX(-100%) translateY(-50%)";break;case"right":m=y.top+y.height/2,d=y.right+12,b="translateY(-50%)";break}s({top:m,left:d}),c(b)}};g(),window.addEventListener("resize",g),window.addEventListener("scroll",g);let f;const w=()=>{g(),f=requestAnimationFrame(w)};return f=requestAnimationFrame(w),()=>{window.removeEventListener("resize",g),window.removeEventListener("scroll",g),cancelAnimationFrame(f)}},[e]);const h=()=>{const f={position:"absolute",width:0,height:0,borderStyle:"solid"},w=t?"rgba(255,255,255,0.3)":"#e5e7eb";switch(e.position){case"center":return{display:"none"};case"bottom":return{...f,top:-10,left:"50%",transform:"translateX(-50%)",borderWidth:"0 10px 10px 10px",borderColor:`transparent transparent ${w} transparent`};case"top":return{...f,bottom:-10,left:"50%",transform:"translateX(-50%)",borderWidth:"10px 10px 0 10px",borderColor:`${w} transparent transparent transparent`};case"left":return{...f,right:-10,top:"50%",transform:"translateY(-50%)",borderWidth:"10px 0 10px 10px",borderColor:`transparent transparent transparent ${w}`};case"right":return{...f,left:-10,top:"50%",transform:"translateY(-50%)",borderWidth:"10px 10px 10px 0",borderColor:`transparent ${w} transparent transparent`};default:return f}};return r.jsx("div",{className:"fixed z-[100]",style:{top:a.top,left:a.left,transform:i},children:r.jsxs("div",{className:`relative p-4 rounded-lg shadow-lg max-w-[300px] ${t?"bg-black border border-white/30 text-white":"bg-white border border-gray-200 text-gray-800"}`,style:{animation:"subtle-pulse 3s ease-in-out infinite"},children:[!l&&r.jsx("div",{style:h()}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center bg-blue-500",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-bold text-sm mb-1",children:e.title}),r.jsx("p",{className:`text-sm ${t?"text-white/70":"text-gray-600"}`,children:e.message})]})]}),r.jsxs("div",{className:"mt-3 flex gap-2",children:[e.requiresManualAdvance&&r.jsx("button",{onClick:o,className:"flex-1 px-3 py-1.5 text-xs font-medium rounded transition-colors bg-blue-500 hover:bg-blue-600 text-white",children:"Next "}),r.jsx("button",{onClick:n,className:`${e.requiresManualAdvance?"":"flex-1"} px-3 py-1.5 text-xs font-medium rounded transition-colors ${e.id==="try-widgets"?"bg-green-500 hover:bg-green-600 text-white font-bold":t?"bg-white/10 hover:bg-white/20 text-white/70":"bg-gray-100 hover:bg-gray-200 text-gray-600"}`,children:e.id==="try-widgets"?" End of Tutorial":"Exit Tutorial"})]})]})})}function rf(e){const t=ot(o=>o.tutorialStep),n=t!==null?_e[t]:null;return{isActive:(n==null?void 0:n.page)===e,step:n,stepIndex:t}}const fo="https://wackyweasel.github.io/ucs-community-gallery",hl="ucs:gallery-cache",Qd="ucs:gallery-theme-data",Jd=60*60*1e3;function Fg(){const[e,t]=T.useState(null),[n,o]=T.useState({}),[a,s]=T.useState(!1),[i,c]=T.useState(null),l=T.useCallback(async(w,S=!1)=>{if(!S)try{const v=localStorage.getItem(Qd);if(v){const m=JSON.parse(v);if(Date.now()-m.timestamp<Jd){o(m.themes);return}}}catch(v){console.error("Failed to read theme data cache:",v)}const y={};await Promise.all(w.map(async v=>{try{const m=await fetch(`${fo}/${v.file}`);if(m.ok){const d=await m.json();y[v.id]=d}}catch(m){console.error(`Failed to fetch theme ${v.id}:`,m)}}));try{localStorage.setItem(Qd,JSON.stringify({themes:y,timestamp:Date.now()}))}catch(v){console.error("Failed to cache theme data:",v)}o(y)},[]),u=T.useCallback(async(w=!1)=>{if(!w)try{const S=localStorage.getItem(hl);if(S){const y=JSON.parse(S);if(Date.now()-y.timestamp<Jd){t(y.manifest),y.manifest.themes.length>0&&l(y.manifest.themes,!1);return}}}catch(S){console.error("Failed to read gallery cache:",S)}s(!0),c(null);try{const S=await fetch(`${fo}/index.json`);if(!S.ok)throw S.status===404?new Error("Gallery not set up yet. Check back later!"):new Error(`Failed to fetch gallery: ${S.status}`);const y=await S.json();try{localStorage.setItem(hl,JSON.stringify({manifest:y,timestamp:Date.now()}))}catch(v){console.error("Failed to cache gallery:",v)}t(y),y.themes.length>0&&l(y.themes,w)}catch(S){c(S instanceof Error?S.message:"Failed to load gallery");try{const y=localStorage.getItem(hl);if(y){const v=JSON.parse(y);t(v.manifest)}}catch{}}finally{s(!1)}},[l]);T.useEffect(()=>{u()},[u]);const h=T.useCallback(async w=>{try{const S=await fetch(`${fo}/${w.file}`);if(!S.ok)throw new Error(`Failed to download preset: ${S.status}`);return await S.json()}catch(S){return console.error("Failed to download preset:",S),null}},[]),g=T.useCallback(async w=>{try{const S=await fetch(`${fo}/${w.file}`);if(!S.ok)throw new Error(`Failed to download theme: ${S.status}`);return await S.json()}catch(S){return console.error("Failed to download theme:",S),null}},[]),f=T.useCallback(async w=>{try{const S=await fetch(`${fo}/${w.file}`);if(!S.ok)throw new Error(`Failed to download template: ${S.status}`);return await S.json()}catch(S){return console.error("Failed to download template:",S),null}},[]);return{manifest:e,themeData:n,loading:a,error:i,refresh:()=>u(!0),downloadPreset:h,downloadTheme:g,downloadTemplate:f}}const Bg="https://script.google.com/macros/s/AKfycbyIBng9kWluQYZ4yJwb2CoLC5Q2OfwVHdaQ9S5dghHMpqo6RTDoc58l2wb7XcasMTcTOg/exec";async function zg(e,t,n,o,a){try{return await fetch(Bg,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheet:e,name:t,author:n,description:o,data:a})}),!0}catch(s){return console.error("Failed to submit to gallery:",s),!1}}function Hg({collapsed:e,onToggle:t,darkMode:n}){const[o,a]=T.useState("presets"),[s,i]=T.useState(!1),[c,l]=T.useState(!0),[u,h]=T.useState(!1),[g,f]=T.useState("preset"),[w,S]=T.useState(""),[y,v]=T.useState(""),[m,d]=T.useState(""),[b,k]=T.useState(""),[C,x]=T.useState(!1),[j,E]=T.useState(!1),[N,p]=T.useState(null),[M,P]=T.useState(null),A=Ro(G=>G.userPresets),_=Ro(G=>G.addPreset),O=Br(G=>G.customThemes),V=Br(G=>G.addCustomTheme),z=bn(G=>G.templates),{manifest:I,themeData:L,loading:Y,error:J,refresh:$,downloadPreset:F,downloadTheme:X,downloadTemplate:oe}=Fg(),H=(G,ae)=>{f(G),S(ae);let de="";if(G==="preset"){const ce=A.find(Ne=>Ne.id===ae);de=(ce==null?void 0:ce.name)||""}else if(G==="theme"){const ce=O.find(Ne=>Ne.id===ae);de=(ce==null?void 0:ce.name)||""}else{const ce=z.find(Ne=>Ne.id===ae);de=(ce==null?void 0:ce.name)||""}v(de),d(""),k(""),E(!1),h(!0)},he=async()=>{if(!m.trim()||!y.trim())return;x(!0);let G=null,ae="Presets";if(g==="preset"){const de=A.find(ce=>ce.id===w);de&&(G={...de.preset,sheets:de.preset.sheets.map(Ne=>({...Ne,widgets:Ne.widgets.map(Te=>Te.type==="IMAGE"?{...Te,data:{...Te.data,imageUrl:void 0}}:Te.type==="MAP_SKETCHER"?{...Te,data:{...Te.data,mapShapes:[]}}:Te)}))},ae="Presets")}else if(g==="theme"){const de=O.find(ce=>ce.id===w);de&&(G=de,ae="Themes")}else{const de=z.find(ce=>ce.id===w);de&&(G=de,ae="Templates")}G&&await zg(ae,y.trim(),m.trim(),b.trim(),G)&&E(!0),x(!1)},je=async G=>{p(G.id);const ae=await F(G);if(ae){const de={id:Pe(),...ae};_(de,`${G.name} (Gallery)`,!1),P(G.id),setTimeout(()=>P(null),2e3)}p(null)},$e=async G=>{p(G.id);const ae=await X(G);ae&&(V({...ae,id:Pe()}),P(G.id),setTimeout(()=>P(null),2e3)),p(null)},Se=async G=>{p(G.id);const ae=await oe(G);if(ae){const ce=[...bn.getState().templates,{...ae,id:Pe(),createdAt:Date.now()}];localStorage.setItem("ucs:templates",JSON.stringify({templates:ce})),window.location.reload()}p(null)},Qe=n?"bg-black text-white border border-white/30 hover:bg-white/10":"bg-white text-gray-800 border border-gray-300 hover:bg-gray-100",Ae=n?"bg-black/50 border border-white/20":"bg-white border border-gray-200";return r.jsxs(r.Fragment,{children:[u&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60]",onClick:()=>h(!1)}),r.jsx("div",{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[60] p-6 rounded-lg shadow-xl w-[90vw] max-w-[400px] ${n?"bg-gray-900 text-white":"bg-white text-gray-900"}`,children:j?r.jsxs("div",{className:"text-center py-4",children:[r.jsx("div",{className:"text-4xl mb-2",children:""}),r.jsx("p",{className:"text-lg font-bold",children:"Submitted!"}),r.jsx("p",{className:`text-sm mt-2 ${n?"text-gray-200":"text-gray-700"}`,children:"Thank you for sharing with the community."}),r.jsx("p",{className:`text-sm mt-1 ${n?"text-gray-200":"text-gray-700"}`,children:"Your submission will appear in the gallery once it has been reviewed and approved."}),r.jsx("button",{onClick:()=>{h(!1),E(!1)},className:"mt-4 px-6 py-2 rounded font-medium bg-blue-600 text-white hover:bg-blue-700",children:"Ok"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"text-lg font-bold mb-4",children:"Share to Gallery"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),r.jsx("input",{type:"text",value:y,onChange:G=>v(G.target.value),placeholder:"Enter a name for your submission",className:`w-full px-3 py-2 rounded border ${n?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`,autoFocus:!0})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Your Name / Handle"}),r.jsx("input",{type:"text",value:m,onChange:G=>d(G.target.value),placeholder:"e.g. @username",className:`w-full px-3 py-2 rounded border ${n?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),r.jsx("textarea",{value:b,onChange:G=>k(G.target.value),placeholder:"Briefly describe what this is and what it's for...",rows:3,className:`w-full px-3 py-2 rounded border resize-none ${n?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>h(!1),className:`px-4 py-2 rounded ${Qe}`,children:"Cancel"}),r.jsx("button",{onClick:he,disabled:!y.trim()||!m.trim()||!b.trim()||C,className:`px-4 py-2 rounded font-medium ${y.trim()&&m.trim()&&b.trim()&&!C?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-400 text-gray-200 cursor-not-allowed"}`,children:C?"Submitting...":"Submit"})]})]})})]}),!e&&r.jsx("div",{className:"fixed inset-0 bg-black/30 z-40",onClick:t}),r.jsxs("div",{className:`fixed right-0 top-0 bottom-0 w-[90vw] max-w-[400px] z-50 flex flex-col overflow-hidden transition-transform duration-300 ease-in-out ${e?"translate-x-full":"translate-x-0"} ${n?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:[r.jsxs("div",{className:`flex items-center justify-between p-4 border-b ${n?"border-white/20":"border-gray-200"}`,children:[r.jsx("h2",{className:"text-xl font-bold",children:"Community Gallery"}),r.jsx("button",{onClick:t,className:`w-10 h-10 flex items-center justify-center rounded-lg ${Qe}`,children:""})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r.jsxs("div",{className:`rounded-lg overflow-hidden ${Ae}`,children:[r.jsxs("button",{onClick:()=>i(!s),className:`w-full flex items-center justify-between p-3 font-bold ${n?"hover:bg-white/5":"hover:bg-gray-50"}`,children:[r.jsx("span",{children:" Share with Community"}),r.jsx("span",{className:"text-lg",children:s?"":"+"})]}),s&&r.jsxs("div",{className:`p-3 pt-0 space-y-3 border-t ${n?"border-white/10":"border-gray-100"}`,children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold mb-2 text-gray-500",children:"My Presets"}),A.length===0?r.jsx("p",{className:"text-sm text-gray-400 italic",children:"No presets saved yet"}):r.jsx("div",{className:"space-y-1",children:A.map(G=>r.jsxs("div",{className:`flex items-center justify-between p-2 rounded ${n?"bg-white/5":"bg-gray-100"}`,children:[r.jsx("span",{className:"text-sm truncate flex-1",children:G.name}),r.jsx("button",{onClick:()=>H("preset",G.id),className:"text-xs px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 whitespace-nowrap ml-2",children:"Share"})]},G.id))})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold mb-2 text-gray-500",children:"My Themes"}),O.length===0?r.jsx("p",{className:"text-sm text-gray-400 italic",children:"No custom themes created yet"}):r.jsx("div",{className:"space-y-2",children:O.map(G=>{const ae=G.cardTexture||"none",de=Et(ae),ce=Qo(G.shadowStyle||"hard",G.colors.glow||"transparent");return r.jsxs("div",{className:"relative overflow-hidden",style:{borderRadius:G.borderRadius},children:[r.jsx("div",{className:"absolute inset-0",style:{backgroundColor:G.colors.paper,border:`${G.borderWidth} ${G.borderStyle||"solid"} ${G.colors.border}`,borderRadius:G.borderRadius,boxShadow:ce},children:de&&r.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:G.colors.paper},children:r.jsx("div",{style:{position:"absolute",inset:0,backgroundImage:`url(${Jt[ae]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:G.textureOpacity??.15,mixBlendMode:"overlay"}})})}),r.jsxs("div",{className:"relative flex items-center justify-between p-2",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[r.jsx("span",{style:{color:G.colors.ink},children:G.icon}),r.jsx("span",{className:"text-sm truncate",style:{color:G.colors.ink},children:G.name})]}),r.jsx("button",{onClick:()=>H("theme",G.id),className:"text-xs px-2 py-1 whitespace-nowrap ml-2",style:{backgroundColor:G.colors.accent,color:G.colors.paper,borderRadius:G.buttonRadius||"4px"},children:"Share"})]})]},G.id)})})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold mb-2 text-gray-500",children:"My Templates"}),z.length===0?r.jsx("p",{className:"text-sm text-gray-400 italic",children:"No templates saved yet"}):r.jsx("div",{className:"space-y-1",children:z.map(G=>r.jsxs("div",{className:`flex items-center justify-between p-2 rounded ${n?"bg-white/5":"bg-gray-100"}`,children:[r.jsx("span",{className:"text-sm truncate flex-1",children:G.name}),r.jsx("button",{onClick:()=>H("template",G.id),className:"text-xs px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 whitespace-nowrap ml-2",children:"Share"})]},G.id))})]})]})]}),r.jsxs("div",{className:`rounded-lg overflow-hidden ${Ae}`,children:[r.jsxs("button",{onClick:()=>l(!c),className:`w-full flex items-center justify-between p-3 font-bold ${n?"hover:bg-white/5":"hover:bg-gray-50"}`,children:[r.jsx("span",{children:" Community Gallery"}),r.jsx("span",{className:"text-lg",children:c?"":"+"})]}),c&&r.jsxs("div",{className:`border-t ${n?"border-white/10":"border-gray-100"}`,children:[r.jsx("div",{className:`flex border-b ${n?"border-white/10":"border-gray-200"}`,children:["presets","themes","templates"].map(G=>r.jsx("button",{onClick:()=>a(G),className:`flex-1 py-2 text-sm font-medium capitalize ${o===G?n?"border-b-2 border-white text-white":"border-b-2 border-blue-600 text-blue-600":n?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"}`,children:G},G))}),r.jsxs("div",{className:"p-3",children:[Y&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-current border-t-transparent rounded-full mb-2"}),r.jsx("p",{children:"Loading gallery..."})]}),J&&!I&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-red-500 mb-2",children:J}),r.jsx("button",{onClick:$,className:`px-3 py-1 rounded ${Qe}`,children:"Retry"})]}),I&&!Y&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex justify-end mb-2",children:r.jsx("button",{onClick:$,className:"text-xs text-gray-500 hover:text-gray-700 flex items-center gap-1",children:" Refresh"})}),o==="presets"&&r.jsx("div",{className:"space-y-2",children:I.presets.length===0?r.jsx("p",{className:"text-sm text-gray-400 italic text-center py-4",children:"No presets available yet"}):I.presets.map(G=>r.jsx("div",{className:`p-3 rounded ${n?"bg-white/5":"bg-gray-100"}`,children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h5",{className:"font-medium truncate",children:G.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:["by ",G.author]}),G.description&&r.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:G.description})]}),r.jsx("button",{onClick:()=>je(G),disabled:N===G.id,className:`ml-2 px-3 py-1 rounded text-sm whitespace-nowrap ${M===G.id?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:N===G.id?"...":M===G.id?"":"Download"})]})},G.id))}),o==="themes"&&r.jsx("div",{className:"space-y-2",children:I.themes.length===0?r.jsx("p",{className:"text-sm text-gray-400 italic text-center py-4",children:"No themes available yet"}):I.themes.map(G=>{var Q,K,Z,W;const ae=L[G.id],de=!!ae,ce=(ae==null?void 0:ae.cardTexture)||"none",Ne=de&&ce!=="none"&&Et(ce),Te=de?Qo(ae.shadowStyle||"hard",((Q=ae.colors)==null?void 0:Q.glow)||"transparent"):void 0;return de?r.jsxs("div",{className:"relative overflow-hidden",style:{borderRadius:ae.borderRadius||"8px"},children:[r.jsx("div",{className:"absolute inset-0",style:{backgroundColor:ae.colors.paper,border:`${ae.borderWidth||"2px"} ${ae.borderStyle||"solid"} ${ae.colors.border}`,borderRadius:ae.borderRadius||"8px",boxShadow:Te},children:Ne&&r.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:ae.colors.paper},children:r.jsx("div",{style:{position:"absolute",inset:0,backgroundImage:`url(${Jt[ce]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:ae.textureOpacity??.15,mixBlendMode:"overlay"}})})}),r.jsx("div",{className:"relative p-3",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("h5",{className:"font-medium truncate",style:{color:ae.colors.ink,fontFamily:(K=ae.fonts)==null?void 0:K.heading},children:[ae.icon," ",G.name]}),r.jsxs("p",{className:"text-xs",style:{color:ae.colors.muted||ae.colors.ink,fontFamily:(Z=ae.fonts)==null?void 0:Z.body},children:["by ",G.author]}),G.description&&r.jsx("p",{className:"text-sm mt-1 line-clamp-2",style:{color:ae.colors.ink,opacity:.7,fontFamily:(W=ae.fonts)==null?void 0:W.body},children:G.description})]}),r.jsx("button",{onClick:()=>$e(G),disabled:N===G.id,className:"ml-2 px-3 py-1 text-sm whitespace-nowrap",style:M===G.id?{backgroundColor:"#16a34a",color:"white",borderRadius:ae.buttonRadius||"4px"}:{backgroundColor:ae.colors.accent,color:ae.colors.paper,borderRadius:ae.buttonRadius||"4px"},children:N===G.id?"...":M===G.id?"":"Download"})]})})]},G.id):r.jsx("div",{className:`p-3 rounded ${n?"bg-white/5 border border-white/10":"bg-gray-100 border border-gray-200"}`,children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h5",{className:"font-medium truncate",children:G.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:["by ",G.author]}),G.description&&r.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:G.description})]}),r.jsx("button",{onClick:()=>$e(G),disabled:N===G.id,className:`ml-2 px-3 py-1 rounded text-sm whitespace-nowrap ${M===G.id?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:N===G.id?"...":M===G.id?"":"Download"})]})},G.id)})}),o==="templates"&&r.jsx("div",{className:"space-y-2",children:I.templates.length===0?r.jsx("p",{className:"text-sm text-gray-400 italic text-center py-4",children:"No templates available yet"}):I.templates.map(G=>r.jsx("div",{className:`p-3 rounded ${n?"bg-white/5":"bg-gray-100"}`,children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h5",{className:"font-medium truncate",children:G.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:["by ",G.author]}),G.description&&r.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:G.description})]}),r.jsx("button",{onClick:()=>Se(G),disabled:N===G.id,className:`ml-2 px-3 py-1 rounded text-sm whitespace-nowrap ${M===G.id?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:N===G.id?"...":M===G.id?"":"Download"})]})},G.id))})]})]})]})]})]})]})]})}const Ug="3f834d97-7148-4e93-b6c9-dde1ff490cc1",Vg="dnd preset",Gg="default",Yg=[{id:"8453b811-d0cd-4f81-a8a7-aef11ca7aaae",name:"Main",widgets:[{id:"0ed12bd7-8b3b-4565-86fd-2c446c824cd2",type:"IMAGE",x:0,y:0,w:190,h:220,data:{label:"Name",value:0,items:[],text:""},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["5bd0607a-d32c-4094-a64a-2e0b11f5a7d4","ab749546-cd73-4c12-adaa-1ef22fa875e2","00dd44bd-d941-4edc-96c5-c47a0c320840"]},{id:"ab749546-cd73-4c12-adaa-1ef22fa875e2",type:"HEALTH_BAR",x:0,y:220,w:190,h:100,data:{label:"Health",value:0,items:[],text:"",currentValue:10},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["0ed12bd7-8b3b-4565-86fd-2c446c824cd2","ae8315af-9e02-4750-8160-99e2fe45d03b","00dd44bd-d941-4edc-96c5-c47a0c320840"]},{id:"2a3c42aa-a933-4699-980f-b4ef75d7aa45",type:"DICE_ROLLER",x:470,y:120,w:180,h:120,data:{label:"Damage",value:0,items:[],text:"",diceGroups:[{count:1,faces:6}]},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["ef17b625-4d96-4228-a61a-2cf2afad5b94","00dd44bd-d941-4edc-96c5-c47a0c320840","219a1327-916b-402d-91aa-13ab8217bdf2"]},{id:"999ddc53-5db8-4b1e-80ec-c0e0641a010c",type:"NUMBER",x:190,y:320,w:280,h:440,data:{label:"Skills",value:0,items:[],text:"",numberItems:[{name:"Acrobatics (DEX)",value:0},{name:"Animal Handling (WIS)",value:0},{name:"Arcana (INT)",value:0},{name:"Athletics (STR)",value:0},{name:"Deception (CHA)",value:0},{name:"History (INT)",value:0},{name:"Insight (WIS)",value:0},{name:"Intimidation (CHA)",value:0},{name:"Investigation (INT)",value:0},{name:"Medicine (WIS)",value:0},{name:"Nature (INT)",value:0},{name:"Perception (WIS)",value:0},{name:"Performance (CHA)",value:0},{name:"Persuasion (CHA)",value:0},{name:"Religion (INT)",value:0},{name:"Sleight of Hand (DEX)",value:0},{name:"Stealth (DEX)",value:0},{name:"Survival (WIS)",value:0}]},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["957f216a-eb02-4bdf-af82-3b5f7df4f9d0","6e09d399-6a28-4060-bc63-c615209be46f","00dd44bd-d941-4edc-96c5-c47a0c320840","ae8315af-9e02-4750-8160-99e2fe45d03b","219a1327-916b-402d-91aa-13ab8217bdf2","4eded84b-0623-48e2-bd9e-11d6d0570736","bfd6064b-0512-4875-8a26-6a1e8cb3829a"]},{id:"4eded84b-0623-48e2-bd9e-11d6d0570736",type:"NUMBER",x:0,y:400,w:190,h:110,data:{label:"",value:0,items:[],text:"",numberItems:[{name:"Level",value:1},{name:"AC",value:10},{name:"Init",value:0},{name:"Speed",value:30}]},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["999ddc53-5db8-4b1e-80ec-c0e0641a010c","ae8315af-9e02-4750-8160-99e2fe45d03b","bfd6064b-0512-4875-8a26-6a1e8cb3829a"]},{id:"af24b2e5-bc7d-46cf-9781-7c307b9e9387",type:"TABLE",x:670,y:550,w:650,h:210,data:{label:"Backback",value:0,items:[],text:"",rows:[{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]}]},groupId:"55349067-3fce-40ac-a130-31fffe89be16",attachedTo:["01ca39ba-b98a-4f94-9d20-274ecd291adf","774878f7-e786-4a79-a46f-7ba3b2c37484"]},{id:"957f216a-eb02-4bdf-af82-3b5f7df4f9d0",type:"TIME_TRACKER",x:470,y:570,w:180,h:190,data:{label:"Effects",value:0,items:[],text:"",timedEffects:[]},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["6e09d399-6a28-4060-bc63-c615209be46f","999ddc53-5db8-4b1e-80ec-c0e0641a010c"]},{id:"6e09d399-6a28-4060-bc63-c615209be46f",type:"TOGGLE_GROUP",x:470,y:350,w:180,h:220,data:{label:"Conditions",value:0,items:[],text:"",toggleItems:[{name:"Blinded",active:!1},{name:"Charmed",active:!1},{name:"Deafened",active:!1},{name:"Frightened",active:!1},{name:"Grappled",active:!1},{name:"Incapacitated",active:!1},{name:"Invisible",active:!1},{name:"Paralyzed",active:!1},{name:"Petrified",active:!1},{name:"Poisoned",active:!1},{name:"Prone",active:!1},{name:"Restrained",active:!1},{name:"Stunned",active:!1},{name:"Unconscious",active:!1}]},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["219a1327-916b-402d-91aa-13ab8217bdf2","957f216a-eb02-4bdf-af82-3b5f7df4f9d0","999ddc53-5db8-4b1e-80ec-c0e0641a010c"]},{id:"00dd44bd-d941-4edc-96c5-c47a0c320840",type:"NUMBER",x:190,y:130,w:280,h:190,data:{label:"Attributes",value:0,items:[],text:"",numberItems:[{name:"Strength",value:10},{name:"Dexterity",value:10},{name:"Constitution",value:10},{name:"Intelligence",value:10},{name:"Wisdom",value:10},{name:"Charisma",value:10}]},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["0ed12bd7-8b3b-4565-86fd-2c446c824cd2","ab749546-cd73-4c12-adaa-1ef22fa875e2","2a3c42aa-a933-4699-980f-b4ef75d7aa45","5bd0607a-d32c-4094-a64a-2e0b11f5a7d4","219a1327-916b-402d-91aa-13ab8217bdf2","999ddc53-5db8-4b1e-80ec-c0e0641a010c"]},{id:"bfd6064b-0512-4875-8a26-6a1e8cb3829a",type:"LIST",x:0,y:510,w:190,h:250,data:{label:"Features & Traits",value:0,items:["","","","","","","",""],text:"",itemCount:7},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["999ddc53-5db8-4b1e-80ec-c0e0641a010c","4eded84b-0623-48e2-bd9e-11d6d0570736"]},{id:"ef17b625-4d96-4228-a61a-2cf2afad5b94",type:"DICE_ROLLER",x:470,y:0,w:180,h:120,data:{label:"Attack",value:0,items:[],text:""},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["5bd0607a-d32c-4094-a64a-2e0b11f5a7d4","2a3c42aa-a933-4699-980f-b4ef75d7aa45"]},{id:"01ca39ba-b98a-4f94-9d20-274ecd291adf",type:"NUMBER",x:1180,y:380,w:140,h:170,data:{label:"Wealth",value:0,items:[],text:"",numberItems:[{name:"PP",value:0},{name:"GP",value:0},{name:"EP",value:0},{name:"SP",value:0},{name:"CP",value:0}]},groupId:"55349067-3fce-40ac-a130-31fffe89be16",attachedTo:["774878f7-e786-4a79-a46f-7ba3b2c37484","af24b2e5-bc7d-46cf-9781-7c307b9e9387"]},{id:"db426c1f-a727-432c-a50d-f28f4b648c38",type:"SPELL_SLOT",x:670,y:130,w:170,h:250,data:{label:"Spell Slots",value:0,items:[],text:"",spellLevels:[{level:1,max:4,used:0},{level:2,max:2,used:0}]},groupId:"55349067-3fce-40ac-a130-31fffe89be16",attachedTo:["a9a12c4e-5db4-4c7d-ab1a-7257d0416815","0af67232-d082-4841-8e34-ce26517ffed3","774878f7-e786-4a79-a46f-7ba3b2c37484"]},{id:"5bd0607a-d32c-4094-a64a-2e0b11f5a7d4",type:"FORM",x:190,y:0,w:280,h:130,data:{label:"",value:0,items:[],text:"",formItems:[{name:"Class",value:""},{name:"Background",value:""},{name:"Race",value:""},{name:"Alignment",value:""}]},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["ef17b625-4d96-4228-a61a-2cf2afad5b94","00dd44bd-d941-4edc-96c5-c47a0c320840"]},{id:"774878f7-e786-4a79-a46f-7ba3b2c37484",type:"TEXT",x:670,y:380,w:510,h:170,data:{label:"Notes",value:0,items:[],text:""},groupId:"55349067-3fce-40ac-a130-31fffe89be16",attachedTo:["01ca39ba-b98a-4f94-9d20-274ecd291adf","af24b2e5-bc7d-46cf-9781-7c307b9e9387","0af67232-d082-4841-8e34-ce26517ffed3","db426c1f-a727-432c-a50d-f28f4b648c38"]},{id:"0af67232-d082-4841-8e34-ce26517ffed3",type:"TABLE",x:840,y:130,w:480,h:250,data:{label:"Spells",value:0,items:[],text:"",columns:["Name","Level","Notes"],rows:[{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]},{cells:["","",""]}]},groupId:"55349067-3fce-40ac-a130-31fffe89be16",attachedTo:["db426c1f-a727-432c-a50d-f28f4b648c38","a9a12c4e-5db4-4c7d-ab1a-7257d0416815"]},{id:"a9a12c4e-5db4-4c7d-ab1a-7257d0416815",type:"FORM",x:670,y:0,w:650,h:130,data:{label:"",value:0,items:[],text:"",formItems:[{name:"Spellcasting class",value:""},{name:"Spellcasting ability",value:""},{name:"Spell Save DC",value:""},{name:"Spell Attack Bonus",value:""}]},groupId:"55349067-3fce-40ac-a130-31fffe89be16",attachedTo:["db426c1f-a727-432c-a50d-f28f4b648c38","0af67232-d082-4841-8e34-ce26517ffed3"]},{id:"ae8315af-9e02-4750-8160-99e2fe45d03b",type:"PROGRESS_BAR",x:0,y:320,w:190,h:80,data:{label:"XP",value:0,items:[],text:"",maxValue:300,showPercentage:!1,currentValue:0},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["999ddc53-5db8-4b1e-80ec-c0e0641a010c","4eded84b-0623-48e2-bd9e-11d6d0570736"]},{id:"219a1327-916b-402d-91aa-13ab8217bdf2",type:"POOL",x:470,y:240,w:180,h:110,data:{label:"",value:0,items:[],text:"",poolStyle:"skulls",maxPool:3,currentPool:2,showPoolCount:!1,poolResources:[{name:"Death Save Success",max:3,current:0,style:"checkmarks"},{name:"Death Save Failure",max:3,current:0,style:"skulls"}]},groupId:"f2b6f235-4b41-40a8-9869-0047b90b3775",attachedTo:["6e09d399-6a28-4060-bc63-c615209be46f","2a3c42aa-a933-4699-980f-b4ef75d7aa45","999ddc53-5db8-4b1e-80ec-c0e0641a010c"]}]}],Xg="8453b811-d0cd-4f81-a8a7-aef11ca7aaae",Kg={id:Ug,name:Vg,theme:Gg,sheets:Yg,activeSheetId:Xg},Qg="2e478f30-ed09-423e-9e67-5f76b4935c22",Jg="dcc lvl0 preset",qg=[{id:"5e628031-65ea-4ed7-958d-eed3715907d1",name:"Main",widgets:[{id:"3069cc90-b5cd-4b24-8674-7ed8ed6a5ddc",type:"FORM",x:960,y:360,w:360,h:100,data:{label:"",value:0,items:[],text:"",formItems:[{name:"Name",value:""},{name:"Occupation",value:""},{name:"Alignment",value:""}]},groupId:"e9587685-3094-4efa-b7db-06139b04b684",attachedTo:["d1cd80c5-c859-4911-a5dd-1842cbb3f3fc","0838b4e2-9abc-4e79-97d2-75ab9ca24f30","21f4c3a8-4e21-46c8-a57c-5b34985bf1f0"]},{id:"88a7db76-54ba-4f26-b480-21261f450e44",type:"DICE_TRAY",x:1550,y:360,w:270,h:220,data:{label:"",value:0,items:[],text:"",availableDice:[3,4,5,6,7,8,10,12,14,16,20,24,30,100]}},{id:"d1cd80c5-c859-4911-a5dd-1842cbb3f3fc",type:"NUMBER",x:960,y:460,w:160,h:150,data:{label:"",value:0,items:[],text:"",numberItems:[{name:"STR",value:0},{name:"AGI",value:0},{name:"STA",value:0},{name:"PER",value:0},{name:"INT",value:0},{name:"LCK",value:0}]},groupId:"e9587685-3094-4efa-b7db-06139b04b684",attachedTo:["3069cc90-b5cd-4b24-8674-7ed8ed6a5ddc","279766de-d7e7-47b5-8cf2-905b4c266295","49a71ab5-cc63-490b-93ba-325cbccb0a8a","21f4c3a8-4e21-46c8-a57c-5b34985bf1f0"]},{id:"21f4c3a8-4e21-46c8-a57c-5b34985bf1f0",type:"NUMBER",x:1120,y:460,w:200,h:90,data:{label:"",value:0,items:[],text:"",numberItems:[{name:"Reflex",value:0},{name:"Fortitude",value:0},{name:"Will",value:0}]},groupId:"e9587685-3094-4efa-b7db-06139b04b684",attachedTo:["3069cc90-b5cd-4b24-8674-7ed8ed6a5ddc","d1cd80c5-c859-4911-a5dd-1842cbb3f3fc","279766de-d7e7-47b5-8cf2-905b4c266295","52dcd513-d13a-4792-a9a2-f230389caf39"]},{id:"0838b4e2-9abc-4e79-97d2-75ab9ca24f30",type:"HEALTH_BAR",x:1320,y:360,w:200,h:100,data:{label:"Health",value:0,items:[],text:"",maxValue:5,currentValue:5},groupId:"e9587685-3094-4efa-b7db-06139b04b684",attachedTo:["3069cc90-b5cd-4b24-8674-7ed8ed6a5ddc","52dcd513-d13a-4792-a9a2-f230389caf39"]},{id:"279766de-d7e7-47b5-8cf2-905b4c266295",type:"TEXT",x:1120,y:550,w:400,h:140,data:{label:"Notes",value:0,items:[],text:""},groupId:"e9587685-3094-4efa-b7db-06139b04b684",attachedTo:["d1cd80c5-c859-4911-a5dd-1842cbb3f3fc","49a71ab5-cc63-490b-93ba-325cbccb0a8a","52dcd513-d13a-4792-a9a2-f230389caf39","21f4c3a8-4e21-46c8-a57c-5b34985bf1f0"]},{id:"49a71ab5-cc63-490b-93ba-325cbccb0a8a",type:"PROGRESS_BAR",x:960,y:610,w:160,h:80,data:{label:"XP",value:0,items:[],text:"",maxValue:10,showPercentage:!1},groupId:"e9587685-3094-4efa-b7db-06139b04b684",attachedTo:["d1cd80c5-c859-4911-a5dd-1842cbb3f3fc","279766de-d7e7-47b5-8cf2-905b4c266295"]},{id:"52dcd513-d13a-4792-a9a2-f230389caf39",type:"NUMBER_DISPLAY",x:1320,y:460,w:200,h:90,data:{label:"",value:0,items:[],text:"",displayNumbers:[{label:"AC",value:10},{label:"Init",value:0},{label:"Speed",value:0}]},groupId:"e9587685-3094-4efa-b7db-06139b04b684",attachedTo:["0838b4e2-9abc-4e79-97d2-75ab9ca24f30","279766de-d7e7-47b5-8cf2-905b4c266295","21f4c3a8-4e21-46c8-a57c-5b34985bf1f0"]}]},{id:"c43d96bc-78f2-4a13-85c7-40c9e63d13c0",name:"Tables",widgets:[{id:"6e943b4e-f7ec-4f15-ac27-64861120dc55",type:"TABLE",x:400,y:300,w:510,h:400,data:{label:"Ability Score Modifiers",value:0,items:[],text:"",columns:["Ability Score","Modifier","Wizard Spells Known","Max Spell Level**"],rows:[{cells:["3","-3","No spellcasting possible","No spellcasting possible"]},{cells:["4","-2","-2 spells*","1"]},{cells:["5","-2","-2 spells*","1"]},{cells:["6","-1","-1 spell*","1"]},{cells:["7","-1","-1 spell*","1"]},{cells:["8","-1","No adjustment","2"]},{cells:["9","None","No adjustment","2"]},{cells:["10","None","No adjustment","3"]},{cells:["11","None","No adjustment","3"]},{cells:["12","None","No adjustment","4"]},{cells:["13","+1","No adjustment","4"]},{cells:["14","+1","+1 spell","4"]},{cells:["15","+1","	 +1 spell","5"]},{cells:["16","+2","	 +1 spell","5"]},{cells:["17","+2","	 +2 spells","5"]},{cells:["18","+3","+2 spells","5"]}]},groupId:"63b0d9e8-fe5e-4d2e-98a9-04cdc74d0792",attachedTo:["5f23c535-f23c-4377-bf5a-e73ce686a93d"]},{id:"5f23c535-f23c-4377-bf5a-e73ce686a93d",type:"TEXT",x:400,y:700,w:510,h:100,data:{label:"",value:0,items:[],text:`* Minimum of 1 spell.
** Based on Intelligence for wizards and Personality for clerics.`},groupId:"63b0d9e8-fe5e-4d2e-98a9-04cdc74d0792",attachedTo:["6e943b4e-f7ec-4f15-ac27-64861120dc55"]},{id:"5a2d16eb-3702-4e7f-b3b5-75efdb1f6a56",type:"TABLE",x:930,y:300,w:180,h:300,data:{label:"XP level Thresholds",value:0,items:[],text:"",columns:["Level","XP Required"],rows:[{cells:["0","0"]},{cells:["1","10"]},{cells:["2","50"]},{cells:["3","110"]},{cells:["4","190"]},{cells:["5","290"]},{cells:["6","410"]},{cells:["7","550"]},{cells:["8","710"]},{cells:["9","890"]},{cells:["10","1090"]}]}}]}],Zg="5e628031-65ea-4ed7-958d-eed3715907d1",eb="default",tb={id:Qg,name:Jg,sheets:qg,activeSheetId:Zg,theme:eb},rb="adf1b615-a045-4a25-8c37-0ce4f0fe984d",nb="Mothership preset",ob=[{id:"049aefc1-3522-4907-b34f-1ec1074d7084",name:"Main",widgets:[{id:"886cc172-510c-4785-8886-4efb4750f2bf",type:"IMAGE",x:780,y:200,w:210,h:250,data:{label:"Name",value:0,items:[],text:""},groupId:"5eb4b535-98e0-4a99-900b-dfac8f54c259",attachedTo:["6997f591-11b1-4d95-9e0d-8c3ea4afc67d","9a23a152-a4d1-4056-a5e4-c8dd01e1bd6f","ef500703-4bd6-45c5-9dac-0e8667ffb231","979186c7-3065-4691-97c9-d4fb50057156"]},{id:"9a23a152-a4d1-4056-a5e4-c8dd01e1bd6f",type:"NUMBER_DISPLAY",x:990,y:280,w:300,h:110,data:{label:"",value:0,items:[],text:"",displayNumbers:[{label:"Strength",value:0},{label:"Speed",value:0},{label:"Intellect",value:0},{label:"Combat",value:0}],displayLayout:"horizontal"},groupId:"5eb4b535-98e0-4a99-900b-dfac8f54c259",attachedTo:["979186c7-3065-4691-97c9-d4fb50057156","886cc172-510c-4785-8886-4efb4750f2bf","ef500703-4bd6-45c5-9dac-0e8667ffb231"]},{id:"ef500703-4bd6-45c5-9dac-0e8667ffb231",type:"NUMBER_DISPLAY",x:990,y:390,w:300,h:110,data:{label:"",value:0,items:[],text:"",displayNumbers:[{label:"Sanity",value:0},{label:"Fear",value:0},{label:"Body",value:0}]},groupId:"5eb4b535-98e0-4a99-900b-dfac8f54c259",attachedTo:["886cc172-510c-4785-8886-4efb4750f2bf","9a23a152-a4d1-4056-a5e4-c8dd01e1bd6f","6997f591-11b1-4d95-9e0d-8c3ea4afc67d","1d87cb28-79e5-4f20-b276-7a1aa6f4fe89"]},{id:"979186c7-3065-4691-97c9-d4fb50057156",type:"FORM",x:990,y:200,w:300,h:80,data:{label:"",value:0,items:[],text:"",formItems:[{name:"Class",value:""},{name:"High Score",value:""}]},groupId:"5eb4b535-98e0-4a99-900b-dfac8f54c259",attachedTo:["886cc172-510c-4785-8886-4efb4750f2bf"]},{id:"6997f591-11b1-4d95-9e0d-8c3ea4afc67d",type:"HEALTH_BAR",x:780,y:450,w:210,h:100,data:{label:"Health",value:0,items:[],text:""},groupId:"5eb4b535-98e0-4a99-900b-dfac8f54c259",attachedTo:["886cc172-510c-4785-8886-4efb4750f2bf","3bd49c92-b5d2-4f41-8351-06a21d6dc08a","ef500703-4bd6-45c5-9dac-0e8667ffb231","1d87cb28-79e5-4f20-b276-7a1aa6f4fe89"]},{id:"3bd49c92-b5d2-4f41-8351-06a21d6dc08a",type:"NUMBER",x:780,y:550,w:210,h:80,data:{label:"",value:0,items:[],text:"",numberItems:[{name:"Wounds",value:0},{name:"Stress",value:0}]},groupId:"5eb4b535-98e0-4a99-900b-dfac8f54c259",attachedTo:["6997f591-11b1-4d95-9e0d-8c3ea4afc67d","1d87cb28-79e5-4f20-b276-7a1aa6f4fe89"]},{id:"4a910aa1-2081-43d9-8597-e55af66f362f",type:"DICE_ROLLER",x:1310,y:200,w:200,h:120,data:{label:"New Widget",value:0,items:[],text:"",diceGroups:[{count:1,faces:100}]}},{id:"1d87cb28-79e5-4f20-b276-7a1aa6f4fe89",type:"TEXT",x:990,y:500,w:300,h:130,data:{label:"",value:0,items:[],text:""},groupId:"5eb4b535-98e0-4a99-900b-dfac8f54c259",attachedTo:["ef500703-4bd6-45c5-9dac-0e8667ffb231","6997f591-11b1-4d95-9e0d-8c3ea4afc67d","3bd49c92-b5d2-4f41-8351-06a21d6dc08a"]}]}],ab="049aefc1-3522-4907-b34f-1ec1074d7084",sb="default",lb={id:rb,name:nb,sheets:ob,activeSheetId:ab,theme:sb},ib="d1314816-deac-414a-aac4-ee8e34f3a43f",cb="Forbidden Lands Preset",db=[{id:"24ccc8eb-ccbb-4017-bf4c-c41e1e1c3942",name:"Main",widgets:[{id:"2a4977ab-5bf5-4249-bcbe-f85c98d44a0e",type:"IMAGE",x:0,y:0,w:180,h:220,data:{label:"New Widget",value:0,items:[],text:""},groupId:"24a99c59-bcf1-43c4-81a3-27d1ba361b2b",attachedTo:["77dae175-0c90-4ae9-9bd2-09900b47b452"]},{id:"77dae175-0c90-4ae9-9bd2-09900b47b452",type:"POOL",x:0,y:220,w:180,h:240,data:{label:"Attributes",value:0,items:[],text:"",poolResources:[{name:"Strength",max:4,current:4,style:"dots"},{name:"Agility",max:4,current:4,style:"dots"},{name:"Wits",max:4,current:4,style:"dots"},{name:"Empathy",max:4,current:4,style:"dots"}],showPoolCount:!1},groupId:"24a99c59-bcf1-43c4-81a3-27d1ba361b2b",attachedTo:["2a4977ab-5bf5-4249-bcbe-f85c98d44a0e","b6005e83-2df9-4d9e-899a-c287d6174b61"]},{id:"b6005e83-2df9-4d9e-899a-c287d6174b61",type:"TOGGLE_GROUP",x:0,y:460,w:180,h:150,data:{label:"Conditions",value:0,items:[],text:"",toggleItems:[{name:"Sleepy",active:!1},{name:"Thirsty",active:!1},{name:"Hungry",active:!1},{name:"Cold",active:!1}]},groupId:"24a99c59-bcf1-43c4-81a3-27d1ba361b2b",attachedTo:["77dae175-0c90-4ae9-9bd2-09900b47b452"]},{id:"ebe42a9f-7198-406a-af8c-0ae26471caaf",type:"TIME_TRACKER",x:470,y:380,w:260,h:230,data:{label:"Critical Injuries",value:0,items:[],text:""},groupId:"79947237-61a0-4981-a8b8-da5a29e5a82c",attachedTo:["8944f7d8-d339-4345-a2ee-f0a54745dcd9","4735c60d-3ded-4680-a9dc-58a4d528c26c","8dc758e6-5b01-4c7d-9c6c-09680bcfd46e"]},{id:"89f10e14-d560-43dd-821f-cea26f89c170",type:"DICE_TRAY",x:760,y:0,w:240,h:200,data:{label:"",value:0,items:[],text:"",availableDice:[6,8,10,12]}},{id:"e8466ec2-dba6-467c-bccd-dd6606a39408",type:"FORM",x:180,y:0,w:550,h:180,data:{label:"",value:0,items:[],text:"",formItems:[{name:"Kin",value:""},{name:"Profession",value:""},{name:"Age",value:""},{name:"Reputation",value:""},{name:"Pride",value:""},{name:"Dark Secret",value:""}]},groupId:"79947237-61a0-4981-a8b8-da5a29e5a82c",attachedTo:["8944f7d8-d339-4345-a2ee-f0a54745dcd9","4735c60d-3ded-4680-a9dc-58a4d528c26c"]},{id:"8944f7d8-d339-4345-a2ee-f0a54745dcd9",type:"NUMBER",x:180,y:180,w:290,h:430,data:{label:"Skills",value:0,items:[],text:"",numberItems:[{name:"Might (str)",value:0},{name:"Endurence (str)",value:0},{name:"Melee (str)",value:0},{name:"Crafting (str)",value:0},{name:"Stealth (agi)",value:0},{name:"Sleight of Hand (agi)",value:0},{name:"Move (agi)",value:0},{name:"Marksmanship (agi)",value:0},{name:"Scouting (wits)",value:0},{name:"Lore (wits)",value:0},{name:"Survival (wits)",value:0},{name:"Insight (wits)",value:0},{name:"Manipulation (emp)",value:0},{name:"PErformance (emp)",value:0},{name:"Healing (emp)",value:0},{name:"Healing (emp)",value:0},{name:"Animal Handling (emp)",value:0}]},groupId:"79947237-61a0-4981-a8b8-da5a29e5a82c",attachedTo:["e8466ec2-dba6-467c-bccd-dd6606a39408","4735c60d-3ded-4680-a9dc-58a4d528c26c","ebe42a9f-7198-406a-af8c-0ae26471caaf","8dc758e6-5b01-4c7d-9c6c-09680bcfd46e"]},{id:"4735c60d-3ded-4680-a9dc-58a4d528c26c",type:"LIST",x:470,y:180,w:260,h:200,data:{label:"Talents",value:0,items:[],text:"",itemCount:5},groupId:"79947237-61a0-4981-a8b8-da5a29e5a82c",attachedTo:["e8466ec2-dba6-467c-bccd-dd6606a39408","8944f7d8-d339-4345-a2ee-f0a54745dcd9","ebe42a9f-7198-406a-af8c-0ae26471caaf"]},{id:"8dc758e6-5b01-4c7d-9c6c-09680bcfd46e",type:"LIST",x:0,y:610,w:730,h:230,data:{label:"Equipment",value:0,items:[],text:"",itemCount:6},groupId:"79947237-61a0-4981-a8b8-da5a29e5a82c",attachedTo:["ebe42a9f-7198-406a-af8c-0ae26471caaf","8944f7d8-d339-4345-a2ee-f0a54745dcd9"]}]}],ub="24ccc8eb-ccbb-4017-bf4c-c41e1e1c3942",hb={id:ib,name:cb,sheets:db,activeSheetId:ub},mb="170d6275-d826-4b39-bd5d-fc498555aa16",fb="World of Darkness",pb=[{id:"28d2a97f-0e19-4fc9-8d7c-ea2fd7b1cd67",name:"Main",widgets:[{id:"fd4fdfbd-42f0-4c87-9192-a2e7be228f23",type:"FORM",x:140,y:-170,w:490,h:180,data:{label:"",value:0,items:[],text:"",formItems:[{name:"Age",value:""},{name:"Concept",value:""},{name:"Virtue",value:""},{name:"Vice",value:""},{name:"Chronicle",value:""},{name:"Faction",value:""},{name:"Group Name",value:""}],labelWidth:31},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["c30c7820-35f7-45a6-8864-327abca83410","99978f9e-ee5b-4faf-84b6-74512a7be9bc","1bce4057-4aaf-4731-a8b6-f0f42019e8df","32210222-f09f-471f-8a7b-61704e65cb6a"]},{id:"32210222-f09f-471f-8a7b-61704e65cb6a",type:"IMAGE",x:0,y:-170,w:140,h:180,data:{label:"",value:0,items:[],text:""},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["fd4fdfbd-42f0-4c87-9192-a2e7be228f23","c30c7820-35f7-45a6-8864-327abca83410"]},{id:"c30c7820-35f7-45a6-8864-327abca83410",type:"POOL",x:0,y:10,w:200,h:280,data:{label:"Attributes",value:0,items:[],text:"",poolResources:[{name:"Intelligence",max:5,current:1,style:"dots"},{name:"Wits",max:5,current:1,style:"dots"},{name:"Resolve",max:5,current:1,style:"dots"},{name:"Strength",max:5,current:1,style:"dots"},{name:"Dexterity",max:5,current:1,style:"dots"},{name:"Stamina",max:5,current:1,style:"dots"},{name:"Presence",max:5,current:1,style:"dots"},{name:"Manipulation",max:5,current:1,style:"dots"},{name:"Composure",max:5,current:1,style:"dots"}],inlineLabels:!0,showPoolCount:!1},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["3961f572-4adc-4882-8055-7bcc9d33cdec","86514d12-8d6d-4b9c-a706-eac0e3bc271e","f1412ddb-041a-4049-95e6-5d1054f69604","99978f9e-ee5b-4faf-84b6-74512a7be9bc","fd4fdfbd-42f0-4c87-9192-a2e7be228f23","32210222-f09f-471f-8a7b-61704e65cb6a"]},{id:"3961f572-4adc-4882-8055-7bcc9d33cdec",type:"POOL",x:0,y:290,w:210,h:250,data:{label:"Mental Skills",value:0,items:[],text:"",poolResources:[{name:"Academics",max:5,current:0,style:"dots"},{name:"Computer",max:5,current:0,style:"dots"},{name:"Crafts",max:5,current:0,style:"dots"},{name:"Investigation",max:5,current:0,style:"dots"},{name:"Medicine",max:5,current:0,style:"dots"},{name:"Occult",max:5,current:0,style:"dots"},{name:"Politics",max:5,current:0,style:"dots"},{name:"Science",max:5,current:0,style:"dots"}],showPoolCount:!1,inlineLabels:!0},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["2cbe24e7-ca8b-43ee-bb6f-012a2b8c0f3c","2a30e2da-0912-4317-a198-4f55f19879b5","c30c7820-35f7-45a6-8864-327abca83410"]},{id:"2cbe24e7-ca8b-43ee-bb6f-012a2b8c0f3c",type:"POOL",x:210,y:290,w:210,h:250,data:{label:"Physical Skills",value:0,items:[],text:"",poolResources:[{name:"Athletics",max:5,current:0,style:"dots"},{name:"Brawl",max:5,current:0,style:"dots"},{name:"Drive",max:5,current:0,style:"dots"},{name:"Firearms",max:5,current:0,style:"dots"},{name:"Larceny",max:5,current:0,style:"dots"},{name:"Stealth",max:5,current:0,style:"dots"},{name:"Survival",max:5,current:0,style:"dots"},{name:"Weaponery",max:5,current:0,style:"dots"}],showPoolCount:!1,inlineLabels:!0},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["97bb54a7-bd3b-4b55-85ce-48f68f55c95c","3961f572-4adc-4882-8055-7bcc9d33cdec","2a30e2da-0912-4317-a198-4f55f19879b5","e04f91be-2a29-48cb-9b85-03ecce805d29","86514d12-8d6d-4b9c-a706-eac0e3bc271e"]},{id:"97bb54a7-bd3b-4b55-85ce-48f68f55c95c",type:"POOL",x:420,y:290,w:210,h:250,data:{label:"Social Skills",value:0,items:[],text:"",poolResources:[{name:"Animal Ken",max:5,current:0,style:"dots"},{name:"Empathy",max:5,current:0,style:"dots"},{name:"Expression",max:5,current:0,style:"dots"},{name:"Intimidation",max:5,current:0,style:"dots"},{name:"Persuation",max:5,current:0,style:"dots"},{name:"Socialize",max:5,current:0,style:"dots"},{name:"Streetwise",max:5,current:0,style:"dots"},{name:"Subterfuge",max:5,current:0,style:"dots"}],showPoolCount:!1,inlineLabels:!0},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["2cbe24e7-ca8b-43ee-bb6f-012a2b8c0f3c","e04f91be-2a29-48cb-9b85-03ecce805d29","86514d12-8d6d-4b9c-a706-eac0e3bc271e","ce2f4fa8-6afc-4296-aae5-2e7cd53fb00b"]},{id:"99978f9e-ee5b-4faf-84b6-74512a7be9bc",type:"POOL",x:200,y:10,w:290,h:100,data:{label:"",value:0,items:[],text:"",maxPool:12,poolResources:[{name:"Health",max:12,current:12,style:"dots"},{name:"",max:12,current:12,style:"boxes"}],showPoolCount:!1},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["c30c7820-35f7-45a6-8864-327abca83410","f1412ddb-041a-4049-95e6-5d1054f69604","ce2f4fa8-6afc-4296-aae5-2e7cd53fb00b","1bce4057-4aaf-4731-a8b6-f0f42019e8df","fd4fdfbd-42f0-4c87-9192-a2e7be228f23"]},{id:"f1412ddb-041a-4049-95e6-5d1054f69604",type:"POOL",x:200,y:110,w:240,h:100,data:{label:"",value:0,items:[],text:"",maxPool:12,poolResources:[{name:"Willpower",max:10,current:10,style:"dots"},{name:"",max:10,current:10,style:"boxes"}],showPoolCount:!1},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["c30c7820-35f7-45a6-8864-327abca83410","ce2f4fa8-6afc-4296-aae5-2e7cd53fb00b","86514d12-8d6d-4b9c-a706-eac0e3bc271e","99978f9e-ee5b-4faf-84b6-74512a7be9bc"]},{id:"ce2f4fa8-6afc-4296-aae5-2e7cd53fb00b",type:"POOL",x:440,y:110,w:190,h:180,data:{label:"Merits",value:0,items:[],text:"",poolResources:[{name:"[...]",max:5,current:5,style:"dots"},{name:"[...]",max:5,current:5,style:"dots"},{name:"[...]",max:5,current:5,style:"dots"},{name:"[...]",max:5,current:5,style:"dots"},{name:"[...]",max:5,current:5,style:"dots"},{name:"[...]",max:5,current:5,style:"dots"}],showPoolCount:!1,inlineLabels:!0},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["97bb54a7-bd3b-4b55-85ce-48f68f55c95c","86514d12-8d6d-4b9c-a706-eac0e3bc271e","f1412ddb-041a-4049-95e6-5d1054f69604","1bce4057-4aaf-4731-a8b6-f0f42019e8df","99978f9e-ee5b-4faf-84b6-74512a7be9bc"]},{id:"86514d12-8d6d-4b9c-a706-eac0e3bc271e",type:"NUMBER_DISPLAY",x:200,y:210,w:240,h:80,data:{label:"",value:0,items:[],text:"",displayNumbers:[{label:"Size",value:0},{label:"Speed",value:0},{label:"Initiative",value:0},{label:"Defense",value:0},{label:"Armor",value:0}]},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["2cbe24e7-ca8b-43ee-bb6f-012a2b8c0f3c","97bb54a7-bd3b-4b55-85ce-48f68f55c95c","c30c7820-35f7-45a6-8864-327abca83410","ce2f4fa8-6afc-4296-aae5-2e7cd53fb00b","f1412ddb-041a-4049-95e6-5d1054f69604"]},{id:"2a30e2da-0912-4317-a198-4f55f19879b5",type:"TEXT",x:0,y:540,w:310,h:120,data:{label:"Weapons",value:0,items:[],text:""},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["e04f91be-2a29-48cb-9b85-03ecce805d29","3961f572-4adc-4882-8055-7bcc9d33cdec"]},{id:"e04f91be-2a29-48cb-9b85-03ecce805d29",type:"TEXT",x:310,y:540,w:320,h:120,data:{label:"Equipment",value:0,items:[],text:""},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["2a30e2da-0912-4317-a198-4f55f19879b5","97bb54a7-bd3b-4b55-85ce-48f68f55c95c","2cbe24e7-ca8b-43ee-bb6f-012a2b8c0f3c"]},{id:"1bce4057-4aaf-4731-a8b6-f0f42019e8df",type:"POOL",x:490,y:10,w:140,h:100,data:{label:"Morality",value:0,items:[],text:"",maxPool:10},groupId:"4ff25f8d-396d-4128-a70f-4579b6fb3775",attachedTo:["ce2f4fa8-6afc-4296-aae5-2e7cd53fb00b","99978f9e-ee5b-4faf-84b6-74512a7be9bc","fd4fdfbd-42f0-4c87-9192-a2e7be228f23"]}]}],xb="28d2a97f-0e19-4fc9-8d7c-ea2fd7b1cd67",gb="classic-dark",bb={id:mb,name:fb,sheets:pb,activeSheetId:xb,theme:gb},vb="05afe328-8942-47ac-8f1a-c6c416d4944a",yb="Tutorial Character",wb=[{id:"56e4547a-33ec-4971-b31b-ceb5cadb52c7",name:"Main",widgets:[{id:"f012632f-b66d-4713-9118-26630e6778a5",type:"IMAGE",x:-350,y:-50,w:140,h:190,data:{label:"New Widget",value:0,items:[],text:""},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["2bf5b92e-a89b-4c6a-8cbf-555b7e87cb4f","d10ea217-73b5-46ef-a412-973f8383737e","21436321-04b9-4b67-9728-01a2ea324bad"]},{id:"d10ea217-73b5-46ef-a412-973f8383737e",type:"CHECKBOX",x:-210,y:-50,w:140,h:100,data:{label:"Checkbox",value:0,items:[],text:"",checkboxItems:[{name:"Inspiration",checked:!0},{name:"Heroic Point",checked:!1}],checklistSettings:{strikethrough:!1}},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["f012632f-b66d-4713-9118-26630e6778a5","2bf5b92e-a89b-4c6a-8cbf-555b7e87cb4f","a05ee0b0-20f5-4057-9548-54d9fc8e7661"]},{id:"2bf5b92e-a89b-4c6a-8cbf-555b7e87cb4f",type:"TOGGLE_GROUP",x:-210,y:50,w:340,h:90,data:{label:"Conditions",value:0,items:[],text:"",toggleItems:[{name:"Blinded",active:!1},{name:"Frightened",active:!1},{name:"Stunned",active:!1},{name:"Exhausted",active:!1},{name:"Invisible",active:!1},{name:"Prone",active:!0},{name:"Poisoned",active:!1},{name:"Confused",active:!1}]},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["f012632f-b66d-4713-9118-26630e6778a5","d10ea217-73b5-46ef-a412-973f8383737e","a05ee0b0-20f5-4057-9548-54d9fc8e7661","c7db7b4d-e310-4ac8-8e0f-25e8937939ed"]},{id:"0716278d-79c7-4e25-980a-255de5535fb3",type:"DICE_ROLLER",x:150,y:-50,w:200,h:120,data:{label:"Attack",value:0,items:[],text:"",modifier:2},groupId:"6873aad0-47a8-45cf-bfdf-7624806a5fc4",attachedTo:["ffd5c666-6abc-45fc-8499-bd7e39005758","6ef2cac0-d99b-4f72-829e-b4488c51cb15"]},{id:"6ef2cac0-d99b-4f72-829e-b4488c51cb15",type:"DICE_TRAY",x:150,y:70,w:400,h:140,data:{label:"New Widget",value:0,items:[],text:""},groupId:"6873aad0-47a8-45cf-bfdf-7624806a5fc4",attachedTo:["0716278d-79c7-4e25-980a-255de5535fb3","ffd5c666-6abc-45fc-8499-bd7e39005758","e324fea3-9ca6-4b5c-b75f-499eff70c57d"]},{id:"a05ee0b0-20f5-4057-9548-54d9fc8e7661",type:"FORM",x:-70,y:-50,w:200,h:100,data:{label:"",value:0,items:[],text:"",formItems:[{name:"Class",value:"Druid"},{name:"Background",value:"Criminal"},{name:"Alignment",value:"Neutral"}],labelWidth:42},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["d10ea217-73b5-46ef-a412-973f8383737e","2bf5b92e-a89b-4c6a-8cbf-555b7e87cb4f"]},{id:"21436321-04b9-4b67-9728-01a2ea324bad",type:"HEALTH_BAR",x:-350,y:140,w:160,h:90,data:{label:"Health",value:0,items:[],text:"",currentValue:9},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["f012632f-b66d-4713-9118-26630e6778a5","c7db7b4d-e310-4ac8-8e0f-25e8937939ed","a3020607-50e1-4578-baf0-9c9d1f8bba88"]},{id:"f99c867a-81d5-423c-9840-dd274f94bdfc",type:"LIST",x:-190,y:230,w:160,h:150,data:{label:"Backpack",value:0,items:["Sword","Stick","Rope","",""],text:""},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["c7db7b4d-e310-4ac8-8e0f-25e8937939ed","7d363690-0963-4fbd-ab34-c88d4997ff8f","a3020607-50e1-4578-baf0-9c9d1f8bba88","2cf21c88-3f78-4b1b-8859-4353eabd684f","4b97cbce-a02a-4078-9b96-b7115c447575","937f0c77-364a-4998-9d5c-00f7002988a3"]},{id:"3517a65f-70eb-431a-9279-9fe28d2250ac",type:"MAP_SKETCHER",x:570,y:200,w:380,h:350,data:{label:"Map Sketcher",value:0,items:[],text:"",mapShapes:[{id:"shape-1767479670024",type:"rectangle",points:[],bounds:{x:48.682619009653685,y:34.85831718890739,width:91.70324066856884,height:90.66285466997438},color:"#333333",strokeWidth:2},{id:"shape-1767479679702",type:"corridor",points:[],corridorStart:{x:141.42794195854717,y:80.71079541280248},corridorEnd:{x:240.42575858938852,y:79.66869363498668},corridorWidth:10,color:"#333333",strokeWidth:2},{id:"shape-1767479684695",type:"ellipse",points:[],bounds:{x:238.34159402873922,y:32.774113633275796,width:95.87156978986741,height:94.83126178123757},color:"#333333",strokeWidth:2},{id:"shape-1767479688491",type:"corridor",points:[],corridorStart:{x:195.61622053542877,y:88.00550785751307},corridorEnd:{x:195.61622053542877,y:207.84721230632977},corridorWidth:10,color:"#333333",strokeWidth:2},{id:"shape-1767479692112",type:"corridor",points:[],corridorStart:{x:195.61622053542877,y:207.84721230632977},corridorEnd:{x:150.80668248146898,y:240.1523674186195},corridorWidth:10,color:"#333333",strokeWidth:2},{id:"shape-1767479697197",type:"ellipse",points:[],bounds:{x:107.03922670783385,y:221.39453541793515,width:44.809538053959784,height:59.399801335500484},color:"#333333",strokeWidth:2}]},groupId:"64a82c6e-a70e-4517-8dfa-8de8b4a89f00",attachedTo:["f1b2a166-316f-4fef-a380-e7bb49f2385d"]},{id:"c7db7b4d-e310-4ac8-8e0f-25e8937939ed",type:"NUMBER_DISPLAY",x:-190,y:140,w:320,h:90,data:{label:"",value:0,items:[],text:"",displayNumbers:[{label:"Strength",value:10},{label:"Agility",value:12},{label:"Intelligence",value:15},{label:"Luck",value:7}]},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["2bf5b92e-a89b-4c6a-8cbf-555b7e87cb4f","21436321-04b9-4b67-9728-01a2ea324bad","7d363690-0963-4fbd-ab34-c88d4997ff8f","f99c867a-81d5-423c-9840-dd274f94bdfc"]},{id:"937f0c77-364a-4998-9d5c-00f7002988a3",type:"NUMBER",x:-350,y:380,w:220,h:170,data:{label:"Skills",value:0,items:[],text:"",numberItems:[{name:"Stealth",value:2},{name:"Lockpick",value:1},{name:"Intimidate",value:0},{name:"Perception",value:0},{name:"Insight",value:1},{name:"Acrobatics",value:3}]},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["f99c867a-81d5-423c-9840-dd274f94bdfc","2cf21c88-3f78-4b1b-8859-4353eabd684f","4b97cbce-a02a-4078-9b96-b7115c447575"]},{id:"7d363690-0963-4fbd-ab34-c88d4997ff8f",type:"POOL",x:-30,y:230,w:160,h:150,data:{label:"",value:0,items:[],text:"",poolResources:[{name:"Resource 1",max:5,current:4,style:"dots"},{name:"Resource 2",max:5,current:3,style:"flames"},{name:"Resource 3",max:5,current:2,style:"skulls"}],showPoolCount:!1},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["c7db7b4d-e310-4ac8-8e0f-25e8937939ed","f99c867a-81d5-423c-9840-dd274f94bdfc","4b97cbce-a02a-4078-9b96-b7115c447575"]},{id:"a3020607-50e1-4578-baf0-9c9d1f8bba88",type:"PROGRESS_BAR",x:-350,y:230,w:160,h:60,data:{label:"XP",value:0,items:[],text:"",showPercentage:!1,currentValue:20},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["21436321-04b9-4b67-9728-01a2ea324bad","f99c867a-81d5-423c-9840-dd274f94bdfc","2cf21c88-3f78-4b1b-8859-4353eabd684f"]},{id:"2cf21c88-3f78-4b1b-8859-4353eabd684f",type:"REST_BUTTON",x:-350,y:290,w:160,h:90,data:{label:"New Widget",value:0,items:[],text:"",healToFull:!0,healRandomDice:[],healFlatAmount:0,buttonText:"Long Rest",clearConditions:!0,resetSpellSlots:!0,passTime:!0,passTimeAmount:8,passTimeUnit:"hours"},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["f99c867a-81d5-423c-9840-dd274f94bdfc","a3020607-50e1-4578-baf0-9c9d1f8bba88","937f0c77-364a-4998-9d5c-00f7002988a3"]},{id:"84df2d79-e721-42c8-957f-0177229929e1",type:"ROLL_TABLE",x:570,y:-50,w:190,h:130,data:{label:"Random Injury",value:0,items:[],text:"",showRollTableItems:!1,rollTableItems:[{text:"Broken Leg",weight:1},{text:"Broken Arm",weight:1},{text:"Heart Attack",weight:1},{text:"Severed Head",weight:1},{text:"Severed Hand",weight:1}]},groupId:"64a82c6e-a70e-4517-8dfa-8de8b4a89f00",attachedTo:["f1b2a166-316f-4fef-a380-e7bb49f2385d","77b9f223-e66d-485d-8607-6174808f566e"]},{id:"4b97cbce-a02a-4078-9b96-b7115c447575",type:"SPELL_SLOT",x:-130,y:380,w:260,h:170,data:{label:"Spell Slots",value:0,items:[],text:"",spellLevels:[{level:1,max:4,used:3},{level:2,max:3,used:1},{level:3,max:2,used:0}]},groupId:"02bd777b-cefd-4102-9187-a6217326d3aa",attachedTo:["f99c867a-81d5-423c-9840-dd274f94bdfc","7d363690-0963-4fbd-ab34-c88d4997ff8f","937f0c77-364a-4998-9d5c-00f7002988a3"]},{id:"e324fea3-9ca6-4b5c-b75f-499eff70c57d",type:"TABLE",x:150,y:210,w:400,h:150,data:{label:"Spells",value:0,items:[],text:"",columns:["Name","Level","Range","Description"],rows:[{cells:[{value:"Magic Hand",format:{bgColor:"#cacfe3"}},{value:"1",format:{hAlign:"center",bgColor:"#cacfe3",bgOpacity:1}},{value:"30ft",format:{hAlign:"center",bgColor:"#cacfe3",bgOpacity:1}},{value:"Move something light",format:{bgColor:"#cacfe3",bgOpacity:1}}]},{cells:[{value:"Detect Magic",format:{bgColor:"#c7e2d3"}},{value:"1",format:{hAlign:"center",bgColor:"#c7e2d3",bgOpacity:1}},{value:"15ft",format:{hAlign:"center",bgColor:"#c7e2d3",bgOpacity:1}},{value:"Annoy the DM",format:{bgColor:"#c7e2d3",bgOpacity:1}}]},{cells:[{value:"Fireball",format:{hAlign:"left",bgColor:"#ffc59d",bgOpacity:1}},{value:"3",format:{bgColor:"#ffc59d",bgOpacity:1,hAlign:"center"}},{value:"50ft",format:{bgColor:"#ffc59d",bgOpacity:1,hAlign:"center"}},{value:"Radius 15ft, 3d8 damage",format:{bgColor:"#ffc59d",bgOpacity:1}}]},{cells:["",{value:"",format:{hAlign:"center"}},{value:"",format:{hAlign:"center"}},{value:"asdfadsf",format:{}}]}]},groupId:"6873aad0-47a8-45cf-bfdf-7624806a5fc4",attachedTo:["6ef2cac0-d99b-4f72-829e-b4488c51cb15","40c5c949-7aa5-4ca7-8e87-8ef494cc0d20","2ed7a912-c84e-4f8e-8efe-cf5eec488213"]},{id:"f1b2a166-316f-4fef-a380-e7bb49f2385d",type:"TEXT",x:570,y:80,w:380,h:120,data:{label:"Notes",value:0,items:[],text:`The King wants us to save his son. 

(his son is an idiot)`},groupId:"64a82c6e-a70e-4517-8dfa-8de8b4a89f00",attachedTo:["3517a65f-70eb-431a-9279-9fe28d2250ac","77b9f223-e66d-485d-8607-6174808f566e","84df2d79-e721-42c8-957f-0177229929e1"]},{id:"40c5c949-7aa5-4ca7-8e87-8ef494cc0d20",type:"TIME_TRACKER",x:330,y:360,w:220,h:190,data:{label:"",value:0,items:[],text:"",roundMode:!1,timedEffects:[{name:"Dizzy",remainingSeconds:600,initialSeconds:600},{name:"Poisoned",remainingSeconds:3600,initialSeconds:3600}]},groupId:"6873aad0-47a8-45cf-bfdf-7624806a5fc4",attachedTo:["e324fea3-9ca6-4b5c-b75f-499eff70c57d","2ed7a912-c84e-4f8e-8efe-cf5eec488213"]},{id:"ffd5c666-6abc-45fc-8499-bd7e39005758",type:"DICE_ROLLER",x:350,y:-50,w:200,h:120,data:{label:"Damage",value:0,items:[],text:"",diceGroups:[{count:1,faces:8}],modifier:1},groupId:"6873aad0-47a8-45cf-bfdf-7624806a5fc4",attachedTo:["0716278d-79c7-4e25-980a-255de5535fb3","6ef2cac0-d99b-4f72-829e-b4488c51cb15"]},{id:"2ed7a912-c84e-4f8e-8efe-cf5eec488213",type:"INITIATIVE_TRACKER",x:150,y:360,w:180,h:190,data:{label:"Initiative Tracker",value:0,items:[],text:"",initiativeAdvanceTimeTrackers:!0,initiativePool:[{name:"Alice",diceFaces:20,flatBonus:0},{name:"Bob",diceFaces:20,flatBonus:0},{name:"Gaston",diceFaces:20,flatBonus:0}],initiativeEncounter:[{id:"9vfqopvmt",name:"Alice",diceFaces:20,flatBonus:0,isTemporary:!1},{id:"t5c1p4ijq",name:"Bob",diceFaces:20,flatBonus:0,isTemporary:!1},{id:"7fddhqlld",name:"Gaston",diceFaces:20,flatBonus:0,isTemporary:!1}],initiativeCurrentIndex:0},groupId:"6873aad0-47a8-45cf-bfdf-7624806a5fc4",attachedTo:["e324fea3-9ca6-4b5c-b75f-499eff70c57d","40c5c949-7aa5-4ca7-8e87-8ef494cc0d20"]},{id:"77b9f223-e66d-485d-8607-6174808f566e",type:"DECK",x:760,y:-50,w:190,h:130,data:{label:"Deck",value:0,items:[],text:"",deckCards:[{name:"Ace of Potatoes",amount:5},{name:"Ace of Cats",amount:5},{name:"Ace of Fireball",amount:5}],deckState:{remaining:["Ace of Potatoes","Ace of Potatoes","Ace of Potatoes","Ace of Potatoes","Ace of Potatoes","Ace of Cats","Ace of Cats","Ace of Cats","Ace of Cats","Ace of Cats","Ace of Fireball","Ace of Fireball","Ace of Fireball","Ace of Fireball"],discarded:["Ace of Fireball"]}},groupId:"64a82c6e-a70e-4517-8dfa-8de8b4a89f00",attachedTo:["f1b2a166-316f-4fef-a380-e7bb49f2385d","84df2d79-e721-42c8-957f-0177229929e1"]}]}],kb="56e4547a-33ec-4971-b31b-ceb5cadb52c7",jb="default",Nb={id:vb,name:yb,sheets:wb,activeSheetId:kb,theme:jb},nf={"D&D 5e":Kg,"Dungeon Crawl Classics - Level 0":tb,Mothership:lb,"Forbidden Lands":hb,"World of Darkness":bb};function Sb(){return Object.keys(nf)}function Cb(e){return nf[e]}const Tb=Nb,of="ucs:darkMode";function Eb(){const e=localStorage.getItem(of);return e!==null?e==="true":window.matchMedia("(prefers-color-scheme: dark)").matches}function Ib(e){const t=e?dr(e):void 0;if(t){const o=Qo(t.shadowStyle||"hard",t.colors.glow||"transparent"),a=t.cardTexture||"none",s=Et(a)?"none":lc(a,t.textureColor,t.textureOpacity);return{"--card-background":t.colors.paper,"--card-ink":t.colors.ink,"--card-border":t.colors.border,"--card-shadow":t.colors.shadow,"--card-muted":t.colors.muted,"--card-accent":t.colors.accent,"--card-glow":t.colors.glow||"transparent","--card-radius":t.borderRadius,"--card-border-width":t.borderWidth,"--card-border-style":t.borderStyle||"solid","--card-shadow-style":o,"--card-texture":s,"--card-texture-key":a,"--card-texture-color":t.textureColor||"#ffffff","--card-texture-opacity":String(t.textureOpacity??.15),fontFamily:t.fonts.body}}const n=Nr.find(o=>o.id===(e||"default"))||Nr[0];return{"--card-background":n.colors.paper,"--card-ink":n.colors.ink,"--card-border":n.colors.border,"--card-shadow":n.colors.shadow,"--card-muted":n.colors.muted,"--card-accent":n.colors.accent,"--card-glow":n.colors.glow,"--card-radius":n.borderRadius,"--card-border-width":n.borderWidth,"--card-border-style":n.borderStyle,"--card-shadow-style":n.shadowStyle,"--card-texture":n.cardTexture,"--card-texture-key":"none","--card-texture-color":"#ffffff","--card-texture-opacity":"0.15",fontFamily:n.fonts.body}}function Mb(){var Je,qe;const e=Br(U=>U.customThemes),t=bn(U=>U.templates),n=Ro(U=>U.userPresets),o=Ro(U=>U.addPreset),a=Ro(U=>U.removePreset),s=q(U=>U.characters),i=q(U=>U.createCharacter),c=q(U=>U.createCharacterFromPreset),l=q(U=>U.updateCharacterTheme),u=q(U=>U.updateCharacterName),h=q(U=>U.importCharacter),g=q(U=>U.duplicateCharacter),f=q(U=>U.selectCharacter),w=q(U=>U.deleteCharacter),S=ot(U=>U.tutorialStep),y=ot(U=>U.startTutorial),v=ot(U=>U.advanceTutorial),{isActive:m}=rf("character-list"),[d,b]=T.useState(Eb),[k,C]=T.useState(null),[x,j]=T.useState(!1),[E,N]=T.useState(!1),[p,M]=T.useState(""),[P,A]=T.useState(""),[_,O]=T.useState("default"),[V,z]=T.useState(null),[I,L]=T.useState(!1),[Y,J]=T.useState(null),[$,F]=T.useState(""),[X,oe]=T.useState(!1),[H,he]=T.useState(null),[je,$e]=T.useState(""),[Se,Qe]=T.useState(!0),[Ae,G]=T.useState(null),[ae,de]=T.useState(!1),[ce,Ne]=T.useState(!1),Te=T.useRef(null),Q=T.useRef(null),K=T.useRef(null),Z=T.useRef(null),W=T.useRef(null),B=Sb(),re=()=>{b(U=>{const ue=!U;return localStorage.setItem(of,String(ue)),ue})};T.useEffect(()=>{const U=ue=>{Z.current&&!Z.current.contains(ue.target)&&z(null),W.current&&!W.current.contains(ue.target)&&L(!1),Te.current&&!Te.current.contains(ue.target)&&de(!1)};return(V||I||ae)&&document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[V,I]);const te=()=>{const U=p.trim()||"New Character";if(P&&P!=="")if(P.startsWith("user:")){const ue=P.replace("user:",""),Me=n.find(pe=>pe.id===ue);if(Me){c(Me.preset,U);const pe=q.getState(),xe=pe.characters[pe.characters.length-1],le=Me.theme||_;xe&&le!=="default"&&l(xe.id,le)}}else{const ue=Cb(P);if(ue){c(ue,U);const Me=q.getState(),pe=Me.characters[Me.characters.length-1];pe&&_!=="default"&&l(pe.id,_)}}else{i(U);const ue=q.getState(),Me=ue.characters[ue.characters.length-1];Me&&_!=="default"&&l(Me.id,_)}M(""),A(""),O("default"),j(!1)},fe=U=>{const ue=JSON.stringify(U,null,2),Me=new Blob([ue],{type:"application/json"}),pe=URL.createObjectURL(Me),xe=document.createElement("a");xe.href=pe,xe.download=`${U.name.replace(/[^a-z0-9]/gi,"_")}.json`,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(pe)},me=U=>{var pe;const ue=(pe=U.target.files)==null?void 0:pe[0];if(!ue)return;const Me=new FileReader;Me.onload=xe=>{var le;try{const tt=JSON.parse((le=xe.target)==null?void 0:le.result);if(!tt.name||!tt.sheets||!Array.isArray(tt.sheets)){alert("Invalid character file format");return}h(tt)}catch(tt){alert("Failed to parse character file"),console.error(tt)}},Me.readAsText(ue),Q.current&&(Q.current.value="")},be=()=>{const U={version:1,timestamp:new Date().toISOString(),characters:s,customThemes:e,templates:t,userPresets:n},ue=JSON.stringify(U,null,2),Me=new Blob([ue],{type:"application/json"}),pe=URL.createObjectURL(Me),xe=document.createElement("a");xe.href=pe,xe.download=`ucs_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(pe)},Ie=U=>{var pe;const ue=(pe=U.target.files)==null?void 0:pe[0];if(!ue)return;const Me=new FileReader;Me.onload=xe=>{var le,tt,tr;try{const ze=JSON.parse((le=xe.target)==null?void 0:le.result);if(!ze.characters||!Array.isArray(ze.characters)){alert("Invalid backup file format");return}const kn=((tt=ze.templates)==null?void 0:tt.length)||0,_t=((tr=ze.userPresets)==null?void 0:tr.length)||0;if(!window.confirm(`This will replace all your current data with the backup from ${ze.timestamp?new Date(ze.timestamp).toLocaleString():"unknown date"}.

Backup contains ${ze.characters.length} character(s)`+(kn>0?`, ${kn} template(s)`:"")+(_t>0?`, ${_t} user preset(s)`:"")+`.

Are you sure you want to continue?`))return;localStorage.setItem("ucs:store",JSON.stringify({characters:ze.characters,activeCharacterId:null})),ze.customThemes&&localStorage.setItem("ucs:customThemes",JSON.stringify(ze.customThemes)),ze.templates&&Array.isArray(ze.templates)&&localStorage.setItem("ucs:templates",JSON.stringify({templates:ze.templates})),ze.userPresets&&Array.isArray(ze.userPresets)&&localStorage.setItem("ucs:userPresets",JSON.stringify({userPresets:ze.userPresets})),window.location.reload()}catch(ze){alert("Failed to parse backup file"),console.error(ze)}},Me.readAsText(ue),K.current&&(K.current.value="")};return r.jsxs("div",{className:`h-full p-4 overflow-auto transition-colors ${d?"bg-black":"bg-gray-100"}`,children:[r.jsxs("div",{className:"max-w-4xl mx-auto pb-safe",children:[r.jsxs("div",{className:`flex justify-between items-center mb-4 border-b-[length:var(--border-width)] pb-2 ${d?"border-white/30":"border-theme-border"}`,children:[r.jsx("h1",{className:`text-2xl font-bold uppercase tracking-wider font-heading ${d?"text-white":"text-theme-ink"}`,children:"Character Select"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>Ne(!0),className:`flex items-center gap-2 px-3 py-2 text-sm font-body rounded-button transition-colors shadow-theme active:translate-x-[2px] active:translate-y-[2px] active:shadow-none ${d?"text-white border border-white/30 bg-black hover:bg-white/10":"text-theme-ink border-[length:var(--border-width)] border-theme-border bg-theme-paper hover:bg-theme-accent hover:text-theme-paper"}`,title:"Community Gallery",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),r.jsx("span",{children:"Gallery"})]}),r.jsxs("button",{onClick:y,className:`flex items-center gap-2 px-3 py-2 text-sm font-body rounded-button transition-colors shadow-theme active:translate-x-[2px] active:translate-y-[2px] active:shadow-none ${d?"text-white border border-white/30 bg-black hover:bg-white/10":"text-theme-ink border-[length:var(--border-width)] border-theme-border bg-theme-paper hover:bg-theme-accent hover:text-theme-paper"}`,title:"Start Tutorial",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),r.jsx("span",{children:"Tutorial"})]}),r.jsxs("button",{onClick:()=>N(!0),className:`flex items-center gap-2 px-3 py-2 text-sm font-body rounded-button transition-colors shadow-theme active:translate-x-[2px] active:translate-y-[2px] active:shadow-none ${d?"text-white border border-white/30 bg-black hover:bg-white/10":"text-theme-ink border-[length:var(--border-width)] border-theme-border bg-theme-paper hover:bg-theme-accent hover:text-theme-paper"}`,title:"Backup & Restore",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),r.jsx("span",{children:"Backup"})]})]}),r.jsxs("div",{className:"relative",ref:W,children:[r.jsx("button",{onClick:()=>L(!I),className:`flex items-center justify-center px-2 py-2 rounded-button transition-colors shadow-theme active:translate-x-[2px] active:translate-y-[2px] active:shadow-none ${d?"bg-black text-white hover:bg-white/10 border border-white/30":"bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper border-[length:var(--border-width)] border-theme-border"}`,title:"Menu",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})}),I&&r.jsxs("div",{className:`absolute right-0 top-full mt-2 min-w-[160px] rounded-button shadow-lg overflow-hidden z-50 ${d?"bg-black border border-white/30":"bg-white border border-gray-300"}`,children:[r.jsxs("button",{onClick:()=>{re(),L(!1)},className:`w-full px-4 py-3 text-left text-sm font-body flex items-center gap-3 transition-colors ${d?"text-white hover:bg-white/10":"text-gray-700 hover:bg-gray-100"}`,children:[d?r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),r.jsx("span",{children:d?"Light Mode":"Dark Mode"})]}),r.jsxs("button",{onClick:()=>{Ne(!0),L(!1)},className:`sm:hidden w-full px-4 py-3 text-left text-sm font-body flex items-center gap-3 transition-colors ${d?"text-white hover:bg-white/10":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),r.jsx("span",{children:"Gallery"})]}),r.jsxs("button",{onClick:()=>{y(),L(!1)},className:`sm:hidden w-full px-4 py-3 text-left text-sm font-body flex items-center gap-3 transition-colors ${d?"text-white hover:bg-white/10":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),r.jsx("span",{children:"Tutorial"})]}),r.jsxs("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLScDC-2AnN7OXojo3C-6TdoOfpco1qLAhW7wbB93C4POC4y8KA/viewform?usp=dialog",target:"_blank",rel:"noopener noreferrer",onClick:()=>L(!1),className:`w-full px-4 py-3 text-left text-sm font-body flex items-center gap-3 transition-colors ${d?"text-white hover:bg-white/10":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),r.jsx("span",{children:"Feedback"})]}),r.jsxs("button",{onClick:()=>{N(!0),L(!1)},className:`sm:hidden w-full px-4 py-3 text-left text-sm font-body flex items-center gap-3 transition-colors ${d?"text-white hover:bg-white/10":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),r.jsx("span",{children:"Backup"})]}),r.jsxs("a",{href:"https://buymeacoffee.com/wackyweasel",target:"_blank",rel:"noopener noreferrer",onClick:()=>L(!1),className:`w-full px-4 py-3 text-left text-sm font-body flex items-center gap-3 transition-colors ${d?"text-white hover:bg-white/10":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),r.jsx("span",{children:"Donate"})]})]})]})]})]}),r.jsxs("div",{className:"mb-6 flex gap-2",children:[r.jsx("button",{"data-tutorial":"create-character",onClick:()=>{var U;O(d?"classic-dark":"default"),j(!0),S===0&&((U=_e[0])==null?void 0:U.id)==="create-character"&&v()},className:`flex-1 px-6 py-4 text-lg font-bold transition-colors shadow-theme active:translate-x-[2px] active:translate-y-[2px] active:shadow-none rounded-button font-heading ${d?"bg-white text-black hover:bg-white/80":"bg-theme-accent text-theme-paper hover:bg-theme-accent-hover"} ${S===0?"outline outline-4 outline-blue-500 outline-offset-2":""}`,children:"+ CREATE NEW CHARACTER"}),r.jsxs("label",{className:`px-4 py-4 font-bold transition-colors shadow-theme active:translate-x-[2px] active:translate-y-[2px] active:shadow-none rounded-button font-heading cursor-pointer text-center flex items-center justify-center ${d?"bg-black text-white border border-white/30 hover:bg-white/10":"bg-theme-paper text-theme-ink border-[length:var(--border-width)] border-theme-border hover:bg-theme-accent hover:text-theme-paper"}`,children:["IMPORT",r.jsx("input",{ref:Q,type:"file",accept:".json",onChange:me,className:"hidden"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 pb-4",children:[s.map(U=>{const ue=Ib(U.theme),Me=U.theme?dr(U.theme):void 0,pe=(Me==null?void 0:Me.cardTexture)||"none",xe=Et(pe);return r.jsxs("div",{style:ue,className:`p-4 active:translate-x-[2px] active:translate-y-[2px] transition-transform cursor-pointer relative group ${V===U.id?"z-40":""}`,onClick:()=>f(U.id),children:[r.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",style:{backgroundColor:"var(--card-background)",backgroundImage:xe?"none":"var(--card-texture)",borderRadius:"var(--card-radius)",border:"var(--card-border-width) var(--card-border-style) var(--card-border)",boxShadow:"var(--card-shadow-style)"},children:xe&&r.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:"var(--card-background)"},children:r.jsx("div",{style:{position:"absolute",inset:0,backgroundImage:`url(${Jt[pe]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:"var(--card-texture-opacity)",mixBlendMode:"overlay"}})})}),r.jsxs("div",{className:"relative",children:[r.jsx("h2",{className:"text-xl font-bold mb-2 pr-12",style:{color:"var(--card-ink)"},children:U.name}),r.jsxs("p",{className:"text-sm mb-2",style:{color:"var(--card-muted)"},children:[U.sheets.reduce((le,tt)=>le+tt.widgets.length,0)," Widgets  ",U.sheets.length," Sheet",U.sheets.length!==1?"s":""]}),r.jsxs("div",{className:`absolute top-0 right-0 ${V===U.id?"z-50":"z-10"}`,ref:V===U.id?Z:void 0,children:[r.jsx("button",{onClick:le=>{le.stopPropagation(),z(V===U.id?null:U.id)},className:"p-1.5 rounded transition-colors",style:{color:"var(--card-muted)",backgroundColor:"transparent"},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="var(--card-accent)",le.currentTarget.style.color="var(--card-background)"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="transparent",le.currentTarget.style.color="var(--card-muted)"},title:"Options",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("circle",{cx:"12",cy:"5",r:"2"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"}),r.jsx("circle",{cx:"12",cy:"19",r:"2"})]})}),V===U.id&&r.jsxs("div",{className:"absolute right-0 top-full mt-1 min-w-[120px] rounded shadow-lg overflow-hidden z-50",style:{backgroundColor:"var(--card-background)",border:"1px solid var(--card-border)"},children:[r.jsxs("button",{onClick:le=>{le.stopPropagation(),F(U.name),J(U.id),z(null)},className:"w-full px-3 py-2 text-left text-sm font-medium flex items-center gap-2 transition-colors",style:{color:"var(--card-ink)",backgroundColor:"var(--card-background)"},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="var(--card-accent)",le.currentTarget.style.color="var(--card-background)"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="var(--card-background)",le.currentTarget.style.color="var(--card-ink)"},children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Rename"]}),r.jsxs("button",{onClick:le=>{le.stopPropagation(),fe(U),z(null)},className:"w-full px-3 py-2 text-left text-sm font-medium flex items-center gap-2 transition-colors",style:{color:"var(--card-ink)",backgroundColor:"var(--card-background)"},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="var(--card-accent)",le.currentTarget.style.color="var(--card-background)"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="var(--card-background)",le.currentTarget.style.color="var(--card-ink)"},children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export"]}),r.jsxs("button",{onClick:le=>{le.stopPropagation(),g(U.id),z(null)},className:"w-full px-3 py-2 text-left text-sm font-medium flex items-center gap-2 transition-colors",style:{color:"var(--card-ink)",backgroundColor:"var(--card-background)"},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="var(--card-accent)",le.currentTarget.style.color="var(--card-background)"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="var(--card-background)",le.currentTarget.style.color="var(--card-ink)"},children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Duplicate"]}),r.jsxs("button",{onClick:le=>{le.stopPropagation(),he(U),$e(`${U.name} Preset`),Qe(!0),oe(!0),z(null)},className:"w-full px-3 py-2 text-left text-sm font-medium flex items-center gap-2 transition-colors",style:{color:"var(--card-ink)",backgroundColor:"var(--card-background)"},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="var(--card-accent)",le.currentTarget.style.color="var(--card-background)"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="var(--card-background)",le.currentTarget.style.color="var(--card-ink)"},children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Create Preset"]}),r.jsxs("button",{onClick:le=>{le.stopPropagation(),C(U.id),z(null)},className:"w-full px-3 py-2 text-left text-sm font-medium flex items-center gap-2 transition-colors",style:{color:"var(--card-ink)",backgroundColor:"var(--card-background)"},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="#ef4444",le.currentTarget.style.color="#ffffff"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="var(--card-background)",le.currentTarget.style.color="var(--card-ink)"},children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]})]})]},U.id)}),s.length===0&&r.jsx("div",{className:`col-span-full text-center py-8 border-[length:var(--border-width)] border-dashed text-sm rounded-theme font-body ${d?"text-white/50 border-white/30":"text-theme-muted border-theme-border/50"}`,children:"No characters found. Create one to begin."})]}),k&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>C(null)}),r.jsxs("div",{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 shadow-theme rounded-theme p-4 z-50 min-w-[250px] ${d?"bg-black border border-white/30":"bg-theme-paper border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsx("h3",{className:`font-heading font-bold mb-2 ${d?"text-white":"text-theme-ink"}`,children:"Delete Character?"}),r.jsxs("p",{className:`text-sm font-body mb-4 ${d?"text-white/60":"text-theme-muted"}`,children:['Are you sure you want to delete "',(Je=s.find(U=>U.id===k))==null?void 0:Je.name,'"? This will delete all sheets and widgets.']}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>C(null),className:`px-3 py-1.5 text-sm font-body rounded-button transition-colors ${d?"text-white hover:bg-white/10":"text-theme-ink hover:bg-theme-accent/20"}`,children:"Cancel"}),r.jsx("button",{onClick:()=>{w(k),C(null)},className:"px-3 py-1.5 text-sm font-body bg-red-500 text-white hover:bg-red-600 rounded-button transition-colors",children:"Delete"})]})]})]}),Y&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>J(null)}),r.jsxs("div",{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 shadow-theme rounded-theme p-4 z-50 min-w-[300px] ${d?"bg-black border border-white/30":"bg-theme-paper border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsx("h3",{className:`font-heading font-bold mb-2 ${d?"text-white":"text-theme-ink"}`,children:"Rename Character"}),r.jsx("input",{type:"text",value:$,onChange:U=>F(U.target.value),onKeyDown:U=>{U.key==="Enter"&&$.trim()?(u(Y,$.trim()),J(null)):U.key==="Escape"&&J(null)},autoFocus:!0,className:`w-full px-3 py-2 text-sm font-body rounded-button border mb-4 ${d?"bg-white/10 border-white/30 text-white":"bg-theme-background border-theme-border text-theme-ink"}`,placeholder:"Character name"}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>J(null),className:`px-3 py-1.5 text-sm font-body rounded-button transition-colors ${d?"text-white hover:bg-white/10":"text-theme-ink hover:bg-theme-accent/20"}`,children:"Cancel"}),r.jsx("button",{onClick:()=>{$.trim()&&(u(Y,$.trim()),J(null))},className:`px-3 py-1.5 text-sm font-body rounded-button transition-colors ${d?"bg-white text-black hover:bg-white/90":"bg-theme-accent text-theme-paper hover:opacity-90"}`,children:"Rename"})]})]})]}),X&&H&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>{oe(!1),he(null)}}),r.jsxs("div",{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 shadow-theme rounded-theme p-6 z-50 w-[90vw] max-w-[400px] ${d?"bg-black border border-white/30":"bg-theme-paper border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsx("h3",{className:`font-heading font-bold text-xl mb-4 ${d?"text-white":"text-theme-ink"}`,children:"Create Preset"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:`block text-sm font-body mb-1 ${d?"text-white/60":"text-theme-muted"}`,children:"Preset Name"}),r.jsx("input",{type:"text",value:je,onChange:U=>$e(U.target.value),placeholder:"Enter preset name...",className:`w-full p-3 text-base shadow-theme focus:outline-none focus:translate-x-[1px] focus:translate-y-[1px] focus:shadow-none transition-all rounded-theme font-body ${d?"bg-black text-white border border-white/30 placeholder-white/40":"bg-theme-paper text-theme-ink border-[length:var(--border-width)] border-theme-border"}`,autoFocus:!0})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("label",{className:`flex items-center gap-3 cursor-pointer ${d?"text-white":"text-theme-ink"}`,children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"checkbox",checked:Se,onChange:U=>Qe(U.target.checked),className:"sr-only"}),r.jsx("div",{className:`w-5 h-5 rounded transition-colors flex items-center justify-center ${d?`border border-white/30 ${Se?"bg-white":"bg-black"}`:`border-[length:var(--border-width)] border-theme-border ${Se?"bg-theme-accent":"bg-theme-paper"}`}`,children:Se&&r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 ${d?"text-black":"text-theme-paper"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})})]}),r.jsx("span",{className:"text-sm font-body",children:"Include theme in preset"})]}),r.jsx("p",{className:`text-xs font-body mt-1 ml-8 ${d?"text-white/50":"text-theme-muted"}`,children:"When enabled, the character's theme will be automatically applied when creating a new character from this preset."})]}),r.jsxs("div",{className:"flex gap-3 justify-end",children:[r.jsx("button",{onClick:()=>{oe(!1),he(null)},className:`px-4 py-2 font-body rounded-button transition-colors ${d?"text-white border border-white/30 hover:bg-white/10":"text-theme-ink border-[length:var(--border-width)] border-theme-border hover:bg-theme-accent/20"}`,children:"Cancel"}),r.jsx("button",{onClick:()=>{o(H,je||`${H.name} Preset`,Se),oe(!1),he(null)},className:`px-6 py-2 font-body rounded-button transition-colors font-bold ${d?"bg-white text-black hover:bg-white/80":"bg-theme-accent text-theme-paper hover:bg-theme-accent-hover"}`,children:"Create"})]})]})]}),Ae&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60]",onClick:()=>G(null)}),r.jsxs("div",{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 shadow-theme rounded-theme p-4 z-[60] min-w-[280px] ${d?"bg-black border border-white/30":"bg-theme-paper border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsx("h3",{className:`font-heading font-bold mb-2 ${d?"text-white":"text-theme-ink"}`,children:"Delete Preset?"}),r.jsxs("p",{className:`text-sm font-body mb-4 ${d?"text-white/60":"text-theme-muted"}`,children:['Are you sure you want to delete "',Ae.name,'"? This action cannot be undone.']}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>G(null),className:`px-3 py-1.5 text-sm font-body rounded-button transition-colors ${d?"text-white hover:bg-white/10":"text-theme-ink hover:bg-theme-accent/20"}`,children:"Cancel"}),r.jsx("button",{onClick:()=>{a(Ae.id),P===`user:${Ae.id}`&&A(""),G(null)},className:"px-3 py-1.5 text-sm font-body bg-red-500 text-white hover:bg-red-600 rounded-button transition-colors",children:"Delete"})]})]})]}),x&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>j(!1)}),r.jsxs("div",{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 shadow-theme rounded-theme p-6 z-50 w-[90vw] max-w-[400px] ${d?"bg-black border border-white/30":"bg-theme-paper border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsx("h3",{className:`font-heading font-bold text-xl mb-4 ${d?"text-white":"text-theme-ink"}`,children:"Create New Character"}),r.jsxs("div",{className:"mb-4","data-tutorial":"character-name-input",children:[r.jsx("label",{className:`block text-sm font-body mb-1 ${d?"text-white/60":"text-theme-muted"}`,children:"Character Name"}),r.jsx("input",{type:"text",value:p,onChange:U=>{var ue;M(U.target.value),S===1&&((ue=_e[1])==null?void 0:ue.id)==="name-character"&&U.target.value.trim().length>0&&v()},placeholder:"Enter character name...",className:`w-full p-3 text-base shadow-theme focus:outline-none focus:translate-x-[1px] focus:translate-y-[1px] focus:shadow-none transition-all rounded-theme font-body ${d?"bg-black text-white border border-white/30 placeholder-white/40":"bg-theme-paper text-theme-ink border-[length:var(--border-width)] border-theme-border"} ${S===1?"ring-4 ring-blue-500 ring-offset-2":""}`,autoFocus:!0})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:`block text-sm font-body mb-1 ${d?"text-white/60":"text-theme-muted"}`,children:"Preset"}),r.jsxs("div",{className:"relative",ref:Te,children:[r.jsxs("button",{type:"button",onClick:()=>de(!ae),className:`w-full p-3 text-base shadow-theme focus:outline-none transition-all rounded-theme font-body cursor-pointer text-left flex items-center justify-between ${d?"bg-black text-white border border-white/30":"bg-theme-paper text-theme-ink border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsx("span",{children:P===""?"No Preset":P.startsWith("user:")?((qe=n.find(U=>U.id===P.replace("user:","")))==null?void 0:qe.name)||"No Preset":P}),r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform ${ae?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),ae&&r.jsxs("div",{className:`absolute z-50 w-full mt-1 rounded-theme shadow-theme max-h-60 overflow-y-auto ${d?"bg-black border border-white/30":"bg-theme-paper border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsx("button",{type:"button",onClick:()=>{A(""),de(!1)},className:`w-full px-3 py-3 text-left text-base font-body transition-colors ${P===""?d?"bg-white/20":"bg-theme-accent/20":d?"hover:bg-white/10 active:bg-white/20":"hover:bg-theme-accent/10 active:bg-theme-accent/20"} ${d?"text-white":"text-theme-ink"}`,children:"No Preset"}),B.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`px-3 py-1.5 text-xs font-body font-semibold uppercase tracking-wider ${d?"text-white/40 bg-white/5":"text-theme-muted bg-theme-accent/5"}`,children:"Built-in Presets"}),B.map(U=>r.jsx("button",{type:"button",onClick:()=>{A(U),de(!1)},className:`w-full px-3 py-3 text-left text-base font-body transition-colors ${P===U?d?"bg-white/20":"bg-theme-accent/20":d?"hover:bg-white/10 active:bg-white/20":"hover:bg-theme-accent/10 active:bg-theme-accent/20"} ${d?"text-white":"text-theme-ink"}`,children:U},U))]}),n.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`px-3 py-1.5 text-xs font-body font-semibold uppercase tracking-wider ${d?"text-white/40 bg-white/5":"text-theme-muted bg-theme-accent/5"}`,children:"My Presets"}),n.map(U=>r.jsxs("div",{className:`flex items-center group ${P===`user:${U.id}`?d?"bg-white/20":"bg-theme-accent/20":d?"hover:bg-white/10 active:bg-white/20":"hover:bg-theme-accent/10 active:bg-theme-accent/20"}`,children:[r.jsx("button",{type:"button",onClick:()=>{A(`user:${U.id}`),U.theme&&O(U.theme),de(!1)},className:`flex-1 px-3 py-3 text-left text-base font-body transition-colors ${d?"text-white":"text-theme-ink"}`,children:U.name}),r.jsx("button",{type:"button",onClick:ue=>{ue.stopPropagation(),G(U),de(!1)},className:`px-3 py-2 min-w-[44px] min-h-[44px] flex items-center justify-center transition-colors active:bg-red-500/20 ${d?"text-white/40 hover:text-red-400":"text-theme-muted hover:text-red-500"}`,title:"Delete preset",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]},`user:${U.id}`))]})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:`block text-sm font-body mb-1 ${d?"text-white/60":"text-theme-muted"}`,children:"Theme"}),r.jsxs("select",{value:_,onChange:U=>O(U.target.value),className:`w-full p-3 text-base shadow-theme focus:outline-none transition-all rounded-theme font-body cursor-pointer ${d?"bg-black text-white border border-white/30":"bg-theme-paper text-theme-ink border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsx("optgroup",{label:"Built-in Themes",children:Nr.map(U=>r.jsxs("option",{value:U.id,children:[U.icon," ",U.name]},U.id))}),Object.keys(e).length>0&&r.jsx("optgroup",{label:"Custom Themes",children:Object.values(e).map(U=>r.jsxs("option",{value:U.id,children:[" ",U.name]},U.id))})]})]}),r.jsxs("div",{className:"flex gap-3 justify-end",children:[r.jsx("button",{onClick:()=>{j(!1),M(""),A(""),O("default")},className:`px-4 py-2 font-body rounded-button transition-colors ${d?"text-white border border-white/30 hover:bg-white/10":"text-theme-ink border-[length:var(--border-width)] border-theme-border hover:bg-theme-accent/20"}`,children:"Cancel"}),r.jsx("button",{"data-tutorial":"create-button",onClick:()=>{var U;te(),S===2&&((U=_e[2])==null?void 0:U.id)==="click-create"&&v()},className:`px-6 py-2 font-body rounded-button transition-colors font-bold ${d?"bg-white text-black hover:bg-white/80":"bg-theme-accent text-theme-paper hover:bg-theme-accent-hover"} ${S===2?"ring-4 ring-blue-500 ring-offset-2":""}`,children:"Create"})]})]})]}),E&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>N(!1)}),r.jsxs("div",{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 shadow-theme rounded-theme p-6 z-50 w-[90vw] max-w-[450px] ${d?"bg-black border border-white/30":"bg-theme-paper border-[length:var(--border-width)] border-theme-border"}`,children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:`font-heading font-bold text-xl ${d?"text-white":"text-theme-ink"}`,children:"Backup & Restore"}),r.jsx("button",{onClick:()=>N(!1),className:`transition-colors ${d?"text-white/60 hover:text-white":"text-theme-muted hover:text-theme-ink"}`,children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:`rounded-theme p-4 mb-6 ${d?"bg-yellow-900/30 border border-yellow-500/30":"bg-yellow-500/10 border border-yellow-500/30"}`,children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 flex-shrink-0 mt-0.5 ${d?"text-yellow-400":"text-yellow-600"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),r.jsxs("div",{children:[r.jsx("p",{className:`font-body text-sm font-semibold mb-1 ${d?"text-white":"text-theme-ink"}`,children:"Your data is stored locally"}),r.jsx("p",{className:`font-body text-sm ${d?"text-white/60":"text-theme-muted"}`,children:"All your characters and settings are stored in your browser's local storage. This data may be lost if you clear your browser cache, use private/incognito mode, or switch browsers."})]})]})}),r.jsxs("div",{className:"mb-4",children:[r.jsx("h4",{className:`font-body font-semibold mb-2 ${d?"text-white":"text-theme-ink"}`,children:"Create Backup"}),r.jsx("p",{className:`font-body text-sm mb-3 ${d?"text-white/60":"text-theme-muted"}`,children:"Download a backup file containing all your characters and custom themes."}),r.jsxs("button",{onClick:be,className:`w-full flex items-center justify-center gap-2 px-4 py-3 font-body rounded-button transition-colors font-bold ${d?"bg-white text-black hover:bg-white/80":"bg-theme-accent text-theme-paper hover:bg-theme-accent-hover"}`,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download Backup"]})]}),r.jsx("div",{className:`border-t my-4 ${d?"border-white/30":"border-theme-border"}`}),r.jsxs("div",{children:[r.jsx("h4",{className:`font-body font-semibold mb-2 ${d?"text-white":"text-theme-ink"}`,children:"Restore from Backup"}),r.jsxs("p",{className:`font-body text-sm mb-3 ${d?"text-white/60":"text-theme-muted"}`,children:["Upload a backup file to restore your characters and themes. ",r.jsx("span",{className:"text-red-500 font-semibold",children:"This will replace all current data."})]}),r.jsxs("label",{className:`w-full flex items-center justify-center gap-2 px-4 py-3 font-body rounded-theme transition-colors font-bold cursor-pointer ${d?"border border-white/30 text-white hover:bg-white/10":"border-[length:var(--border-width)] border-theme-border text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Upload Backup File",r.jsx("input",{ref:K,type:"file",accept:".json",onChange:Ie,className:"hidden"})]})]})]})]}),m&&r.jsx(tf,{darkMode:d})]}),r.jsx("div",{className:`fixed bottom-0 left-0 right-0 py-2 text-center ${d?"bg-black/80 border-t border-white/10":"bg-gray-100/80 border-t border-gray-200"} backdrop-blur-sm`,children:r.jsx("p",{className:`text-xs ${d?"text-white/40":"text-gray-400"}`,children:"Character designs are shared anonymously to help improve UCS. No images or personal data are stored."})}),r.jsx(Hg,{collapsed:!ce,onToggle:()=>Ne(!1),darkMode:d})]})}const ht=Cr(e=>({printerFriendly:!1,textureDisabled:!1,bordersDisabled:!1,shadowsDisabled:!1,printArea:null,previousMode:null,setPrinterFriendly:t=>e({printerFriendly:t}),setTextureDisabled:t=>e({textureDisabled:t}),setBordersDisabled:t=>e({bordersDisabled:t}),setShadowsDisabled:t=>e({shadowsDisabled:t}),setPrintArea:t=>e({printArea:t}),setPreviousMode:t=>e({previousMode:t}),calculatePrintAreaFromWidgets:t=>{if(!t||t.length===0)return null;let n=1/0,o=1/0,a=-1/0,s=-1/0;t.forEach(c=>{const l=c.w||200,u=c.h||120;n=Math.min(n,c.x),o=Math.min(o,c.y),a=Math.max(a,c.x+l),s=Math.max(s,c.y+u)});const i=10;return{x:n-i,y:o-i,width:a-n+i*2,height:s-o+i*2}},resetPrintSettings:()=>e({printerFriendly:!1,textureDisabled:!1,bordersDisabled:!1,shadowsDisabled:!1,printArea:null,previousMode:null})}));function Pb({minScale:e=.1,maxScale:t=5,editingWidgetId:n,mode:o,onBackgroundClick:a}){const[s,i]=T.useState({x:0,y:0}),[c,l]=T.useState(1),[u,h]=T.useState(!1),g=T.useRef({x:0,y:0});T.useEffect(()=>{const k=()=>h(!1),C=x=>{if(u){const j=x.clientX-g.current.x,E=x.clientY-g.current.y;i(N=>({x:N.x+j,y:N.y+E})),g.current={x:x.clientX,y:x.clientY}}};return window.addEventListener("mouseup",k),window.addEventListener("mousemove",C),()=>{window.removeEventListener("mouseup",k),window.removeEventListener("mousemove",C)}},[u]);const f=T.useCallback(k=>{n||k.target.closest(".react-draggable")||(a==null||a(),o==="play"||o==="print"?k.button===0&&(k.preventDefault(),h(!0),g.current={x:k.clientX,y:k.clientY}):(k.button===0||k.button===1)&&(k.preventDefault(),h(!0),g.current={x:k.clientX,y:k.clientY}))},[n,o,a]),w=T.useCallback(k=>{if(u){const C=k.clientX-g.current.x,x=k.clientY-g.current.y;i(j=>({x:j.x+C,y:j.y+x})),g.current={x:k.clientX,y:k.clientY}}},[u]),S=T.useCallback(()=>{h(!1)},[]),y=T.useCallback(k=>{if(n)return;const C=Math.exp(-k.deltaY*.001),x=Math.min(Math.max(c*C,e),t),j=k.clientX,E=k.clientY,N=(j-s.x)/c,p=(E-s.y)/c,M=j-N*x,P=E-p*x;l(x),i({x:M,y:P})},[n,o,c,s,e,t]),v=T.useCallback(()=>{l(k=>Math.min(t,k*1.3))},[t]),m=T.useCallback(()=>{l(k=>Math.max(e,k/1.3))},[e]),d=T.useCallback(()=>{l(1),i({x:0,y:0})},[]),b=T.useCallback((k,C)=>{i(k),l(C)},[]);return{pan:s,scale:c,isPanning:u,setPan:i,setScale:l,handleMouseDown:f,handleMouseMove:w,handleMouseUp:S,handleWheel:y,zoomIn:v,zoomOut:m,resetView:d,setView:b}}function Rb({mode:e,onPanChange:t,onScaleChange:n,onPinchingChange:o,getScale:a,getPan:s,minScale:i=.1,maxScale:c=5,onBackgroundTouch:l}){const u=T.useRef(null),h=T.useRef(null),g=T.useRef(new Map),f=T.useRef(!1),w=T.useRef(!1),S=T.useRef(e);T.useEffect(()=>{S.current=e},[e]);const y=T.useRef(l);return T.useEffect(()=>{y.current=l},[l]),T.useEffect(()=>{const v=N=>{for(;N&&N!==document.body;){const p=window.getComputedStyle(N),M=p.overflowY,P=p.overflowX;if((M==="auto"||M==="scroll"||P==="auto"||P==="scroll")&&(N.scrollHeight>N.clientHeight||N.scrollWidth>N.clientWidth))return!0;N=N.parentElement}return!1},m=N=>{for(;N&&N!==document.body;){if(N.classList.contains("react-draggable"))return!0;N=N.parentElement}return!1},d=N=>{for(;N&&N!==document.body;){if(N.classList.contains("fixed")&&(N.classList.contains("left-0")||N.classList.contains("right-0")))return!0;N=N.parentElement}return!1},b=N=>!!(N&&N.tagName==="CANVAS"),k=N=>{for(;N&&N!==document.body;){if(N.classList.contains("print-area-overlay"))return!0;N=N.parentElement}return!1};let C=null;const x=N=>{var p;N.touches.length===1&&(C=N.target);for(let M=0;M<N.touches.length;M++){const P=N.touches[M];g.current.set(P.identifier,{x:P.clientX,y:P.clientY})}if(!(C&&d(C))){if(N.touches.length===1&&(w.current=v(N.target)),g.current.size>=2){N.preventDefault(),N.stopPropagation(),N.stopImmediatePropagation(),o(!0);const M=Array.from(g.current.values()),P=M[0].x-M[1].x,A=M[0].y-M[1].y;u.current=Math.sqrt(P*P+A*A),h.current={x:(M[0].x+M[1].x)/2,y:(M[0].y+M[1].y)/2},f.current=!1}else if(g.current.size===1){const M=C&&m(C),P=w.current,A=C&&b(C),_=C&&k(C);if(!M&&!P&&!A&&!_&&((p=y.current)==null||p.call(y)),!P&&!A&&!_&&(S.current==="play"?!0:!M)){const V=g.current.values().next().value;V&&(h.current={x:V.x,y:V.y},f.current=!0)}}}},j=N=>{if(C&&d(C))return;for(let M=0;M<N.touches.length;M++){const P=N.touches[M];g.current.set(P.identifier,{x:P.clientX,y:P.clientY})}const p=g.current.size;if(p>=2){const M=Array.from(g.current.values()),P=M[0].x-M[1].x,A=M[0].y-M[1].y,_=Math.sqrt(P*P+A*A),O={x:(M[0].x+M[1].x)/2,y:(M[0].y+M[1].y)/2};if(u.current===null||h.current===null){u.current=_,h.current=O,f.current=!1,N.preventDefault(),N.stopPropagation(),N.stopImmediatePropagation();return}N.preventDefault(),N.stopPropagation(),N.stopImmediatePropagation();const V=a(),z=s(),I=_/u.current,L=Math.min(Math.max(V*I,i),c),Y=(O.x-z.x)/V,J=(O.y-z.y)/V,$=O.x-Y*L,F=O.y-J*L,X=O.x-h.current.x,oe=O.y-h.current.y;n(L),t(()=>({x:$+X,y:F+oe})),u.current=_,h.current=O}else if(p===1&&f.current&&h.current){const M=g.current.values().next().value;if(M){N.preventDefault();const P=M.x-h.current.x,A=M.y-h.current.y;t(_=>({x:_.x+P,y:_.y+A})),h.current={x:M.x,y:M.y}}}},E=N=>{for(let p=0;p<N.changedTouches.length;p++)g.current.delete(N.changedTouches[p].identifier);g.current.size===0?(u.current=null,h.current=null,f.current=!1,w.current=!1,C=null,o(!1)):g.current.size===1&&(u.current=null,f.current=!1)};return document.addEventListener("touchstart",x,{passive:!1,capture:!0}),document.addEventListener("touchmove",j,{passive:!1,capture:!0}),document.addEventListener("touchend",E,{passive:!0,capture:!0}),document.addEventListener("touchcancel",E,{passive:!0,capture:!0}),()=>{document.removeEventListener("touchstart",x,{capture:!0}),document.removeEventListener("touchmove",j,{capture:!0}),document.removeEventListener("touchend",E,{capture:!0}),document.removeEventListener("touchcancel",E,{capture:!0})}},[t,n,o,a,s,i,c]),{isTouchPanning:f}}const kt=10,po=10;function Db({widgets:e,scale:t}){const n=q(s=>s._takeSnapshot),o=q(s=>s.updateWidgetPositionNoSnapshot);return{handleAutoStack:T.useCallback(()=>{if(e.length===0)return;n("Auto stack");const s=document.querySelectorAll(".react-draggable[data-widget-id]"),i=[];s.forEach(d=>{const b=d.getAttribute("data-widget-id");if(b){const k=d.getBoundingClientRect();i.push({id:b,w:Math.ceil(k.width/t/kt)*kt,h:Math.ceil(k.height/t/kt)*kt})}});const c=e.map(d=>{const b=i.find(k=>k.id===d.id);return{id:d.id,groupId:d.groupId,x:d.x,y:d.y,w:b?b.w:d.w||200,h:b?b.h:d.h||120}}),l=new Map,u=[];for(const d of c)if(d.groupId){const b=l.get(d.groupId)||[];b.push(d),l.set(d.groupId,b)}else u.push(d);const h=[];for(const[d,b]of l){if(b.length===0)continue;const k=Math.min(...b.map(E=>E.x)),C=Math.min(...b.map(E=>E.y)),x=Math.max(...b.map(E=>E.x+E.w)),j=Math.max(...b.map(E=>E.y+E.h));h.push({type:"group",id:d,widgets:b,boundingBox:{x:k,y:C,w:x-k,h:j-C},originalOffset:{x:k,y:C}})}for(const d of u)h.push({type:"single",id:d.id,widgets:[d],boundingBox:{x:d.x,y:d.y,w:d.w,h:d.h},originalOffset:{x:d.x,y:d.y}});const g=h.reduce((d,b)=>d+(b.boundingBox.w+po)*(b.boundingBox.h+po),0),f=Math.max(800,Math.ceil(Math.sqrt(g*1.5)/kt)*kt),w=[...h].sort((d,b)=>{const C=Math.floor(d.boundingBox.y/50),x=Math.floor(b.boundingBox.y/50);return C!==x?C-x:d.boundingBox.x-b.boundingBox.x});let S=[{x:0,y:0,w:f,h:1e5}];const y=[],v=(d,b)=>{let k=1/0,C=0,x=0,j=!1;for(const E of S)if(d<=E.w&&b<=E.h){const N=E.w-d,p=E.h-b,M=Math.min(N,p),P=E.y*1e4+M;P<k&&(k=P,C=E.x,x=E.y,j=!0)}return j?{x:C,y:x}:null},m=(d,b,k,C)=>{const x=[];for(const j of S){if(d>=j.x+j.w||d+k<=j.x||b>=j.y+j.h||b+C<=j.y){x.push(j);continue}d>j.x&&x.push({x:j.x,y:j.y,w:d-j.x,h:j.h}),d+k<j.x+j.w&&x.push({x:d+k,y:j.y,w:j.x+j.w-(d+k),h:j.h}),b>j.y&&x.push({x:j.x,y:j.y,w:j.w,h:b-j.y}),b+C<j.y+j.h&&x.push({x:j.x,y:b+C,w:j.w,h:j.y+j.h-(b+C)})}S=x.filter((j,E)=>{for(let N=0;N<x.length;N++){if(E===N)continue;const p=x[N];if(j.x>=p.x&&j.y>=p.y&&j.x+j.w<=p.x+p.w&&j.y+j.h<=p.y+p.h)return!1}return!0})};for(const d of w){const b=d.boundingBox.w+po,k=d.boundingBox.h+po,C=v(b,k);if(C){const x=Math.round(C.x/kt)*kt,j=Math.round(C.y/kt)*kt;y.push({item:d,x,y:j}),m(x,j,b,k)}else{const x=y.reduce((j,E)=>Math.max(j,E.y+E.item.boundingBox.h+po),0);y.push({item:d,x:0,y:x}),m(0,x,b,k)}}for(const d of y){const{item:b,x:k,y:C}=d,x=k-b.originalOffset.x,j=C-b.originalOffset.y;for(const E of b.widgets){const N=Math.round((E.x+x)/kt)*kt,p=Math.round((E.y+j)/kt)*kt;o(E.id,N,p)}}},[e,t,n,o])}}function Lb({widgets:e,scale:t,setScale:n,setPan:o,minScale:a=.1,maxScale:s=5}){return{handleFitAllWidgets:T.useCallback(()=>{if(e.length===0){n(1),o({x:0,y:0});return}const c=document.querySelectorAll(".react-draggable[data-widget-id]"),l=[];if(c.forEach(M=>{const P=M.getAttribute("data-widget-id"),A=e.find(_=>_.id===P);if(A){const _=M.getBoundingClientRect();l.push({x:A.x,y:A.y,w:_.width/t,h:_.height/t})}}),l.length===0){n(1),o({x:0,y:0});return}const u=Math.min(...l.map(M=>M.x)),h=Math.min(...l.map(M=>M.y)),g=Math.max(...l.map(M=>M.x+M.w)),f=Math.max(...l.map(M=>M.y+M.h)),w=g-u,S=f-h,y=window.innerWidth,v=window.innerHeight,m=60,d=y-m*2,b=v-m*2,k=d/w,C=b/S,x=Math.min(Math.max(Math.min(k,C),a),s),j=(u+g)/2,E=(h+f)/2,N=y/2-j*x,p=v/2-E*x;n(x),o({x:N,y:p})},[e,t,n,o,a,s])}}const $b=[{type:"CHECKBOX",label:"Checklist"},{type:"TOGGLE_GROUP",label:"Conditions"},{type:"DECK",label:"Deck of Cards"},{type:"DICE_ROLLER",label:"Dice Roller"},{type:"DICE_TRAY",label:"Dice Tray"},{type:"FORM",label:"Form"},{type:"HEALTH_BAR",label:"Health Bar"},{type:"IMAGE",label:"Image"},{type:"INITIATIVE_TRACKER",label:"Initiative Tracker"},{type:"LIST",label:"List"},{type:"MAP_SKETCHER",label:"Map Sketcher"},{type:"NUMBER_DISPLAY",label:"Number Display"},{type:"NUMBER",label:"Number Tracker"},{type:"POOL",label:"Resource Pool"},{type:"PROGRESS_BAR",label:"Progress Bar"},{type:"REST_BUTTON",label:"Rest Button"},{type:"ROLL_TABLE",label:"Roll Table"},{type:"SPELL_SLOT",label:"Spell Slots"},{type:"TABLE",label:"Table"},{type:"TEXT",label:"Text Area"},{type:"TIME_TRACKER",label:"Temporary Effects"}];function Ab({collapsed:e,onToggle:t,viewport:n}){const o=q(x=>x.addWidget),a=q(x=>x.addWidgetFromTemplate),s=q(x=>x.addGroupFromTemplate),i=q(x=>x.activeCharacterId),l=q(x=>x.characters).find(x=>x.id===i),u=l!=null&&l.theme?dr(l.theme):void 0,h=l!=null&&l.theme?Ms(l.theme):void 0,g=(u==null?void 0:u.cardTexture)||(h==null?void 0:h.cardTexture)||"none",f=Et(g),w=bn(x=>x.templates),S=bn(x=>x.removeTemplate),[y,v]=T.useState(null),m=ot(x=>x.tutorialStep),d=ot(x=>x.advanceTutorial),b={5:"IMAGE",6:"HEALTH_BAR",7:"FORM",8:"NUMBER_DISPLAY"},k=x=>{o(x,100,100,n),m!==null&&b[m]===x&&d()},C=(x,j)=>{x.dataTransfer.setData("widgetType",j),x.dataTransfer.effectAllowed="copy"};return r.jsxs(r.Fragment,{children:[!e&&r.jsx("div",{className:"fixed inset-0 bg-black/30 z-40",onClick:()=>{var x;t(),m===9&&((x=_e[9])==null?void 0:x.id)==="close-toolbox"&&d()}}),r.jsxs("div",{className:`fixed left-0 top-0 bottom-0 w-[80vw] max-w-[280px] bg-theme-paper border-r-[length:var(--border-width)] border-theme-border z-50 flex flex-col p-3 shadow-theme overflow-hidden transition-transform duration-300 ease-in-out safe-area-bottom touch-pan-y ${e?"-translate-x-full":"translate-x-0"}`,children:[f&&r.jsx("div",{className:"absolute inset-0 pointer-events-none z-0",style:{backgroundColor:"var(--color-paper)"},children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url(${Jt[g]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:"var(--card-texture-opacity)",mixBlendMode:"overlay"}})}),r.jsx("button",{"data-tutorial":"close-toolbox",onClick:()=>{var x;t(),m===9&&((x=_e[9])==null?void 0:x.id)==="close-toolbox"&&d()},className:`absolute top-3 right-3 w-10 h-10 bg-theme-accent text-theme-paper font-bold flex items-center justify-center rounded-button z-20 shadow-theme ${m===9?"outline outline-4 outline-blue-500 outline-offset-2":""}`,children:""}),r.jsxs("div",{className:"relative z-10 flex flex-col h-full overflow-y-auto touch-pan-y pt-12 px-1",children:[r.jsx("div",{className:"mb-4",children:r.jsx("h2",{className:"text-xl font-bold uppercase tracking-wider border-b-[length:var(--border-width)] border-theme-border pb-2 text-theme-ink font-heading",children:"Toolbox"})}),r.jsx("div",{className:"flex flex-col gap-3 py-1",children:$b.map(({type:x,label:j})=>{const E=m!==null&&b[m]===x;return r.jsx("div",{"data-tutorial":`widget-${x}`,draggable:!0,onDragStart:N=>C(N,x),onClick:()=>k(x),className:`p-2 border-[length:var(--border-width)] border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-all text-left font-bold shadow-theme active:translate-x-[2px] active:translate-y-[2px] active:shadow-none cursor-pointer flex items-center gap-2 bg-theme-paper text-theme-ink rounded-button relative ${E?"outline outline-4 outline-blue-500 outline-offset-2":""}`,children:r.jsxs("span",{className:"text-xs font-body",children:["+ ",j]})},x)})}),w.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mt-6 mb-4",children:r.jsx("h2",{className:"text-xl font-bold uppercase tracking-wider border-b-[length:var(--border-width)] border-theme-border pb-2 text-theme-ink font-heading",children:"Templates"})}),r.jsx("div",{className:"flex flex-col gap-2",children:w.map(x=>{const j=Og(x);return r.jsxs("div",{className:"p-2 border-[length:var(--border-width)] border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-all text-left font-bold shadow-theme active:translate-x-[2px] active:translate-y-[2px] active:shadow-none cursor-pointer flex items-center justify-between bg-theme-paper text-theme-ink rounded-theme group",children:[r.jsxs("span",{className:"text-xs font-body flex-1 truncate flex items-center gap-1.5",onClick:()=>{j?s(x,n):a(x,n)},children:[j&&r.jsxs("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]}),"+ ",x.name,j&&r.jsxs("span",{className:"text-[10px] opacity-70",children:["(",x.widgets.length,")"]})]}),y===x.id?r.jsxs("div",{className:"flex gap-1 ml-2",children:[r.jsx("button",{className:"px-2 py-0.5 text-xs bg-red-500 text-white rounded hover:bg-red-600 transition-colors",onClick:E=>{E.stopPropagation(),S(x.id),v(null)},children:"Yes"}),r.jsx("button",{className:"px-2 py-0.5 text-xs bg-theme-border text-theme-ink rounded hover:bg-theme-muted transition-colors",onClick:E=>{E.stopPropagation(),v(null)},children:"No"})]}):r.jsx("button",{className:"ml-2 w-5 h-5 flex items-center justify-center text-theme-muted hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",onClick:E=>{E.stopPropagation(),v(x.id)},title:"Delete template",children:""})]},x.id)})})]}),r.jsxs("div",{className:"mt-auto pt-4 text-[10px] text-theme-muted border-t border-theme-border/50 font-body",children:[r.jsx("p",{children:"Tap to add widgets."}),r.jsx("p",{children:"Pan with finger/mouse."}),r.jsx("p",{children:"Pinch/scroll to zoom."}),r.jsx("p",{className:"mt-2 text-theme-ink font-bold",children:"Edit Mode Active"})]})]})]})]})}function _b({theme:e,onSave:t,onCancel:n,onDelete:o}){const a=!!(e!=null&&e.id&&e.id.length>0),s=_g(),[i,c]=T.useState((e==null?void 0:e.name)||s.name),[l,u]=T.useState((e==null?void 0:e.icon)||s.icon),[h,g]=T.useState((e==null?void 0:e.description)||s.description),[f,w]=T.useState((e==null?void 0:e.colors)||s.colors),[S,y]=T.useState((e==null?void 0:e.fonts.heading)||s.fonts.heading),[v,m]=T.useState((e==null?void 0:e.fonts.body)||s.fonts.body),[d,b]=T.useState((e==null?void 0:e.borderRadius)||s.borderRadius),[k,C]=T.useState((e==null?void 0:e.buttonRadius)||s.buttonRadius),[x,j]=T.useState((e==null?void 0:e.borderWidth)||s.borderWidth),[E,N]=T.useState((e==null?void 0:e.shadowStyle)||s.shadowStyle),[p,M]=T.useState((e==null?void 0:e.cardTexture)||s.cardTexture),P="#ffffff",[A,_]=T.useState((e==null?void 0:e.textureOpacity)??s.textureOpacity),[O,V]=T.useState((e==null?void 0:e.borderStyle)||s.borderStyle),[z,I]=T.useState(!1),[L,Y]=T.useState(null),J=(H,he)=>{w(je=>({...je,[H]:he}))},$=()=>{const H={id:e!=null&&e.id&&e.id.length>0?e.id:`custom-${Pe()}`,name:i,icon:l,description:h,colors:f,fonts:{heading:S,body:v},borderRadius:d,buttonRadius:k,borderWidth:x,shadowStyle:E,cardTexture:p,textureColor:"#ffffff",textureOpacity:A,borderStyle:O};t(H)},F=[{key:"background",label:"Background"},{key:"paper",label:"Paper/Card"},{key:"ink",label:"Text/Ink"},{key:"accent",label:"Accent"},{key:"accentHover",label:"Accent Hover"},{key:"border",label:"Border"},{key:"shadow",label:"Shadow"},{key:"muted",label:"Muted Text"},{key:"glow",label:"Glow"}],X=H=>!L||!H.includes(L)?{}:{outline:"3px dashed #ff6b6b",outlineOffset:"2px",animation:"pulse-highlight 1s ease-in-out infinite"},oe=()=>r.jsx("div",{className:"p-6",style:{backgroundColor:f.background,borderRadius:d,minHeight:"200px",...X(["background"])},children:r.jsxs("div",{className:"p-4 relative overflow-hidden",style:{backgroundColor:f.paper,backgroundImage:Et(p)?"none":lc(p,P,A),border:`${x} ${O} ${f.border}`,borderRadius:d,boxShadow:Qo(E,f.glow).replace(/var\(--color-shadow\)/g,f.shadow).replace(/var\(--color-border\)/g,f.border).replace(/var\(--color-glow\)/g,f.glow),...X(["paper","border","shadow","glow"])},children:[Et(p)&&r.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundColor:f.paper,borderRadius:d},children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url(${Jt[p]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:A,mixBlendMode:"overlay",borderRadius:d}})}),r.jsxs("h4",{className:"text-lg font-bold mb-2 relative",style:{color:f.ink,fontFamily:S,...X(["ink"])},children:[l," ",i]}),r.jsx("p",{className:"text-sm mb-4 relative",style:{color:f.muted,fontFamily:v,...X(["muted"])},children:h}),r.jsxs("div",{className:"flex gap-2 flex-wrap",children:[r.jsx("button",{className:"px-4 py-2 text-sm font-bold transition-colors relative",style:{backgroundColor:f.accent,color:f.paper,borderRadius:k,fontFamily:S,...X(["accent"])},children:"Primary Button"}),r.jsx("button",{className:"px-4 py-2 text-sm font-bold transition-colors relative",style:{backgroundColor:f.accentHover,color:f.paper,borderRadius:k,fontFamily:S,...X(["accentHover"])},children:"Hover State"})]})]})});return r.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-2",children:r.jsxs("div",{className:"bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-theme w-full max-w-4xl max-h-[95vh] flex flex-col",onClick:H=>H.stopPropagation(),children:[r.jsx("div",{className:"p-3 border-b-[length:var(--border-width)] border-theme-border bg-theme-paper flex-shrink-0",children:r.jsx("h2",{className:"text-lg font-bold text-theme-ink font-heading",children:a?" Edit Custom Theme":" Create Custom Theme"})}),r.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[r.jsxs("div",{className:"w-full flex-shrink-0 border-b-[length:var(--border-width)] border-theme-border p-4 bg-theme-background/50",children:[r.jsx("style",{children:`
              @keyframes pulse-highlight {
                0%, 100% { outline-color: #ff6b6b; }
                50% { outline-color: #ffb347; }
              }
            `}),r.jsx("h3",{className:"text-sm font-bold text-theme-ink mb-3 uppercase tracking-wider font-heading",children:"Preview"}),r.jsx("div",{children:r.jsx(oe,{})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-5",children:[r.jsxs("section",{children:[r.jsx("h3",{className:"text-sm font-bold text-theme-ink mb-3 uppercase tracking-wider font-heading",children:"Basic Info"}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Theme Name"}),r.jsx("input",{type:"text",value:i,onChange:H=>c(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",placeholder:"My Custom Theme"})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Icon"}),r.jsxs("button",{onClick:()=>I(!z),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body text-left flex items-center gap-2",children:[r.jsx("span",{className:"text-xl",children:l}),r.jsx("span",{className:"text-xs text-theme-muted",children:"Click to change"})]}),z&&r.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 p-2 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-theme z-20 grid grid-cols-10 gap-1 max-h-40 overflow-y-auto",children:$g.map(H=>r.jsx("button",{onClick:()=>{u(H),I(!1)},className:`p-1 text-lg hover:bg-theme-accent hover:text-theme-paper rounded ${l===H?"bg-theme-accent text-theme-paper":""}`,children:H},H))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Description"}),r.jsx("input",{type:"text",value:h,onChange:H=>g(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",placeholder:"A personalized theme"})]})]})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-sm font-bold text-theme-ink mb-3 uppercase tracking-wider font-heading",children:"Colors"}),r.jsx("div",{className:"grid grid-cols-3 gap-2",children:F.map(({key:H,label:he})=>r.jsxs("div",{className:"flex flex-col items-center",onMouseEnter:()=>Y(H),onMouseLeave:()=>Y(null),children:[r.jsx("label",{className:"block text-[10px] font-bold text-theme-muted mb-1 font-body text-center",children:he}),r.jsx("input",{type:"color",value:f[H],onChange:je=>J(H,je.target.value),className:"w-10 h-10 border-[length:var(--border-width)] border-theme-border rounded-theme cursor-pointer",style:{outline:L===H?"2px solid var(--color-accent)":void 0,outlineOffset:L===H?"2px":void 0}})]},H))})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-sm font-bold text-theme-ink mb-3 uppercase tracking-wider font-heading",children:"Fonts"}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Heading Font"}),r.jsx("select",{value:S,onChange:H=>y(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",children:Yd.map(H=>r.jsx("option",{value:H.value,style:{fontFamily:H.value},children:H.label},H.value))}),r.jsx("p",{className:"text-xs text-theme-muted mt-1",style:{fontFamily:S},children:"Preview: The quick brown fox"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Body Font"}),r.jsx("select",{value:v,onChange:H=>m(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",children:Yd.map(H=>r.jsx("option",{value:H.value,style:{fontFamily:H.value},children:H.label},H.value))}),r.jsx("p",{className:"text-xs text-theme-muted mt-1",style:{fontFamily:v},children:"Preview: The quick brown fox"})]})]})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-sm font-bold text-theme-ink mb-3 uppercase tracking-wider font-heading",children:"Style"}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Card Border Radius"}),r.jsxs("select",{value:d,onChange:H=>b(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",children:[r.jsx("option",{value:"0px",children:"Sharp (0px)"}),r.jsx("option",{value:"2px",children:"Subtle (2px)"}),r.jsx("option",{value:"4px",children:"Small (4px)"}),r.jsx("option",{value:"8px",children:"Medium (8px)"}),r.jsx("option",{value:"12px",children:"Large (12px)"}),r.jsx("option",{value:"16px",children:"Extra Large (16px)"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Button Border Radius"}),r.jsxs("select",{value:k,onChange:H=>C(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",children:[r.jsx("option",{value:"0px",children:"Sharp (0px)"}),r.jsx("option",{value:"2px",children:"Subtle (2px)"}),r.jsx("option",{value:"4px",children:"Small (4px)"}),r.jsx("option",{value:"8px",children:"Medium (8px)"}),r.jsx("option",{value:"12px",children:"Large (12px)"}),r.jsx("option",{value:"16px",children:"Extra Large (16px)"}),r.jsx("option",{value:"9999px",children:"Pill (Full)"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Border Width"}),r.jsxs("select",{value:x,onChange:H=>j(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",children:[r.jsx("option",{value:"0px",children:"None (0px)"}),r.jsx("option",{value:"1px",children:"Thin (1px)"}),r.jsx("option",{value:"2px",children:"Medium (2px)"}),r.jsx("option",{value:"3px",children:"Thick (3px)"}),r.jsx("option",{value:"4px",children:"Extra Thick (4px)"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Border Style"}),r.jsx("select",{value:O,onChange:H=>V(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",children:Lg.map(H=>r.jsx("option",{value:H.value,children:H.label},H.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Shadow Style"}),r.jsx("select",{value:E,onChange:H=>N(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",children:Dg.map(H=>r.jsx("option",{value:H.value,children:H.label},H.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:"Card Texture"}),r.jsx("select",{value:p,onChange:H=>M(H.target.value),className:"w-full p-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink rounded-theme font-body",children:Rg.map(H=>r.jsx("option",{value:H.value,children:H.label},H.value))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-bold text-theme-muted mb-1 font-body",children:["Texture Opacity: ",Math.round(A*100),"%"]}),r.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:A,onChange:H=>_(parseFloat(H.target.value)),className:"w-full h-2 bg-theme-border rounded-theme appearance-none cursor-pointer",disabled:p==="none"})]})]})]})]})]}),r.jsxs("div",{className:"p-3 border-t-[length:var(--border-width)] border-theme-border bg-theme-paper flex flex-wrap gap-2 justify-between flex-shrink-0",children:[r.jsx("div",{children:a&&o&&r.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this custom theme?")&&o()},className:"px-3 py-2 bg-red-500 text-white text-sm font-bold rounded-button hover:bg-red-600 transition-colors font-heading",children:" Delete"})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:n,className:"px-3 py-2 border-[length:var(--border-width)] border-theme-border bg-theme-paper text-theme-ink text-sm font-bold rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-heading",children:"Cancel"}),r.jsx("button",{onClick:$,className:"px-3 py-2 bg-theme-accent text-theme-paper text-sm font-bold rounded-button hover:bg-theme-accent-hover transition-colors font-heading",children:a?" Save Changes":" Create Theme"})]})]})]})})}function Ob({collapsed:e,onToggle:t}){const n=q(p=>p.activeCharacterId),o=q(p=>p.characters),a=q(p=>p.updateCharacterTheme),s=o.find(p=>p.id===n),i=(s==null?void 0:s.theme)||"default",c=s!=null&&s.theme?dr(s.theme):void 0,l=s!=null&&s.theme?Ms(s.theme):void 0,u=(c==null?void 0:c.cardTexture)||(l==null?void 0:l.cardTexture)||"none",h=Et(u),g=Br(p=>p.customThemes),f=Br(p=>p.addCustomTheme),w=Br(p=>p.updateCustomTheme),S=Br(p=>p.deleteCustomTheme),[y,v]=T.useState(!1),[m,d]=T.useState(void 0),b=p=>{if(n){a(n,p);const M=dr(p);M?Po(M):Fr(p)}},k=()=>{d(void 0),v(!0)},C=(p,M)=>{M.stopPropagation(),d(p),v(!0)},x=(p,M)=>{M.stopPropagation();const P={id:"",name:`${p.name} (Copy)`,icon:p.icon,description:p.description,colors:{...p.colors},fonts:{...p.fonts},borderRadius:p.borderRadius,buttonRadius:p.buttonRadius||p.borderRadius,borderWidth:p.borderWidth,shadowStyle:p.shadowStyle,cardTexture:p.cardTexture,textureColor:p.colors.paper,textureOpacity:p.textureOpacity??.15,borderStyle:p.borderStyle};d(P),v(!0)},j=p=>{m&&m.id?(w(p.id,p),i===p.id&&Po(p)):f(p),v(!1),d(void 0)},E=()=>{m&&(i===m.id&&n&&(a(n,"default"),Fr("default")),S(m.id)),v(!1),d(void 0)},N=()=>{const p=Nr.find(P=>P.id===i);if(p)return p.name;const M=g.find(P=>P.id===i);return M?M.name:"Unknown"};return r.jsxs(r.Fragment,{children:[y&&r.jsx(_b,{theme:m,onSave:j,onCancel:()=>{v(!1),d(void 0)},onDelete:m!=null&&m.id?E:void 0}),!e&&r.jsx("div",{className:"fixed inset-0 bg-black/30 z-40",onClick:t}),r.jsxs("div",{className:`fixed right-0 top-0 bottom-0 w-[80vw] max-w-[280px] bg-theme-paper border-l-[length:var(--border-width)] border-theme-border z-50 flex flex-col p-3 shadow-theme overflow-hidden transition-transform duration-300 ease-in-out safe-area-bottom touch-pan-y ${e?"translate-x-full":"translate-x-0"}`,children:[h&&r.jsx("div",{className:"absolute inset-0 pointer-events-none z-0",style:{backgroundColor:"var(--color-paper)"},children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url(${Jt[u]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:"var(--card-texture-opacity)",mixBlendMode:"overlay"}})}),r.jsx("button",{onClick:t,className:"absolute top-3 right-3 w-10 h-10 bg-theme-accent text-theme-paper font-bold flex items-center justify-center rounded-button z-20 shadow-theme",children:""}),r.jsxs("div",{className:"relative z-10 flex flex-col h-full overflow-y-auto touch-pan-y pt-12",children:[r.jsx("div",{className:"mb-4",children:r.jsx("h2",{className:"text-xl font-bold uppercase tracking-wider border-b-[length:var(--border-width)] border-theme-border pb-2 text-theme-ink font-heading",children:" Themes"})}),r.jsx("div",{className:"flex flex-col gap-2",children:Nr.map(p=>{const M=Et(p.cardTexture)?p.cardTexture:null,P=i===p.id;return r.jsxs("div",{style:{backgroundColor:P?p.colors.accent:p.colors.paper,color:P?p.colors.paper:p.colors.ink,borderColor:p.colors.border,borderRadius:p.borderRadius,borderWidth:p.borderWidth,fontFamily:p.fonts.body,boxShadow:`3px 3px 0 ${p.colors.shadow}`,position:"relative",overflow:"hidden"},className:"p-2 border-solid transition-all text-left font-bold",children:[M&&!P&&r.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundColor:p.colors.paper,borderRadius:p.borderRadius},children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url(${Jt[M]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:p.textureOpacity??.15,mixBlendMode:"overlay",borderRadius:p.borderRadius}})}),r.jsxs("button",{onClick:()=>b(p.id),className:"relative w-full text-left",children:[r.jsxs("div",{className:"flex items-center gap-2 pr-8",children:[r.jsx("span",{className:"text-base",children:p.icon}),r.jsx("span",{className:"text-xs",style:{fontFamily:p.fonts.heading},children:p.name})]}),r.jsx("p",{className:"text-[10px] mt-1 opacity-70",children:p.description}),r.jsxs("div",{className:"flex gap-1 mt-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full border border-black/20",style:{backgroundColor:p.colors.paper},title:"Paper"}),r.jsx("div",{className:"w-3 h-3 rounded-full border border-black/20",style:{backgroundColor:p.colors.ink},title:"Ink"}),r.jsx("div",{className:"w-3 h-3 rounded-full border border-black/20",style:{backgroundColor:p.colors.accent},title:"Accent"}),r.jsx("div",{className:"w-3 h-3 rounded-full border border-black/20",style:{backgroundColor:p.colors.background},title:"Background"})]})]}),r.jsx("button",{onClick:A=>x(p,A),style:{backgroundColor:P?`${p.colors.paper}33`:`${p.colors.accent}1a`,color:P?p.colors.paper:p.colors.accent},className:"absolute top-2 right-2 w-6 h-6 flex items-center justify-center rounded text-xs hover:scale-110 transition-transform z-10",title:"Copy to custom theme",children:""})]},p.id)})}),r.jsxs("div",{className:"mt-6 pt-4 border-t border-theme-border/50",children:[r.jsx("h3",{className:"text-sm font-bold text-theme-ink mb-3 uppercase tracking-wider font-heading",children:" Custom Themes"}),r.jsxs("button",{onClick:k,className:"w-full p-2 border-[length:var(--border-width)] border-dashed border-theme-border transition-all text-left font-bold bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper hover:border-solid mb-2",style:{borderRadius:"min(var(--button-radius), 16px)"},children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-base",children:""}),r.jsx("span",{className:"text-xs font-heading",children:"Create Custom Theme"})]}),r.jsx("p",{className:"text-[10px] mt-1 opacity-70 font-body",children:"Design your own unique theme"})]}),r.jsx("div",{className:"flex flex-col gap-2 mt-3",children:g.map(p=>{const M=Et(p.cardTexture||"")?p.cardTexture:null,P=i===p.id;return r.jsxs("div",{style:{backgroundColor:P?p.colors.accent:p.colors.paper,color:P?p.colors.paper:p.colors.ink,borderColor:p.colors.border,borderRadius:p.borderRadius,borderWidth:p.borderWidth,fontFamily:p.fonts.body,boxShadow:`3px 3px 0 ${p.colors.shadow}`,position:"relative",overflow:"hidden"},className:"p-2 border-solid transition-all text-left font-bold",children:[M&&!P&&r.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundColor:p.colors.paper,borderRadius:p.borderRadius},children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url(${Jt[M]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:p.textureOpacity??.15,mixBlendMode:"overlay",borderRadius:p.borderRadius}})}),r.jsxs("button",{onClick:()=>b(p.id),className:"relative w-full text-left",children:[r.jsxs("div",{className:"flex items-center gap-2 pr-8",children:[r.jsx("span",{className:"text-base",children:p.icon}),r.jsx("span",{className:"text-xs",style:{fontFamily:p.fonts.heading},children:p.name})]}),r.jsx("p",{className:"text-[10px] mt-1 opacity-70",children:p.description}),r.jsxs("div",{className:"flex gap-1 mt-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full border border-black/20",style:{backgroundColor:p.colors.paper},title:"Paper"}),r.jsx("div",{className:"w-3 h-3 rounded-full border border-black/20",style:{backgroundColor:p.colors.ink},title:"Ink"}),r.jsx("div",{className:"w-3 h-3 rounded-full border border-black/20",style:{backgroundColor:p.colors.accent},title:"Accent"}),r.jsx("div",{className:"w-3 h-3 rounded-full border border-black/20",style:{backgroundColor:p.colors.background},title:"Background"})]})]}),r.jsx("button",{onClick:A=>C(p,A),style:{backgroundColor:P?`${p.colors.paper}33`:`${p.colors.accent}1a`,color:P?p.colors.paper:p.colors.accent},className:"absolute top-2 right-2 w-6 h-6 flex items-center justify-center rounded text-xs hover:scale-110 transition-transform z-10",title:"Edit theme",children:""})]},p.id)})}),g.length===0&&r.jsx("p",{className:"text-[10px] text-theme-muted mt-2 font-body",children:"No custom themes yet. Create one above!"})]}),r.jsxs("div",{className:"mt-auto pt-4 text-[10px] text-theme-muted border-t border-theme-border/50 font-body",children:[r.jsx("p",{children:"Select a theme to change the appearance of your character sheet."}),r.jsxs("p",{className:"mt-2 text-theme-ink font-bold",children:["Current: ",N()]})]})]})]})]})}var Ps={exports:{}},af={},sf={exports:{}},Wb="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Fb=Wb,Bb=Fb;function lf(){}function cf(){}cf.resetWarningCache=lf;var zb=function(){function e(o,a,s,i,c,l){if(l!==Bb){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:cf,resetWarningCache:lf};return n.PropTypes=n,n};sf.exports=zb();var df=sf.exports,ci={exports:{}};function uf(e){var t,n,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=uf(e[t]))&&(o&&(o+=" "),o+=n)}else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}function qd(){for(var e,t,n=0,o="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=uf(e))&&(o&&(o+=" "),o+=t);return o}ci.exports=qd,ci.exports.clsx=qd;var Hb=ci.exports,Ve={},ur={};Object.defineProperty(ur,"__esModule",{value:!0});ur.dontSetMe=Xb;ur.findInArray=Ub;ur.int=Yb;ur.isFunction=Vb;ur.isNum=Gb;function Ub(e,t){for(let n=0,o=e.length;n<o;n++)if(t.apply(t,[e[n],n,e]))return e[n]}function Vb(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function Gb(e){return typeof e=="number"&&!isNaN(e)}function Yb(e){return parseInt(e,10)}function Xb(e,t,n){if(e[t])return new Error(`Invalid prop ${t} passed to ${n} - do not set this, set it on the child.`)}var wn={};Object.defineProperty(wn,"__esModule",{value:!0});wn.browserPrefixToKey=mf;wn.browserPrefixToStyle=Kb;wn.default=void 0;wn.getPrefix=hf;const ml=["Moz","Webkit","O","ms"];function hf(){var n,o;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const t=(o=(n=window.document)==null?void 0:n.documentElement)==null?void 0:o.style;if(!t||e in t)return"";for(let a=0;a<ml.length;a++)if(mf(e,ml[a])in t)return ml[a];return""}function mf(e,t){return t?`${t}${Qb(e)}`:e}function Kb(e,t){return t?`-${t.toLowerCase()}-${e}`:e}function Qb(e){let t="",n=!0;for(let o=0;o<e.length;o++)n?(t+=e[o].toUpperCase(),n=!1):e[o]==="-"?n=!0:t+=e[o];return t}wn.default=hf();Object.defineProperty(Ve,"__esModule",{value:!0});Ve.addClassName=xf;Ve.addEvent=qb;Ve.addUserSelectStyles=c0;Ve.createCSSTransform=a0;Ve.createSVGTransform=s0;Ve.getTouch=l0;Ve.getTouchIdentifier=i0;Ve.getTranslation=ic;Ve.innerHeight=r0;Ve.innerWidth=n0;Ve.matchesSelector=pf;Ve.matchesSelectorAndParentsTo=Jb;Ve.offsetXYFromParent=o0;Ve.outerHeight=e0;Ve.outerWidth=t0;Ve.removeClassName=gf;Ve.removeEvent=Zb;Ve.scheduleRemoveUserSelectStyles=d0;var Dt=ur,Zd=ff(wn);function ff(e,t){if(typeof WeakMap=="function")var n=new WeakMap,o=new WeakMap;return(ff=function(a,s){if(!s&&a&&a.__esModule)return a;var i,c,l={__proto__:null,default:a};if(a===null||typeof a!="object"&&typeof a!="function")return l;if(i=s?o:n){if(i.has(a))return i.get(a);i.set(a,l)}for(const u in a)u!=="default"&&{}.hasOwnProperty.call(a,u)&&((c=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,u))&&(c.get||c.set)?i(l,u,c):l[u]=a[u]);return l})(e,t)}let Ta="";function pf(e,t){return Ta||(Ta=(0,Dt.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,Dt.isFunction)(e[n])})),(0,Dt.isFunction)(e[Ta])?e[Ta](t):!1}function Jb(e,t,n){let o=e;do{if(pf(o,t))return!0;if(o===n)return!1;o=o.parentNode}while(o);return!1}function qb(e,t,n,o){if(!e)return;const a={capture:!0,...o};e.addEventListener?e.addEventListener(t,n,a):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function Zb(e,t,n,o){if(!e)return;const a={capture:!0,...o};e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}function e0(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,Dt.int)(n.borderTopWidth),t+=(0,Dt.int)(n.borderBottomWidth),t}function t0(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,Dt.int)(n.borderLeftWidth),t+=(0,Dt.int)(n.borderRightWidth),t}function r0(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,Dt.int)(n.paddingTop),t-=(0,Dt.int)(n.paddingBottom),t}function n0(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,Dt.int)(n.paddingLeft),t-=(0,Dt.int)(n.paddingRight),t}function o0(e,t,n){const a=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect(),s=(e.clientX+t.scrollLeft-a.left)/n,i=(e.clientY+t.scrollTop-a.top)/n;return{x:s,y:i}}function a0(e,t){const n=ic(e,t,"px");return{[(0,Zd.browserPrefixToKey)("transform",Zd.default)]:n}}function s0(e,t){return ic(e,t,"")}function ic(e,t,n){let{x:o,y:a}=e,s=`translate(${o}${n},${a}${n})`;if(t){const i=`${typeof t.x=="string"?t.x:t.x+n}`,c=`${typeof t.y=="string"?t.y:t.y+n}`;s=`translate(${i}, ${c})`+s}return s}function l0(e,t){return e.targetTouches&&(0,Dt.findInArray)(e.targetTouches,n=>t===n.identifier)||e.changedTouches&&(0,Dt.findInArray)(e.changedTouches,n=>t===n.identifier)}function i0(e){if(e.targetTouches&&e.targetTouches[0])return e.targetTouches[0].identifier;if(e.changedTouches&&e.changedTouches[0])return e.changedTouches[0].identifier}function c0(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,t.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,e.getElementsByTagName("head")[0].appendChild(t)),e.body&&xf(e.body,"react-draggable-transparent-selection")}function d0(e){window.requestAnimationFrame?window.requestAnimationFrame(()=>{eu(e)}):eu(e)}function eu(e){if(e)try{if(e.body&&gf(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{const t=(e.defaultView||window).getSelection();t&&t.type!=="Caret"&&t.removeAllRanges()}}catch{}}function xf(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp(`(?:^|\\s)${t}(?!\\S)`))||(e.className+=` ${t}`)}function gf(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(`(?:^|\\s)${t}(?!\\S)`,"g"),"")}var hr={};Object.defineProperty(hr,"__esModule",{value:!0});hr.canDragX=m0;hr.canDragY=f0;hr.createCoreData=x0;hr.createDraggableData=g0;hr.getBoundPosition=u0;hr.getControlPosition=p0;hr.snapToGrid=h0;var It=ur,Fn=Ve;function u0(e,t,n){if(!e.props.bounds)return[t,n];let{bounds:o}=e.props;o=typeof o=="string"?o:b0(o);const a=cc(e);if(typeof o=="string"){const{ownerDocument:s}=a,i=s.defaultView;let c;if(o==="parent"?c=a.parentNode:c=a.getRootNode().querySelector(o),!(c instanceof i.HTMLElement))throw new Error('Bounds selector "'+o+'" could not find an element.');const l=c,u=i.getComputedStyle(a),h=i.getComputedStyle(l);o={left:-a.offsetLeft+(0,It.int)(h.paddingLeft)+(0,It.int)(u.marginLeft),top:-a.offsetTop+(0,It.int)(h.paddingTop)+(0,It.int)(u.marginTop),right:(0,Fn.innerWidth)(l)-(0,Fn.outerWidth)(a)-a.offsetLeft+(0,It.int)(h.paddingRight)-(0,It.int)(u.marginRight),bottom:(0,Fn.innerHeight)(l)-(0,Fn.outerHeight)(a)-a.offsetTop+(0,It.int)(h.paddingBottom)-(0,It.int)(u.marginBottom)}}return(0,It.isNum)(o.right)&&(t=Math.min(t,o.right)),(0,It.isNum)(o.bottom)&&(n=Math.min(n,o.bottom)),(0,It.isNum)(o.left)&&(t=Math.max(t,o.left)),(0,It.isNum)(o.top)&&(n=Math.max(n,o.top)),[t,n]}function h0(e,t,n){const o=Math.round(t/e[0])*e[0],a=Math.round(n/e[1])*e[1];return[o,a]}function m0(e){return e.props.axis==="both"||e.props.axis==="x"}function f0(e){return e.props.axis==="both"||e.props.axis==="y"}function p0(e,t,n){const o=typeof t=="number"?(0,Fn.getTouch)(e,t):null;if(typeof t=="number"&&!o)return null;const a=cc(n),s=n.props.offsetParent||a.offsetParent||a.ownerDocument.body;return(0,Fn.offsetXYFromParent)(o||e,s,n.props.scale)}function x0(e,t,n){const o=!(0,It.isNum)(e.lastX),a=cc(e);return o?{node:a,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:a,deltaX:t-e.lastX,deltaY:n-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:n}}function g0(e,t){const n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}}function b0(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function cc(e){const t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}var Rs={},Ds={};Object.defineProperty(Ds,"__esModule",{value:!0});Ds.default=v0;function v0(){}Object.defineProperty(Rs,"__esModule",{value:!0});Rs.default=void 0;var fl=bf(T),pt=dc(df),y0=dc(er),ut=Ve,Pr=hr,pl=ur,xo=dc(Ds);function dc(e){return e&&e.__esModule?e:{default:e}}function bf(e,t){if(typeof WeakMap=="function")var n=new WeakMap,o=new WeakMap;return(bf=function(a,s){if(!s&&a&&a.__esModule)return a;var i,c,l={__proto__:null,default:a};if(a===null||typeof a!="object"&&typeof a!="function")return l;if(i=s?o:n){if(i.has(a))return i.get(a);i.set(a,l)}for(const u in a)u!=="default"&&{}.hasOwnProperty.call(a,u)&&((c=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,u))&&(c.get||c.set)?i(l,u,c):l[u]=a[u]);return l})(e,t)}function xt(e,t,n){return(t=w0(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w0(e){var t=k0(e,"string");return typeof t=="symbol"?t:t+""}function k0(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const Vt={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let Rr=Vt.mouse,Ls=class extends fl.Component{constructor(){super(...arguments),xt(this,"dragging",!1),xt(this,"lastX",NaN),xt(this,"lastY",NaN),xt(this,"touchIdentifier",null),xt(this,"mounted",!1),xt(this,"handleDragStart",t=>{if(this.props.onMouseDown(t),!this.props.allowAnyClick&&typeof t.button=="number"&&t.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:o}=n;if(this.props.disabled||!(t.target instanceof o.defaultView.Node)||this.props.handle&&!(0,ut.matchesSelectorAndParentsTo)(t.target,this.props.handle,n)||this.props.cancel&&(0,ut.matchesSelectorAndParentsTo)(t.target,this.props.cancel,n))return;t.type==="touchstart"&&!this.props.allowMobileScroll&&t.preventDefault();const a=(0,ut.getTouchIdentifier)(t);this.touchIdentifier=a;const s=(0,Pr.getControlPosition)(t,a,this);if(s==null)return;const{x:i,y:c}=s,l=(0,Pr.createCoreData)(this,i,c);(0,xo.default)("DraggableCore: handleDragStart: %j",l),(0,xo.default)("calling",this.props.onStart),!(this.props.onStart(t,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,ut.addUserSelectStyles)(o),this.dragging=!0,this.lastX=i,this.lastY=c,(0,ut.addEvent)(o,Rr.move,this.handleDrag),(0,ut.addEvent)(o,Rr.stop,this.handleDragStop))}),xt(this,"handleDrag",t=>{const n=(0,Pr.getControlPosition)(t,this.touchIdentifier,this);if(n==null)return;let{x:o,y:a}=n;if(Array.isArray(this.props.grid)){let c=o-this.lastX,l=a-this.lastY;if([c,l]=(0,Pr.snapToGrid)(this.props.grid,c,l),!c&&!l)return;o=this.lastX+c,a=this.lastY+l}const s=(0,Pr.createCoreData)(this,o,a);if((0,xo.default)("DraggableCore: handleDrag: %j",s),this.props.onDrag(t,s)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.lastX=o,this.lastY=a}),xt(this,"handleDragStop",t=>{if(!this.dragging)return;const n=(0,Pr.getControlPosition)(t,this.touchIdentifier,this);if(n==null)return;let{x:o,y:a}=n;if(Array.isArray(this.props.grid)){let l=o-this.lastX||0,u=a-this.lastY||0;[l,u]=(0,Pr.snapToGrid)(this.props.grid,l,u),o=this.lastX+l,a=this.lastY+u}const s=(0,Pr.createCoreData)(this,o,a);if(this.props.onStop(t,s)===!1||this.mounted===!1)return!1;const c=this.findDOMNode();c&&this.props.enableUserSelectHack&&(0,ut.scheduleRemoveUserSelectStyles)(c.ownerDocument),(0,xo.default)("DraggableCore: handleDragStop: %j",s),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,c&&((0,xo.default)("DraggableCore: Removing handlers"),(0,ut.removeEvent)(c.ownerDocument,Rr.move,this.handleDrag),(0,ut.removeEvent)(c.ownerDocument,Rr.stop,this.handleDragStop))}),xt(this,"onMouseDown",t=>(Rr=Vt.mouse,this.handleDragStart(t))),xt(this,"onMouseUp",t=>(Rr=Vt.mouse,this.handleDragStop(t))),xt(this,"onTouchStart",t=>(Rr=Vt.touch,this.handleDragStart(t))),xt(this,"onTouchEnd",t=>(Rr=Vt.touch,this.handleDragStop(t)))}componentDidMount(){this.mounted=!0;const t=this.findDOMNode();t&&(0,ut.addEvent)(t,Vt.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const t=this.findDOMNode();if(t){const{ownerDocument:n}=t;(0,ut.removeEvent)(n,Vt.mouse.move,this.handleDrag),(0,ut.removeEvent)(n,Vt.touch.move,this.handleDrag),(0,ut.removeEvent)(n,Vt.mouse.stop,this.handleDragStop),(0,ut.removeEvent)(n,Vt.touch.stop,this.handleDragStop),(0,ut.removeEvent)(t,Vt.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,ut.scheduleRemoveUserSelectStyles)(n)}}findDOMNode(){var t,n,o;return(t=this.props)!=null&&t.nodeRef?(o=(n=this.props)==null?void 0:n.nodeRef)==null?void 0:o.current:y0.default.findDOMNode(this)}render(){return fl.cloneElement(fl.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};Rs.default=Ls;xt(Ls,"displayName","DraggableCore");xt(Ls,"propTypes",{allowAnyClick:pt.default.bool,allowMobileScroll:pt.default.bool,children:pt.default.node.isRequired,disabled:pt.default.bool,enableUserSelectHack:pt.default.bool,offsetParent:function(e,t){if(e[t]&&e[t].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:pt.default.arrayOf(pt.default.number),handle:pt.default.string,cancel:pt.default.string,nodeRef:pt.default.object,onStart:pt.default.func,onDrag:pt.default.func,onStop:pt.default.func,onMouseDown:pt.default.func,scale:pt.default.number,className:pl.dontSetMe,style:pl.dontSetMe,transform:pl.dontSetMe});xt(Ls,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DraggableCore",{enumerable:!0,get:function(){return l.default}}),e.default=void 0;var t=g(T),n=h(df),o=h(er),a=Hb,s=Ve,i=hr,c=ur,l=h(Rs),u=h(Ds);function h(m){return m&&m.__esModule?m:{default:m}}function g(m,d){if(typeof WeakMap=="function")var b=new WeakMap,k=new WeakMap;return(g=function(C,x){if(!x&&C&&C.__esModule)return C;var j,E,N={__proto__:null,default:C};if(C===null||typeof C!="object"&&typeof C!="function")return N;if(j=x?k:b){if(j.has(C))return j.get(C);j.set(C,N)}for(const p in C)p!=="default"&&{}.hasOwnProperty.call(C,p)&&((E=(j=Object.defineProperty)&&Object.getOwnPropertyDescriptor(C,p))&&(E.get||E.set)?j(N,p,E):N[p]=C[p]);return N})(m,d)}function f(){return f=Object.assign?Object.assign.bind():function(m){for(var d=1;d<arguments.length;d++){var b=arguments[d];for(var k in b)({}).hasOwnProperty.call(b,k)&&(m[k]=b[k])}return m},f.apply(null,arguments)}function w(m,d,b){return(d=S(d))in m?Object.defineProperty(m,d,{value:b,enumerable:!0,configurable:!0,writable:!0}):m[d]=b,m}function S(m){var d=y(m,"string");return typeof d=="symbol"?d:d+""}function y(m,d){if(typeof m!="object"||!m)return m;var b=m[Symbol.toPrimitive];if(b!==void 0){var k=b.call(m,d);if(typeof k!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(m)}class v extends t.Component{static getDerivedStateFromProps(d,b){let{position:k}=d,{prevPropsPosition:C}=b;return k&&(!C||k.x!==C.x||k.y!==C.y)?((0,u.default)("Draggable: getDerivedStateFromProps %j",{position:k,prevPropsPosition:C}),{x:k.x,y:k.y,prevPropsPosition:{...k}}):null}constructor(d){super(d),w(this,"onDragStart",(b,k)=>{if((0,u.default)("Draggable: onDragStart: %j",k),this.props.onStart(b,(0,i.createDraggableData)(this,k))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),w(this,"onDrag",(b,k)=>{if(!this.state.dragging)return!1;(0,u.default)("Draggable: onDrag: %j",k);const C=(0,i.createDraggableData)(this,k),x={x:C.x,y:C.y,slackX:0,slackY:0};if(this.props.bounds){const{x:E,y:N}=x;x.x+=this.state.slackX,x.y+=this.state.slackY;const[p,M]=(0,i.getBoundPosition)(this,x.x,x.y);x.x=p,x.y=M,x.slackX=this.state.slackX+(E-x.x),x.slackY=this.state.slackY+(N-x.y),C.x=x.x,C.y=x.y,C.deltaX=x.x-this.state.x,C.deltaY=x.y-this.state.y}if(this.props.onDrag(b,C)===!1)return!1;this.setState(x)}),w(this,"onDragStop",(b,k)=>{if(!this.state.dragging||this.props.onStop(b,(0,i.createDraggableData)(this,k))===!1)return!1;(0,u.default)("Draggable: onDragStop: %j",k);const x={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:E,y:N}=this.props.position;x.x=E,x.y=N}this.setState(x)}),this.state={dragging:!1,dragged:!1,x:d.position?d.position.x:d.defaultPosition.x,y:d.position?d.position.y:d.defaultPosition.y,prevPropsPosition:{...d.position},slackX:0,slackY:0,isElementSVG:!1},d.position&&!(d.onDrag||d.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){var d,b;return((b=(d=this.props)==null?void 0:d.nodeRef)==null?void 0:b.current)??o.default.findDOMNode(this)}render(){const{axis:d,bounds:b,children:k,defaultPosition:C,defaultClassName:x,defaultClassNameDragging:j,defaultClassNameDragged:E,position:N,positionOffset:p,scale:M,...P}=this.props;let A={},_=null;const V=!!!N||this.state.dragging,z=N||C,I={x:(0,i.canDragX)(this)&&V?this.state.x:z.x,y:(0,i.canDragY)(this)&&V?this.state.y:z.y};this.state.isElementSVG?_=(0,s.createSVGTransform)(I,p):A=(0,s.createCSSTransform)(I,p);const L=(0,a.clsx)(k.props.className||"",x,{[j]:this.state.dragging,[E]:this.state.dragged});return t.createElement(l.default,f({},P,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),t.cloneElement(t.Children.only(k),{className:L,style:{...k.props.style,...A},transform:_}))}}e.default=v,w(v,"displayName","Draggable"),w(v,"propTypes",{...l.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:c.dontSetMe,style:c.dontSetMe,transform:c.dontSetMe}),w(v,"defaultProps",{...l.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(af);const{default:vf,DraggableCore:j0}=af;Ps.exports=vf;Ps.exports.default=vf;Ps.exports.DraggableCore=j0;var N0=Ps.exports;const S0=ui(N0);function uc({widget:e,mode:t,height:n}){const o=q(P=>P.updateWidgetData),a=t==="print",{label:s,numberItems:i=[],printSettings:c}=e.data,l=a&&((c==null?void 0:c.hideValues)??!1),[u,h]=T.useState(null),[g,f]=T.useState(""),w="text-xs",S="text-xs",y="w-5 h-5 text-xs",v="text-sm min-w-8 px-1",m="gap-1",C=Math.max(30,n-16-4-0*2),x=(P,A)=>{const _=[...i];_[P]={..._[P],value:_[P].value+A},o(e.id,{numberItems:_})},j=(P,A)=>{h(P),f(String(A))},E=P=>{f(P.target.value)},N=P=>{const A=parseInt(g,10);if(!isNaN(A)){const _=[...i];_[P]={..._[P],value:A},o(e.id,{numberItems:_})}h(null),f("")},p=(P,A)=>{P.key==="Enter"?N(A):P.key==="Escape"&&(h(null),f(""))},M="";return r.jsxs("div",{className:`flex flex-col ${m} w-full h-full`,children:[s&&r.jsx("div",{className:`font-bold ${w} text-theme-ink font-heading flex-shrink-0`,children:s}),r.jsxs("div",{className:"flex flex-col gap-0.5 overflow-y-auto overflow-x-hidden flex-1 pr-4",style:{maxHeight:`${C}px`},onWheel:P=>{const A=P.currentTarget;A.scrollHeight>A.clientHeight&&P.stopPropagation()},children:[i.map((P,A)=>r.jsxs("div",{className:`flex items-center ${m}`,children:[r.jsx("span",{className:`flex-1 ${S} text-theme-ink font-body truncate`,children:P.name}),r.jsxs("div",{className:`flex items-center justify-center gap-0.5 flex-shrink-0 ${M}`,children:[r.jsx("button",{onClick:()=>x(A,-1),onMouseDown:_=>_.stopPropagation(),className:`${y} border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center justify-center text-theme-ink rounded-button flex-shrink-0 font-body ${a?"opacity-0":""}`,children:"-"}),u===A?r.jsx("input",{type:"text",inputMode:"numeric",value:g,onChange:E,onBlur:()=>N(A),onKeyDown:_=>p(_,A),onMouseDown:_=>_.stopPropagation(),autoFocus:!0,className:`${v} text-center font-bold text-theme-ink bg-theme-paper border border-theme-border rounded-button flex-shrink-0 outline-none focus:border-theme-accent`}):r.jsx("span",{className:`${v} text-center font-bold text-theme-ink flex-shrink-0 cursor-pointer hover:bg-theme-accent/20 rounded-button font-body whitespace-nowrap`,style:l?{visibility:"hidden"}:void 0,"data-print-hide":l?"true":void 0,onClick:()=>j(A,P.value),onMouseDown:_=>_.stopPropagation(),children:P.value}),r.jsx("button",{onClick:()=>x(A,1),onMouseDown:_=>_.stopPropagation(),className:`${y} border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center justify-center text-theme-ink rounded-button flex-shrink-0 font-body ${a?"opacity-0":""}`,children:"+"})]})]},A)),i.length===0&&r.jsx("div",{className:`${S} text-theme-muted italic`,children:"No items yet"})]})]})}function hc({widget:e,mode:t,width:n,height:o}){const a=q(E=>E.updateWidgetData),s=t==="print",{label:i,displayNumbers:c=[],displayLayout:l="horizontal",printSettings:u}=e.data,h=s&&((u==null?void 0:u.hideValues)??!1),[g,f]=T.useState(null),[w,S]=T.useState(""),y=(E,N)=>{f(E),S(String(N))},v=E=>{S(E.target.value)},m=E=>{const N=parseInt(w,10);if(!isNaN(N)){const p=[...c];p[E]={...p[E],value:N},a(e.id,{displayNumbers:p})}f(null),S("")},d=(E,N)=>{E.key==="Enter"?m(N):E.key==="Escape"&&(f(null),S(""))},b=l==="horizontal",k=c.length||1,C=Math.min(n/(b?k:1),o/(b?1:k)),x=Math.max(10,Math.min(20,C*.25)),j=Math.max(7,Math.min(10,C*.12));return r.jsxs("div",{className:"w-full h-full flex flex-col overflow-hidden",children:[i&&r.jsx("div",{className:"font-bold text-theme-ink font-heading shrink-0 truncate px-1",style:{fontSize:"11px",lineHeight:"16px"},children:i}),r.jsxs("div",{className:`flex-1 flex ${b?"flex-row":"flex-col"} items-stretch justify-center gap-1 p-1 min-h-0 min-w-0 overflow-hidden`,children:[c.map((E,N)=>r.jsxs("div",{className:`flex flex-col items-center justify-center border-2 border-theme-border rounded-button bg-theme-paper/50 overflow-hidden ${b?"flex-1 max-w-[70px]":"flex-1 max-h-[55px]"}`,style:{minWidth:b?"30px":void 0,minHeight:b?void 0:"30px"},children:[g===N?r.jsx("input",{type:"text",inputMode:"numeric",value:w,onChange:v,onBlur:()=>m(N),onKeyDown:p=>d(p,N),onMouseDown:p=>p.stopPropagation(),autoFocus:!0,className:"text-center font-bold text-theme-ink bg-transparent border-none outline-none w-full",style:{fontSize:`${x}px`}}):r.jsx("span",{className:"font-bold text-theme-ink cursor-pointer hover:text-theme-accent transition-colors leading-none font-body",style:{fontSize:`${x}px`,...h?{visibility:"hidden"}:{}},"data-print-hide":h?"true":void 0,onClick:()=>y(N,E.value),onMouseDown:p=>p.stopPropagation(),children:E.value}),r.jsx("span",{className:"text-theme-muted font-body truncate w-full text-center px-1 leading-tight",style:{fontSize:`${j}px`},children:E.label})]},N)),c.length===0&&r.jsx("div",{className:"text-xs text-theme-muted italic",children:"No numbers configured"})]})]})}function mc({widget:e,mode:t,height:n}){const o=q(m=>m.updateWidgetData),{label:a,items:s=[],itemCount:i=5}=e.data,c="text-xs",l="text-xs py-0.5",u="gap-1",w=Math.max(40,n-16-4-0*2),S=Array.from({length:i},(m,d)=>s[d]||""),y=(m,d)=>{const b=[...S];b[m]=d,o(e.id,{items:b})},v=m=>{const d=[...S];d[m]="",o(e.id,{items:d})};return r.jsxs("div",{className:`flex flex-col ${u} w-full h-full`,children:[a&&r.jsx("div",{className:`font-bold ${c} text-theme-ink font-heading flex-shrink-0`,children:a}),r.jsx("div",{className:"space-y-1 overflow-y-auto flex-1",style:{maxHeight:`${w}px`},onWheel:m=>{const d=m.currentTarget;d.scrollHeight>d.clientHeight&&m.stopPropagation()},children:S.map((m,d)=>r.jsxs("div",{className:"flex items-center gap-1 group",children:[r.jsx("span",{className:"text-theme-ink",children:""}),r.jsx("input",{className:`flex-1 border-b border-theme-border focus:border-theme-accent focus:outline-none ${l} min-w-0 bg-transparent text-theme-ink font-body`,value:m,onChange:b=>y(d,b.target.value),placeholder:t==="print"?"":"...",onMouseDown:b=>b.stopPropagation()}),r.jsx("button",{onClick:()=>v(d),className:"opacity-0 group-hover:opacity-100 text-theme-muted hover:text-theme-ink px-1 flex-shrink-0",onMouseDown:b=>b.stopPropagation(),children:""})]},d))})]})}function fc({widget:e,height:t}){const n=q(d=>d.updateWidgetData),a=q(d=>d.mode)==="print",{label:s,text:i=""}=e.data,c=T.useRef(null),l=T.useCallback(d=>{const b=d.currentTarget;b.scrollHeight>b.clientHeight&&d.stopPropagation()},[]),u="text-xs",h="text-xs p-1",g="gap-1",f=t>=1e4,v=Math.max(32,t-16-4-0*2);T.useEffect(()=>{f&&c.current&&(c.current.style.height="auto",c.current.style.height=`${Math.max(60,c.current.scrollHeight)}px`)},[i,f]);const m=d=>{n(e.id,{text:d.target.value}),f&&c.current&&(c.current.style.height="auto",c.current.style.height=`${Math.max(60,c.current.scrollHeight)}px`)};return r.jsxs("div",{className:`flex flex-col ${g} w-full ${f?"":"h-full"}`,children:[s&&r.jsx("div",{className:`font-bold ${u} text-theme-ink font-heading flex-shrink-0`,children:s}),r.jsx("textarea",{ref:c,className:`w-full ${f?"":"flex-1"} ${h} border border-theme-border focus:border-theme-border focus:outline-none resize-none bg-transparent text-theme-ink font-body rounded-theme`,style:f?{minHeight:"60px",overflow:"hidden",height:"auto"}:{height:`${v}px`},value:i,onChange:m,placeholder:a?"":"Enter text here...",onMouseDown:d=>d.stopPropagation(),onWheel:l})]})}function pc({widget:e,height:t}){const n=q(m=>m.updateWidgetData),{label:o,checkboxItems:a=[],checklistSettings:s}=e.data,i=(s==null?void 0:s.strikethrough)!==!1,c="text-xs",l="text-xs",u="w-4 h-4",h="text-xs",g="gap-1",y=Math.max(30,t-16-4-0*2),v=m=>{const d=[...a];d[m]={...d[m],checked:!d[m].checked},n(e.id,{checkboxItems:d})};return r.jsxs("div",{className:`flex flex-col ${g} w-full h-full`,children:[o&&r.jsx("div",{className:`font-bold ${c} text-theme-ink font-heading flex-shrink-0`,children:o}),r.jsxs("div",{className:"flex flex-col gap-0.5 overflow-y-auto flex-1",style:{maxHeight:`${y}px`},onWheel:m=>{const d=m.currentTarget;d.scrollHeight>d.clientHeight&&m.stopPropagation()},children:[a.map((m,d)=>r.jsxs("div",{className:`flex items-center ${g} cursor-pointer`,onClick:()=>v(d),onMouseDown:b=>b.stopPropagation(),children:[r.jsx("div",{className:`${u} border border-theme-border flex items-center justify-center transition-colors flex-shrink-0 rounded-button ${m.checked?"bg-theme-accent text-theme-paper":"bg-theme-paper hover:opacity-80"}`,children:m.checked&&r.jsx("span",{className:h,children:""})}),r.jsx("span",{className:`flex-1 ${l} font-body text-theme-ink ${m.checked&&i?"line-through text-theme-muted":""}`,children:m.name})]},d)),a.length===0&&r.jsx("div",{className:`${l} text-theme-muted italic`,children:"No items yet"})]})]})}function tu({title:e,onConfirm:t,onCancel:n,buttonLabel:o,isDamage:a}){const[s,i]=T.useState(""),c=()=>{if(s===""||s<=0){n();return}t(s)},l=()=>i(h=>h===""?1:h+1),u=()=>i(h=>h===""||h<=1?"":h-1);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999]",onClick:n}),r.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-button p-4 z-[9999] min-w-[200px]",onKeyDown:h=>{h.key==="Enter"&&c(),h.key==="Escape"&&n()},children:[r.jsx("h3",{className:"font-heading text-theme-ink font-bold mb-3",children:e}),r.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:[r.jsx("button",{onClick:u,onMouseDown:h=>h.stopPropagation(),className:"w-10 h-10 flex items-center justify-center border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors text-theme-ink rounded-button font-bold text-xl font-body",children:""}),r.jsx("input",{type:"number",min:"1",className:"w-16 h-10 text-center font-bold text-2xl text-theme-ink bg-theme-paper border border-theme-border rounded-button focus:outline-none focus:border-theme-accent [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",value:s,onChange:h=>i(h.target.value===""?"":Math.max(0,parseInt(h.target.value)||0)),onClick:h=>h.target.focus(),onMouseDown:h=>h.stopPropagation(),autoFocus:!0}),r.jsx("button",{onClick:l,onMouseDown:h=>h.stopPropagation(),className:"w-10 h-10 flex items-center justify-center border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors text-theme-ink rounded-button font-bold text-xl font-body",children:"+"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:n,className:"flex-1 px-3 py-1.5 text-sm font-body text-theme-ink hover:bg-theme-accent/20 rounded-button transition-colors border border-theme-border",children:"Cancel"}),r.jsx("button",{onClick:c,className:"flex-1 px-3 py-1.5 text-sm font-body rounded-button transition-colors bg-theme-accent text-theme-paper hover:opacity-80",children:o})]})]})]})}function xc({widget:e,mode:t}){const n=q(C=>C.updateWidgetData),o=t==="print",{label:a,currentValue:s=10,maxValue:i=10,increment:c=1}=e.data,[l,u]=T.useState(!1),[h,g]=T.useState(!1),f=Math.max(0,Math.min(100,s/i*100)),w="text-xs",S="text-xs",y="px-1.5 py-0.5 text-[10px]",v="gap-1",m="h-4",d=C=>{const x=s-C;n(e.id,{currentValue:x}),u(!1)},b=C=>{const x=Math.min(i,s+C);n(e.id,{currentValue:x}),g(!1)},k=()=>{n(e.id,{currentValue:i})};return r.jsxs("div",{className:`flex flex-col ${v} w-full h-full justify-between`,children:[a&&r.jsx("div",{className:`font-bold ${w} text-theme-ink font-heading flex-shrink-0`,children:a}),r.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[r.jsx("button",{onClick:()=>n(e.id,{currentValue:s-c}),onMouseDown:C=>C.stopPropagation(),className:`w-5 h-5 flex items-center justify-center border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors text-theme-ink rounded-button font-bold text-xs flex-shrink-0 font-body ${o?"opacity-0":""}`,children:""}),r.jsxs("div",{className:`relative ${m} flex-1 bg-theme-muted/30 rounded-button overflow-hidden border border-theme-border`,children:[r.jsx("div",{className:"absolute inset-y-0 left-0 bg-theme-accent transition-all duration-300 ease-out",style:{width:o?"0%":`${f}%`}}),r.jsx("div",{className:`absolute inset-0 flex items-center justify-center font-bold ${S} text-theme-ink font-body`,style:o?{}:{textShadow:"0 0 3px var(--color-paper), 0 0 3px var(--color-paper), 0 0 3px var(--color-paper)"},children:o?r.jsxs(r.Fragment,{children:[r.jsx("span",{style:{visibility:"hidden"},"data-print-hide":"true",children:i}),` / ${i}`]}):`${s} / ${i}`})]}),r.jsx("button",{onClick:()=>n(e.id,{currentValue:Math.min(i,s+c)}),onMouseDown:C=>C.stopPropagation(),className:`w-5 h-5 flex items-center justify-center border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors text-theme-ink rounded-button font-bold text-xs flex-shrink-0 font-body ${o?"opacity-0":""}`,children:"+"})]}),r.jsxs("div",{className:`flex items-center justify-between gap-1 flex-shrink-0 ${o?"opacity-0":""}`,children:[r.jsx("button",{onClick:()=>u(!0),onMouseDown:C=>C.stopPropagation(),className:`${y} border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors text-theme-ink rounded-button font-bold font-body`,children:"Damage"}),r.jsx("button",{onClick:()=>g(!0),onMouseDown:C=>C.stopPropagation(),className:`${y} border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors text-theme-ink rounded-button font-bold font-body`,children:"Heal"}),r.jsx("button",{onClick:k,onMouseDown:C=>C.stopPropagation(),className:`${y} border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors text-theme-ink rounded-button font-bold font-body`,children:"Full"})]}),l&&er.createPortal(r.jsx(tu,{title:"Take Damage",onConfirm:d,onCancel:()=>u(!1),buttonLabel:"Damage",isDamage:!0}),document.body),h&&er.createPortal(r.jsx(tu,{title:"Heal",onConfirm:b,onCancel:()=>g(!1),buttonLabel:"Heal",isDamage:!1}),document.body)]})}function gc({widget:e}){const{label:t,diceGroups:n=[{count:1,faces:20}],modifier:o=0,showIndividualResults:a=!1}=e.data,[s,i]=T.useState(null),[c,l]=T.useState(!1),u=j=>typeof j=="number"?!0:!isNaN(Number(j))&&j.trim()!=="",h=j=>{if(typeof Intl<"u"&&"Segmenter"in Intl){const E=Intl.Segmenter,N=new E("en",{granularity:"grapheme"});return Array.from(N.segment(j),p=>p.segment)}return[...j]},g=j=>{const E=h(j);if(E.length<=1)return[j];const N=E[0];return E.every(M=>M===N)?E:[j]},f=j=>{if(typeof j=="number")return[j];const E=[],N=j.split(",").map(p=>p.trim()).filter(p=>p.length>0);for(const p of N)if(u(p))E.push(p);else{const M=g(p);E.push(...M)}return E},w=j=>{const E=[],N=new Map;for(const P of j){const A=f(P);for(const _ of A)if(u(_))E.push(typeof _=="number"?_:Number(_));else{const O=String(_);N.set(O,(N.get(O)||0)+1)}}const p=[];if(E.length>0){const P=E.reduce((A,_)=>A+_,0);p.push({value:String(P),count:E.length,isNumeric:!0,numericTotal:P})}const M=Array.from(N.entries()).sort((P,A)=>A[1]-P[1]);for(const[P,A]of M)p.push({value:P,count:A,isNumeric:!1});return p},S="text-xs",y="py-1 px-2 text-xs",v="text-xl",m="text-[10px]",d="gap-1",b=()=>{l(!0),setTimeout(()=>{const j=[],E=[];for(const P of n){const A=[];if(P.customFaces&&P.customFaces.length>0){for(let _=0;_<P.count;_++){const O=Math.floor(Math.random()*P.customFaces.length),V=P.customFaces[O];A.push(V),E.push(V)}j.push({faces:P.customFaces.length,rolls:A,customFaces:P.customFaces})}else{for(let _=0;_<P.count;_++){const O=Math.floor(Math.random()*P.faces)+1;A.push(O),E.push(O)}j.push({faces:P.faces,rolls:A})}}const N=w(E),p=N.find(P=>P.isNumeric),M=p?(p.numericTotal||0)+o:null;i({groups:j,modifier:o,total:M,aggregatedResults:N}),l(!1)},300)},C=(()=>{let E=n.map(N=>{if(N.customFaces&&N.customFaces.length>0){const p=N.customDiceName||"custom";return N.count>1?`${N.count} ${p}`:p}return`${N.count}d${N.faces}`}).join(" + ");return o!==0&&(E+=o>=0?` + ${o}`:` - ${Math.abs(o)}`),E})(),x=()=>{if(!s)return"";if(a){const E=[];for(const N of s.groups)for(const p of N.rolls)E.push(String(p));return s.modifier!==0&&E.push(s.modifier>=0?`+${s.modifier}`:String(s.modifier)),E.join(", ")}const j=[];for(const E of s.aggregatedResults)if(E.isNumeric){const N=(E.numericTotal||0)+(s.modifier||0);j.push(String(N))}else j.push(`${E.count}${E.value}`);return j.join(" | ")};return r.jsxs("div",{className:`flex flex-col ${d} w-full h-full`,children:[t&&r.jsx("div",{className:`font-bold text-center ${S} text-theme-ink font-heading flex-shrink-0`,children:t}),r.jsxs("button",{onClick:b,onMouseDown:j=>j.stopPropagation(),className:`${y} border border-theme-border font-bold transition-all rounded-button flex-shrink-0 font-body ${c?"bg-theme-muted animate-pulse text-theme-paper":"bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,disabled:c,children:["Roll ",C]}),r.jsx("div",{className:"text-center flex-1 flex flex-col justify-center",children:s&&!c?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`${v} font-bold text-theme-ink font-heading`,children:x()||""}),!a&&r.jsxs("div",{className:`${m} text-theme-muted font-body`,children:[s.groups.map((j,E)=>r.jsxs("span",{children:[E>0&&" + ",r.jsxs("span",{title:j.customFaces?`d[${j.customFaces.join(",")}]`:`d${j.faces}`,children:["[",j.rolls.join(", "),"]"]})]},E)),s.modifier!==0&&r.jsxs("span",{children:[" ",s.modifier>=0?"+":"",s.modifier]})]}),s.groups.length===1&&s.groups[0].rolls.length===1&&s.groups[0].faces===20&&!s.groups[0].customFaces&&r.jsxs(r.Fragment,{children:[s.groups[0].rolls[0]===20&&r.jsx("div",{className:`text-green-600 font-bold ${m}`,children:"NAT 20!"}),s.groups[0].rolls[0]===1&&r.jsx("div",{className:`text-red-600 font-bold ${m}`,children:"NAT 1!"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`${v} font-bold text-theme-muted font-heading`,children:""}),r.jsx("div",{className:`${m} text-theme-muted font-body`,children:""})]})})]})}const ru=e=>typeof e=="object"&&"faces"in e&&Array.isArray(e.faces);function bc({widget:e}){const{label:t,availableDice:n=[4,6,8,10,12,20],showIndividualResults:o=!1}=e.data,[a,s]=T.useState([]),[i,c]=T.useState([]),[l,u]=T.useState(null),[h,g]=T.useState(!1),[f,w]=T.useState(null),[S,y]=T.useState(1),v="text-xs",m="py-1 px-2 text-xs",d="text-xl",b="text-[10px]",k="gap-1",C=I=>typeof I=="number"?!0:!isNaN(Number(I))&&I.trim()!=="",x=I=>{if(typeof Intl<"u"&&"Segmenter"in Intl){const L=Intl.Segmenter,Y=new L("en",{granularity:"grapheme"});return Array.from(Y.segment(I),J=>J.segment)}return[...I]},j=I=>{const L=x(I);if(L.length<=1)return[I];const Y=L[0];return L.every($=>$===Y)?L:[I]},E=I=>{if(typeof I=="number")return[I];const L=[],Y=I.split(",").map(J=>J.trim()).filter(J=>J.length>0);for(const J of Y)if(C(J))L.push(J);else{const $=j(J);L.push(...$)}return L},N=I=>{const L=[],Y=new Map;for(const F of I){const X=E(F);for(const oe of X)if(C(oe))L.push(typeof oe=="number"?oe:Number(oe));else{const H=String(oe);Y.set(H,(Y.get(H)||0)+1)}}const J=[];if(L.length>0){const F=L.reduce((X,oe)=>X+oe,0);J.push({value:String(F),count:L.length,isNumeric:!0,numericTotal:F})}const $=Array.from(Y.entries()).sort((F,X)=>X[1]-F[1]);for(const[F,X]of $)J.push({value:F,count:X,isNumeric:!1});return J},p=I=>{ru(I)?s(L=>[...L,{faces:I.faces,id:S,customDieName:I.name}]):s(L=>[...L,{faces:I,id:S}]),y(L=>L+1),u(null),c([])},M=()=>{s([]),u(null)},P=()=>{a.length!==0&&(g(!0),setTimeout(()=>{const I=[],L=[];for(const F of a)if(Array.isArray(F.faces)){const X=Math.floor(Math.random()*F.faces.length),oe=F.faces[X];I.push({faces:F.faces,roll:oe,customDieName:F.customDieName,id:F.id}),L.push(oe)}else{const X=Math.floor(Math.random()*F.faces)+1;I.push({faces:F.faces,roll:X,id:F.id}),L.push(X)}const Y=N(L),J=Y.find(F=>F.isNumeric),$=J?J.numericTotal||0:null;u({dice:I,total:$,aggregatedResults:Y}),g(!1),c([...a]),s([]),y(1)},300))},A=()=>{i.length===0||h||(s([...i]),setTimeout(()=>{g(!0),setTimeout(()=>{const I=[],L=[];for(const F of i)if(Array.isArray(F.faces)){const X=Math.floor(Math.random()*F.faces.length),oe=F.faces[X];I.push({faces:F.faces,roll:oe,customDieName:F.customDieName,id:F.id}),L.push(oe)}else{const X=Math.floor(Math.random()*F.faces)+1;I.push({faces:F.faces,roll:X,id:F.id}),L.push(X)}const Y=N(L),J=Y.find(F=>F.isNumeric),$=J?J.numericTotal||0:null;u({dice:I,total:$,aggregatedResults:Y}),g(!1),s([])},300)},0))},_=I=>{if(!l||h||f!==null)return;const L=l.dice[I];w(L.id),setTimeout(()=>{let Y;if(Array.isArray(L.faces)){const H=Math.floor(Math.random()*L.faces.length);Y=L.faces[H]}else Y=Math.floor(Math.random()*L.faces)+1;const J=l.dice.map((H,he)=>he===I?{...H,roll:Y}:H),$=J.map(H=>H.roll),F=N($),X=F.find(H=>H.isNumeric),oe=X?X.numericTotal||0:null;u({dice:J,total:oe,aggregatedResults:F}),c(H=>H.map((he,je)=>je===I?{...he}:he)),w(null)},200)},O=()=>{const I={},L={};for(const J of a)if(Array.isArray(J.faces)){const $=J.customDieName||"custom";L[$]=(L[$]||0)+1}else I[J.faces]=(I[J.faces]||0)+1;const Y=[];return Object.entries(I).sort(([J],[$])=>Number($)-Number(J)).forEach(([J,$])=>{Y.push(`${$}d${J}`)}),Object.entries(L).forEach(([J,$])=>{Y.push($>1?`${$} ${J}`:J)}),Y.length>0?Y.join(" + "):"Empty"},V=()=>{if(!l)return"";if(o)return l.dice.map(L=>String(L.roll)).join(", ");const I=[];for(const L of l.aggregatedResults)L.isNumeric?I.push(String(L.numericTotal||0)):I.push(`${L.count}${L.value}`);return I.join(" | ")},z=l==null?void 0:l.aggregatedResults.some(I=>!I.isNumeric);return r.jsxs("div",{className:`flex flex-col ${k} w-full h-full`,children:[t&&r.jsx("div",{className:`font-bold text-center ${v} text-theme-ink font-heading flex-shrink-0`,children:t}),r.jsx("div",{className:"flex flex-wrap gap-1 justify-center flex-shrink-0",children:n.map((I,L)=>ru(I)?r.jsx("button",{onClick:()=>p(I),onMouseDown:Y=>Y.stopPropagation(),className:`${m} border border-theme-border font-bold transition-all rounded-button bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper min-w-[40px] font-body`,title:`Add ${I.name} (${I.faces.length} faces: ${I.faces.slice(0,3).join(", ")}${I.faces.length>3?"...":""})`,children:I.name},`custom-${I.name}-${L}`):r.jsxs("button",{onClick:()=>p(I),onMouseDown:Y=>Y.stopPropagation(),className:`${m} border border-theme-border font-bold transition-all rounded-button bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper min-w-[40px] font-body`,title:`Add d${I}`,children:["d",I]},`standard-${I}`))}),r.jsxs("div",{className:"flex gap-1 justify-center flex-shrink-0 mt-2",children:[r.jsx("button",{onClick:P,onMouseDown:I=>I.stopPropagation(),className:`${m} border border-theme-border font-bold transition-all rounded-button flex-1 font-body ${h||a.length===0?"bg-theme-muted text-theme-paper cursor-not-allowed":"bg-theme-accent text-theme-paper hover:opacity-90"}`,disabled:h||a.length===0,children:a.length>0?`Roll ${O()}`:"Roll"}),a.length>0&&r.jsx("button",{onClick:M,onMouseDown:I=>I.stopPropagation(),className:`${m} border border-theme-border font-bold transition-all rounded-button bg-theme-paper text-theme-ink hover:bg-red-500 hover:text-white hover:border-red-500 rounded-button font-body`,children:"Clear"}),a.length===0&&i.length>0&&r.jsx("button",{onClick:A,onMouseDown:I=>I.stopPropagation(),className:`${m} border border-theme-border font-bold transition-all rounded-button bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper font-body`,title:"Reroll last dice",disabled:h,children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),r.jsx("div",{className:"text-center flex-shrink-0",children:l&&!h?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`${d} font-bold text-theme-ink font-heading`,children:o||z?V():l.total??""}),!o&&r.jsx("div",{className:`${b} text-theme-muted font-body flex flex-wrap justify-center items-center gap-0.5`,children:l.dice.map((I,L)=>r.jsxs("span",{className:"inline-flex items-center",children:[L>0&&r.jsx("span",{className:"mx-0.5",children:"+"}),r.jsx("button",{onClick:()=>_(L),onMouseDown:Y=>Y.stopPropagation(),disabled:f!==null,className:`
                        px-1 py-0.5 rounded transition-all
                        hover:bg-theme-accent hover:text-theme-paper
                        focus:outline-none focus:ring-1 focus:ring-theme-accent
                        ${f===I.id?"animate-pulse bg-theme-accent text-theme-paper":""}
                        cursor-pointer
                      `,title:`Click to re-roll this ${Array.isArray(I.faces)?I.customDieName||"custom die":`d${I.faces}`}`,children:I.roll})]},I.id))}),o&&r.jsx("div",{className:`${b} text-theme-muted font-body flex flex-wrap justify-center items-center gap-0.5 mt-1`,children:l.dice.map((I,L)=>r.jsx("button",{onClick:()=>_(L),onMouseDown:Y=>Y.stopPropagation(),disabled:f!==null,className:`
                      px-1 py-0.5 rounded transition-all
                      hover:bg-theme-accent hover:text-theme-paper
                      focus:outline-none focus:ring-1 focus:ring-theme-accent
                      ${f===I.id?"animate-pulse bg-theme-accent text-theme-paper":""}
                      cursor-pointer
                    `,title:`Click to re-roll this ${Array.isArray(I.faces)?I.customDieName||"custom die":`d${I.faces}`}`,children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},I.id))}),l.dice.length===1&&typeof l.dice[0].faces=="number"&&l.dice[0].faces===20&&r.jsxs(r.Fragment,{children:[l.dice[0].roll===20&&r.jsx("div",{className:`text-green-600 font-bold ${b}`,children:"NAT 20!"}),l.dice[0].roll===1&&r.jsx("div",{className:`text-red-600 font-bold ${b}`,children:"NAT 1!"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`${d} font-bold text-theme-muted font-heading`,children:""}),r.jsx("div",{className:`${b} text-theme-muted font-body`,children:""})]})})]})}function vc({widget:e,height:t}){const n=q(k=>k.updateWidgetData),a=q(k=>k.mode)==="print",{label:s,spellLevels:i=[{level:1,max:4,used:0}]}=e.data,c="text-xs",l="w-6 text-[10px]",u="w-4 h-4",h="text-[10px] px-1 py-0.5",g="gap-1",v=Math.max(30,t-16-28-4*3-0*2),m=(k,C)=>{const x=[...i],j=x[k];C<j.used?x[k]={...j,used:C}:x[k]={...j,used:C+1},n(e.id,{spellLevels:x})},d=()=>{const k=i.map(C=>({...C,used:0}));n(e.id,{spellLevels:k})},b=k=>{const C=["th","st","nd","rd"],x=k%100;return k+(C[(x-20)%10]||C[x]||C[0])};return r.jsxs("div",{className:`flex flex-col ${g} w-full h-full`,children:[s&&r.jsx("div",{className:`font-bold ${c} text-theme-ink font-heading flex-shrink-0`,children:s}),r.jsxs("div",{className:`flex flex-col ${g} overflow-y-auto flex-1`,style:{maxHeight:`${v}px`},onWheel:k=>{const C=k.currentTarget;C.scrollHeight>C.clientHeight&&k.stopPropagation()},children:[i.map((k,C)=>r.jsxs("div",{className:`flex items-center ${g}`,children:[r.jsx("span",{className:`${l} font-bold text-center text-theme-ink font-body`,children:b(k.level)}),r.jsx("div",{className:"flex gap-1 flex-1 flex-wrap",children:Array.from({length:k.max}).map((x,j)=>r.jsx("button",{onClick:()=>m(C,j),onMouseDown:E=>E.stopPropagation(),className:`${u} rounded-full border border-theme-border transition-all ${j<k.used?"bg-theme-accent":"bg-theme-paper hover:opacity-80"}`,title:j<k.used?"Click to restore":"Click to use"},j))})]},C)),i.length===0&&r.jsx("div",{className:`${l} text-theme-muted italic`,children:"No spell levels configured"})]}),r.jsx("div",{className:`flex items-center justify-end ${g} pt-1 flex-shrink-0 ${a?"opacity-0":""}`,children:r.jsx("button",{onClick:d,onMouseDown:k=>k.stopPropagation(),className:`${h} border border-theme-border hover:bg-theme-accent hover:text-theme-paper transition-colors text-theme-ink rounded-button font-body`,children:"Reset All"})})]})}function yc({widget:e,width:t,height:n}){const{label:o,imageUrl:a=""}=e.data,s="text-xs",i="text-2xl",c="text-[10px]",l="gap-1",u=n>1e3,w=u?Math.min(300,t):Math.max(40,n-16-4-0*2);return r.jsxs("div",{className:`flex flex-col ${l} w-full ${u?"":"h-full"}`,children:[o&&r.jsx("div",{className:`font-bold text-center ${s} text-theme-ink font-heading flex-shrink-0`,children:o}),r.jsx("div",{className:`border-[length:var(--border-width)] border-theme-border bg-theme-background flex items-center justify-center overflow-hidden ${u?"":"flex-1"}`,style:{height:`${w}px`,borderRadius:"min(var(--button-radius), 16px)"},children:a?r.jsx("img",{src:a,alt:o||"Character",className:`w-full h-full ${u?"object-contain":"object-cover"}`,onError:S=>{S.target.style.display="none"}}):r.jsxs("div",{className:"text-theme-muted text-center p-1",children:[r.jsx("div",{className:`${i} mb-1`,children:""}),r.jsx("span",{className:`${c} font-body`,children:"No image"})]})})]})}const nu=(e,t)=>{switch(t){case"hearts":return e?"":"";case"boxes":return e?"":"";case"stars":return e?"":"";case"diamonds":return e?"":"";case"crosses":return e?"":"";case"checkmarks":return e?"":"";case"flames":return e?"":"";case"skulls":return e?"":"";case"shields":return e?"":"";case"swords":return e?"":"";case"lightning":return e?"":"";case"moons":return e?"":"";case"suns":return e?"":"";case"coins":return e?"":"";case"gems":return e?"":"";case"dots":default:return e?"":""}},ou=(e,t,n)=>{const o=`${n} flex items-center justify-center transition-all cursor-pointer hover:scale-125`;return["hearts","flames","skulls","shields","swords","lightning","moons","suns","coins","gems"].includes(t)?o:`${o} ${e?"text-theme-ink":"text-theme-muted"}`};function wc({widget:e,height:t}){const n=q(b=>b.updateWidgetData),{label:o,maxPool:a=5,currentPool:s=5,poolStyle:i="dots",showPoolCount:c=!0,poolResources:l=[],inlineLabels:u=!1}=e.data,h="text-xs",g="w-5 h-5 text-sm",f="text-[10px]",w="gap-1",S=l.length>0,y=b=>{b<s?n(e.id,{currentPool:b}):n(e.id,{currentPool:b+1})},v=(b,k)=>{const C=l[b],x=[...l];k<C.current?x[b]={...C,current:k}:x[b]={...C,current:k+1},n(e.id,{poolResources:x})},d=t-(o?20:0)-8;return r.jsxs("div",{className:`flex flex-col ${w} w-full h-full`,children:[o&&r.jsx("div",{className:`font-bold ${h} text-theme-ink font-heading flex-shrink-0`,children:o}),S?r.jsx("div",{className:"flex flex-col gap-2 flex-1 overflow-y-auto pr-1",style:{maxHeight:`${d}px`},onWheel:b=>{const k=b.currentTarget;k.scrollHeight>k.clientHeight&&b.stopPropagation()},children:l.map((b,k)=>r.jsxs("div",{className:`flex flex-col ${w}`,children:[b.name&&!u&&r.jsx("div",{className:`font-medium ${f} text-theme-ink font-body`,children:b.name}),r.jsxs("div",{className:`flex ${u?"justify-between items-center":"flex-wrap gap-0.5 content-start items-center"}`,children:[b.name&&u&&r.jsx("span",{className:`font-medium ${f} text-theme-ink font-body`,children:b.name}),r.jsx("div",{className:`flex ${u?"gap-0.5":"flex-wrap gap-0.5"}`,children:Array.from({length:b.max}).map((C,x)=>r.jsx("button",{onClick:()=>v(k,x),onMouseDown:j=>j.stopPropagation(),className:ou(x<b.current,b.style,g),title:x<b.current?"Click to use":"Click to restore",children:nu(x<b.current,b.style)},x))})]}),c&&r.jsxs("div",{className:`${f} text-theme-muted font-body`,children:[b.current," / ",b.max]})]},k))}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex flex-wrap gap-0.5 flex-1 content-start overflow-y-auto",onWheel:b=>{const k=b.currentTarget;k.scrollHeight>k.clientHeight&&b.stopPropagation()},children:Array.from({length:a}).map((b,k)=>r.jsx("button",{onClick:()=>y(k),onMouseDown:C=>C.stopPropagation(),className:ou(k<s,i,g),title:k<s?"Click to use":"Click to restore",children:nu(k<s,i)},k))}),c&&r.jsxs("div",{className:`${f} text-center text-theme-muted font-body flex-shrink-0`,children:[s," / ",a]})]})]})}function kc({widget:e}){const t=q(l=>l.updateWidgetData),{label:n,toggleItems:o=[]}=e.data,a="text-xs",s="px-1.5 py-0.5 text-[10px]",i="gap-1",c=l=>{const u=[...o];u[l]={...u[l],active:!u[l].active},t(e.id,{toggleItems:u})};return r.jsxs("div",{className:`flex flex-col ${i} w-full h-full`,children:[n&&r.jsx("div",{className:`font-bold ${a} text-theme-ink font-heading flex-shrink-0`,children:n}),r.jsxs("div",{className:`flex flex-wrap ${i} overflow-y-auto flex-1 content-start`,onWheel:l=>{const u=l.currentTarget;u.scrollHeight>u.clientHeight&&l.stopPropagation()},children:[o.map((l,u)=>r.jsx("button",{onClick:()=>c(u),onMouseDown:h=>h.stopPropagation(),className:`${s} border border-theme-border transition-all rounded-button font-body ${l.active?"bg-theme-accent text-theme-paper":"bg-theme-paper text-theme-ink hover:opacity-80"}`,children:l.name},u)),o.length===0&&r.jsx("div",{className:`${s} text-theme-muted italic`,children:"No conditions configured"})]})]})}function au(e){return typeof e=="string"?e:e.value}function go(e){return typeof e=="string"?{}:e.format||{}}function su(e,t){return{value:e,format:t}}function C0(e,t=1){if(!e||e.startsWith("var("))return!1;const n=e.replace("#","");if(n.length!==6)return!1;const o=parseInt(n.substring(0,2),16)/255,a=parseInt(n.substring(2,4),16)/255,s=parseInt(n.substring(4,6),16)/255,i=l=>l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4),c=.2126*i(o)+.7152*i(a)+.0722*i(s);return t>=.5&&c>.5}function T0({format:e,onFormatChange:t,onClose:n,position:o,isMobile:a,usedColors:s}){const i=T.useRef(null),[c,l]=T.useState(!1),u=T.useRef(null);T.useEffect(()=>{const w=S=>{i.current&&!i.current.contains(S.target)&&n()};return document.addEventListener("mousedown",w),document.addEventListener("touchstart",w),()=>{document.removeEventListener("mousedown",w),document.removeEventListener("touchstart",w)}},[n]);const h=`p-1.5 rounded hover:bg-theme-accent hover:text-theme-paper transition-colors ${a?"min-w-[36px] min-h-[36px]":"min-w-[28px] min-h-[28px]"} flex items-center justify-center`,g="bg-theme-accent text-theme-paper",f=a?"text-base":"text-sm";return r.jsx("div",{ref:i,className:"fixed z-[9999] bg-theme-paper border border-theme-border rounded-button shadow-lg",style:{left:a?"50%":o.x,top:a?"16px":o.y,transform:a?"translateX(-50%)":"none"},onMouseDown:w=>w.stopPropagation(),onTouchStart:w=>w.stopPropagation(),children:r.jsxs("div",{className:`flex items-center gap-0.5 p-1 ${a?"flex-wrap justify-center max-w-[280px]":""}`,children:[r.jsx("button",{className:`${h} ${f} font-bold ${e.bold?g:"text-theme-ink"}`,onClick:()=>t({bold:!e.bold}),title:"Bold",children:"B"}),r.jsx("button",{className:`${h} ${f} italic ${e.italic?g:"text-theme-ink"}`,onClick:()=>t({italic:!e.italic}),title:"Italic",children:"I"}),r.jsx("button",{className:`${h} ${f} underline ${e.underline?g:"text-theme-ink"}`,onClick:()=>t({underline:!e.underline}),title:"Underline",children:"U"}),r.jsx("button",{className:`${h} ${f} line-through ${e.strikethrough?g:"text-theme-ink"}`,onClick:()=>t({strikethrough:!e.strikethrough}),title:"Strikethrough",children:"S"}),r.jsx("div",{className:"w-px h-5 bg-theme-border mx-1"}),r.jsxs("div",{className:"relative",children:[r.jsx("button",{className:`${h} ${f} text-theme-ink`,onClick:()=>l(!c),title:"Background Color",children:r.jsxs("span",{className:"relative",children:[r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z",clipRule:"evenodd"})}),e.bgColor&&r.jsx("span",{className:"absolute -bottom-0.5 left-0 right-0 h-1 rounded-sm",style:{backgroundColor:e.bgColor,opacity:e.bgOpacity??1}})]})}),c&&r.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 top-full mt-1 bg-theme-paper border border-theme-border rounded-button shadow-lg p-2 z-10",style:{minWidth:"160px"},children:[r.jsx("button",{className:`w-full h-7 rounded border mb-1 ${e.bgColor?"border-theme-border":"border-theme-accent ring-2 ring-theme-accent"} bg-theme-paper relative`,onClick:()=>{t({bgColor:void 0,bgOpacity:void 0}),l(!1)},title:"No color",children:r.jsx("span",{className:"text-theme-muted text-xs",children:"No color"})}),r.jsx("button",{className:`w-full h-7 rounded border mb-2 ${e.bgColor==="var(--color-background)"?"border-theme-accent ring-2 ring-theme-accent":"border-theme-border"} bg-theme-background relative`,onClick:()=>{t({bgColor:"var(--color-background)"}),l(!1)},title:"Header color",children:r.jsx("span",{className:"text-theme-ink text-xs",children:"Header color"})}),s.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-[10px] text-theme-muted mb-1",children:"Recently used"}),r.jsx("div",{className:"grid grid-cols-5 gap-1 mb-2",children:s.filter(w=>w.color!=="var(--color-background)").slice(0,10).map((w,S)=>{let y=w.color;if(w.opacity<1&&!w.color.startsWith("var(")){const m=w.color.replace("#",""),d=parseInt(m.substring(0,2),16),b=parseInt(m.substring(2,4),16),k=parseInt(m.substring(4,6),16);y=`rgba(${d}, ${b}, ${k}, ${w.opacity})`}const v=e.bgColor===w.color&&(e.bgOpacity??1)===w.opacity;return r.jsx("button",{className:`w-6 h-6 rounded border ${v?"border-theme-accent ring-2 ring-theme-accent":"border-theme-border"}`,style:{backgroundColor:y},onClick:()=>{t({bgColor:w.color,bgOpacity:w.opacity})},title:`${w.color} (${Math.round(w.opacity*100)}%)`},`${w.color}-${w.opacity}-${S}`)})})]}),r.jsx("div",{className:"text-[10px] text-theme-muted mb-1",children:"Custom color"}),r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("input",{ref:u,type:"color",value:e.bgColor&&!e.bgColor.startsWith("var(")?e.bgColor:"#ffffff",onChange:w=>{t({bgColor:w.target.value})},className:"w-8 h-8 rounded border border-theme-border cursor-pointer",style:{padding:0}}),r.jsx("button",{className:"flex-1 px-2 py-1 text-xs border border-theme-border rounded hover:bg-theme-accent hover:text-theme-paper",onClick:()=>{var w;(w=u.current)==null||w.click()},children:"Pick color"})]}),e.bgColor&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"text-[10px] text-theme-muted mb-1",children:["Opacity: ",Math.round((e.bgOpacity??1)*100),"%"]}),r.jsx("input",{type:"range",min:"0",max:"100",value:Math.round((e.bgOpacity??1)*100),onChange:w=>{t({bgOpacity:parseInt(w.target.value)/100})},className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-theme-border"})]})]})]}),r.jsx("div",{className:"w-px h-5 bg-theme-border mx-1"}),r.jsx("button",{className:`${h} ${f} ${e.hAlign==="left"||!e.hAlign?g:"text-theme-ink"}`,onClick:()=>t({hAlign:"left"}),title:"Align Left",children:r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z",clipRule:"evenodd"})})}),r.jsx("button",{className:`${h} ${f} ${e.hAlign==="center"?g:"text-theme-ink"}`,onClick:()=>t({hAlign:"center"}),title:"Align Center",children:r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm4 5.25a.75.75 0 01.75-.75h6.5a.75.75 0 010 1.5h-6.5a.75.75 0 01-.75-.75z",clipRule:"evenodd"})})}),r.jsx("button",{className:`${h} ${f} ${e.hAlign==="right"?g:"text-theme-ink"}`,onClick:()=>t({hAlign:"right"}),title:"Align Right",children:r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm5 10.5a.75.75 0 01.75-.75h9.5a.75.75 0 010 1.5h-9.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z",clipRule:"evenodd"})})})]})})}function jc({widget:e,height:t}){var Z;const n=q(W=>W.updateWidgetData),o=q(W=>W.characters),a=q(W=>W.activeCharacterId),i=q(W=>W.mode)==="print",{label:c,columns:l=["Item","Qty","Weight"],rows:u=[]}=e.data,[h,g]=T.useState(null),[f,w]=T.useState(null),[S,y]=T.useState(!1),[v,m]=T.useState({x:0,y:0}),[d,b]=T.useState(null),[k,C]=T.useState(null),x=T.useRef(null),j=T.useRef(null),E=T.useMemo(()=>{const W=o.find(re=>re.id===a);if(!W)return[];const B=new Map;return W.sheets.forEach(re=>{re.widgets.forEach(te=>{te.type==="TABLE"&&te.data.rows&&te.data.rows.forEach(fe=>{fe.cells.forEach(me=>{const be=go(me);if(be.bgColor){const Ie=`${be.bgColor}|${be.bgOpacity??1}`;B.has(Ie)||B.set(Ie,{color:be.bgColor,opacity:be.bgOpacity??1})}})})})}),Array.from(B.values())},[o,a]),[N,p]=T.useState(!1);T.useEffect(()=>{const W=()=>p(window.innerWidth<768||"ontouchstart"in window);return W(),window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]);const M="text-xs",P="text-[10px] p-0.5",A="gap-1",z=Math.max(40,t-16-4-0*2),I=(W,B,re)=>{const te=[...u],fe=te[W].cells[B],me=go(fe);te[W]={...te[W],cells:[...te[W].cells]},te[W].cells[B]=su(re,me),n(e.id,{rows:te})},L=(W,B,re)=>{const te=[...u],fe=te[W].cells[B],me=au(fe),be=go(fe);te[W]={...te[W],cells:[...te[W].cells]};const Ie={...be,...re};Object.keys(Ie).forEach(Je=>{Ie[Je]===void 0&&delete Ie[Je]}),te[W].cells[B]=su(me,Object.keys(Ie).length>0?Ie:void 0),n(e.id,{rows:te})},Y=(W,B,re)=>{g({row:W,col:B}),w({row:W,col:B});const te=re.clientX,fe=re.clientY,me=320;m({x:Math.max(8,Math.min(te-me/2,window.innerWidth-me-8)),y:Math.max(8,fe-50)}),y(!0)},J=(W,B)=>{},$=W=>{const B=[...u];B[W]={cells:l.map(()=>"")},n(e.id,{rows:B})},F=(W,B)=>{x.current=B,b(B),W.dataTransfer.effectAllowed="move",W.dataTransfer.setData("text/plain",B.toString())},X=(W,B)=>{W.preventDefault(),W.stopPropagation(),x.current!==null&&x.current!==B&&C(B)},oe=()=>{C(null)},H=(W,B)=>{W.preventDefault(),W.stopPropagation();const re=x.current;if(re!==null&&re!==B){const te=[...u],[fe]=te.splice(re,1);te.splice(B,0,fe),n(e.id,{rows:te})}x.current=null,b(null),C(null)},he=()=>{x.current=null,b(null),C(null)},je=T.useRef(null),$e=(W,B)=>{var me,be;W.stopPropagation();const re=W.touches[0],te=(me=j.current)==null?void 0:me.querySelector("tbody"),fe=(be=j.current)==null?void 0:be.querySelector(".overflow-auto");if(te){const Ie=Array.from(te.querySelectorAll("tr")),Je=Ie.map(qe=>qe.getBoundingClientRect().height);je.current={startY:re.clientY,currentY:re.clientY,rowIndex:B,rowElements:Ie,rowHeights:Je,scrollContainer:fe},x.current=B,b(B)}},Se=W=>{var Je;if(!je.current||x.current===null)return;W.preventDefault(),W.stopPropagation();const B=W.touches[0];je.current.currentY=B.clientY;const{rowHeights:re,scrollContainer:te}=je.current,fe=x.current;let me=0,be=-1;const Ie=(Je=j.current)==null?void 0:Je.querySelector("tbody");if(Ie){const qe=Ie.getBoundingClientRect(),U=B.clientY-qe.top+((te==null?void 0:te.scrollTop)||0);for(let ue=0;ue<re.length;ue++)if(me+=re[ue],U<me){be=ue;break}be===-1&&re.length>0&&(be=re.length-1)}if(C(be!==-1&&be!==fe?be:null),te){const qe=te.getBoundingClientRect(),U=40,ue=5;B.clientY<qe.top+U?te.scrollTop-=ue:B.clientY>qe.bottom-U&&(te.scrollTop+=ue)}},Qe=()=>{if(!je.current||x.current===null)return;const W=x.current,B=k;if(B!==null&&W!==B){const re=[...u],[te]=re.splice(W,1);re.splice(B,0,te),n(e.id,{rows:re})}je.current=null,x.current=null,b(null),C(null)},Ae=W=>{const B={};if(W.bgColor)if(W.bgColor.startsWith("var("))B.backgroundColor=W.bgColor,W.bgOpacity!==void 0&&W.bgOpacity<1&&(B.position="relative");else{const re=W.bgOpacity??1;if(re<1){const te=W.bgColor.replace("#",""),fe=parseInt(te.substring(0,2),16),me=parseInt(te.substring(2,4),16),be=parseInt(te.substring(4,6),16);B.backgroundColor=`rgba(${fe}, ${me}, ${be}, ${re})`}else B.backgroundColor=W.bgColor}return W.hAlign&&(B.textAlign=W.hAlign),B},G=W=>{const B={};return W.vAlign==="top"?B.alignItems="flex-start":W.vAlign==="bottom"?B.alignItems="flex-end":B.alignItems="center",B},ae=W=>{const B=[];return W.bold&&B.push("font-bold"),W.italic&&B.push("italic"),W.underline&&B.push("underline"),W.strikethrough&&B.push("line-through"),B.join(" ")};T.useEffect(()=>{const W=B=>{j.current&&!j.current.contains(B.target)&&(y(!1),w(null))};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const de=T.useRef(null),[ce,Ne]=T.useState(null),Te=(W,B)=>{Ne({row:W,col:B}),de.current=setTimeout(()=>{w({row:W,col:B}),y(!0),de.current=null},500)},Q=(W,B,re)=>{de.current&&(clearTimeout(de.current),de.current=null,(ce==null?void 0:ce.row)===W&&(ce==null?void 0:ce.col)===B&&(g({row:W,col:B}),w({row:W,col:B}),y(!0),re.preventDefault())),Ne(null)},K=()=>{de.current&&(clearTimeout(de.current),de.current=null),Ne(null)};return r.jsxs("div",{ref:j,className:`flex flex-col ${A} w-full h-full`,children:[c&&r.jsx("div",{className:`font-bold ${M} text-theme-ink font-heading flex-shrink-0`,children:c}),r.jsx("div",{className:"overflow-auto flex-1",style:{maxHeight:`${z}px`},onWheel:W=>{const B=W.currentTarget;(B.scrollHeight>B.clientHeight||B.scrollWidth>B.clientWidth)&&W.stopPropagation()},onDragOver:W=>W.preventDefault(),children:r.jsxs("table",{className:`w-full ${P}`,style:{borderCollapse:"separate",borderSpacing:0},children:[r.jsx("thead",{className:"sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"w-4 bg-transparent"}),l.map((W,B)=>r.jsx("th",{className:`border border-theme-border bg-theme-background ${P} text-theme-ink font-heading`,style:{borderLeftWidth:B===0?1:0},children:W},B)),r.jsx("th",{className:"w-4 bg-transparent"})]})}),r.jsx("tbody",{children:u.map((W,B)=>r.jsxs("tr",{className:`group ${d===B?"opacity-50":""} ${k===B&&d!==B?"border-t-2 border-theme-accent":""}`,onDragOver:re=>{re.preventDefault(),re.stopPropagation(),X(re,B)},onDragLeave:oe,onDrop:re=>{re.preventDefault(),re.stopPropagation(),H(re,B)},children:[r.jsx("td",{className:"w-4 p-0 cursor-grab active:cursor-grabbing",draggable:!0,onDragStart:re=>F(re,B),onDragEnd:he,onMouseDown:re=>re.stopPropagation(),onTouchStart:re=>$e(re,B),onTouchMove:Se,onTouchEnd:Qe,children:r.jsx("div",{className:`text-theme-muted hover:text-theme-ink text-[10px] text-center touch-none select-none ${i?"opacity-0":""}`,children:""})}),W.cells.map((re,te)=>{const fe=au(re),me=go(re),be=(f==null?void 0:f.row)===B&&(f==null?void 0:f.col)===te,Ie=(h==null?void 0:h.row)===B&&(h==null?void 0:h.col)===te,Je=me.bgColor?C0(me.bgColor,me.bgOpacity??1):!1,qe=Je?{color:"#1a1a1a"}:{};return r.jsx("td",{className:`${be?"border-theme-accent border-2":"border border-theme-border"} ${P} ${Je?"":"text-theme-ink"}`,style:{...Ae(me),...qe,borderTopWidth:0,borderLeftWidth:te===0?1:0},children:Ie?r.jsx("input",{autoFocus:!0,value:fe,onChange:U=>I(B,te,U.target.value),onBlur:()=>g(null),onKeyDown:U=>{U.key==="Enter"?g(null):U.key==="Tab"?(U.preventDefault(),U.shiftKey?te>0?(g({row:B,col:te-1}),w({row:B,col:te-1})):B>0&&(g({row:B-1,col:l.length-1}),w({row:B-1,col:l.length-1})):te<l.length-1?(g({row:B,col:te+1}),w({row:B,col:te+1})):B<u.length-1&&(g({row:B+1,col:0}),w({row:B+1,col:0}))):U.key==="Escape"&&g(null)},className:`w-full bg-transparent focus:outline-none text-[10px] ${Je?"":"text-theme-ink"} font-body ${ae(me)}`,style:{textAlign:me.hAlign||"left",...qe},onMouseDown:U=>U.stopPropagation()}):r.jsx("div",{onClick:U=>Y(B,te,U),onDoubleClick:()=>J(),onTouchStart:()=>Te(B,te),onTouchEnd:U=>Q(B,te,U),onTouchMove:K,onMouseDown:U=>U.stopPropagation(),className:`min-h-[1.5em] cursor-pointer hover:opacity-70 font-body flex ${ae(me)}`,style:{...G(me),...qe,justifyContent:me.hAlign==="center"?"center":me.hAlign==="right"?"flex-end":"flex-start"},children:fe||r.jsx("span",{className:`text-theme-muted ${i?"opacity-0":""}`,children:"-"})})},te)}),r.jsx("td",{className:"w-4 p-0",children:r.jsx("button",{onClick:()=>$(B),onMouseDown:re=>re.stopPropagation(),className:`w-full h-full text-theme-muted hover:text-theme-ink opacity-0 group-hover:opacity-100 ${i?"!opacity-0":""}`,children:""})})]},B))})]})}),S&&f&&er.createPortal(r.jsx(T0,{format:go((Z=u[f.row])==null?void 0:Z.cells[f.col]),onFormatChange:W=>L(f.row,f.col,W),onClose:()=>{y(!1),w(null)},position:v,isMobile:N,usedColors:E}),document.body)]})}function lu({title:e,onClose:t,children:n}){return er.createPortal(r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999]",onClick:t,onMouseDown:o=>o.stopPropagation(),children:r.jsxs("div",{className:"bg-theme-paper border border-theme-border rounded-button shadow-xl p-4 min-w-[280px] max-w-[400px]",onClick:o=>o.stopPropagation(),children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"font-bold text-theme-ink font-heading",children:e}),r.jsx("button",{onClick:t,className:"text-theme-muted hover:text-theme-ink text-xl leading-none",children:""})]}),n]})}),document.body)}function E0(e){if(e<=0)return"Expired";const t=Math.floor(e/(365*24*60*60)),n=Math.floor(e%(365*24*60*60)/(30*24*60*60)),o=Math.floor(e%(30*24*60*60)/(24*60*60)),a=Math.floor(e%(24*60*60)/(60*60)),s=Math.floor(e%(60*60)/60),i=e%60,c=[];return t>0&&c.push(`${t}y`),n>0&&c.push(`${n}mo`),o>0&&c.push(`${o}d`),a>0&&c.push(`${a}h`),s>0&&c.push(`${s}m`),(i>0||c.length===0)&&c.push(`${i}s`),c.slice(0,3).join(" ")}function iu(e,t){switch(t){case"seconds":return e;case"minutes":return e*60;case"hours":return e*60*60;case"days":return e*24*60*60;case"months":return e*30*24*60*60;case"years":return e*365*24*60*60;default:return e}}function I0(e){return e<=0?"Expired":e===1?"1 round":`${e} rounds`}function Nc({widget:e,height:t}){const n=q($=>$.updateWidgetData),a=q($=>$.mode)==="print",{label:s,timedEffects:i=[],roundMode:c=!1,effectSuggestions:l=[]}=e.data,[u,h]=T.useState(!1),[g,f]=T.useState(!1),[w,S]=T.useState(""),[y,v]=T.useState(1),[m,d]=T.useState("minutes"),[b,k]=T.useState(1),[C,x]=T.useState("minutes"),j="text-xs",E="text-xs",N="text-xs px-2 py-1",p="gap-1",M=()=>{if(w.trim()){const $=c?y:iu(y,m),F={name:w.trim(),remainingSeconds:$,initialSeconds:$};n(e.id,{timedEffects:[...i,F]}),S(""),v(1),h(!1)}},P=()=>{S(""),v(1),h(!1)},A=$=>{const F=[...i];F.splice($,1),n(e.id,{timedEffects:F})},_=()=>{const $=c?1:iu(b,C),F=i.map(X=>({...X,remainingSeconds:Math.max(0,X.remainingSeconds-$)}));n(e.id,{timedEffects:F}),f(!1)},O=()=>{const $=i.map(F=>({...F,remainingSeconds:Math.max(0,F.remainingSeconds-1)}));n(e.id,{timedEffects:$})},V=()=>{k(1),f(!1)},J=Math.max(60,t-16-32-4*3-0*2);return r.jsxs("div",{className:`flex flex-col ${p} w-full h-full`,children:[s&&r.jsx("div",{className:`font-bold ${j} text-theme-ink font-heading flex-shrink-0`,children:s}),r.jsxs("div",{className:`space-y-1 overflow-y-auto flex-1 ${E}`,style:{maxHeight:`${J}px`},onWheel:$=>{const F=$.currentTarget;F.scrollHeight>F.clientHeight&&$.stopPropagation()},children:[i.map(($,F)=>r.jsxs("div",{className:`flex items-center gap-2 px-2 py-1 rounded-button border ${$.remainingSeconds<=0?"bg-theme-accent/20 border-theme-accent animate-pulse":"bg-theme-paper/50 border-theme-border"}`,children:[r.jsx("span",{className:`flex-1 min-w-0 truncate font-medium text-xs font-body ${$.remainingSeconds<=0?"text-theme-accent":"text-theme-ink"}`,children:$.name}),r.jsx("span",{className:`flex-shrink-0 text-xs font-body ${$.remainingSeconds<=0?"text-theme-accent font-bold":"text-theme-muted"}`,children:c?I0($.remainingSeconds):E0($.remainingSeconds)}),r.jsx("button",{onClick:()=>{const X=[...i];X[F]={...$,remainingSeconds:$.initialSeconds??$.remainingSeconds},n(e.id,{timedEffects:X})},className:`flex-shrink-0 px-2 py-0.5 text-xs border border-theme-border rounded-button bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors font-body ${a?"opacity-0":""}`,onMouseDown:X=>X.stopPropagation(),title:"Reset to initial duration",children:""}),r.jsx("button",{onClick:()=>A(F),className:`flex-shrink-0 px-2 py-0.5 text-xs border border-red-500/50 rounded-button bg-theme-paper text-red-500 hover:bg-red-500 hover:text-white transition-colors font-body ${a?"opacity-0":""}`,onMouseDown:X=>X.stopPropagation(),title:"Remove effect",children:""})]},F)),i.length===0&&!u&&r.jsx("div",{className:`text-theme-muted italic text-center py-2 ${a?"opacity-0":""}`,children:"No active effects"})]}),r.jsxs("div",{className:`flex ${p} pt-1 flex-shrink-0 ${a?"opacity-0":""}`,children:[r.jsx("button",{onClick:()=>h(!0),className:`${N} flex-1 border border-theme-border text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-bold font-body`,onMouseDown:$=>$.stopPropagation(),children:"+ Add Effect"}),i.length>0&&(c?r.jsx("button",{onClick:O,className:`${N} flex-1 border border-theme-border text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-bold font-body`,onMouseDown:$=>$.stopPropagation(),children:" Pass Round"}):r.jsx("button",{onClick:()=>f(!0),className:`${N} flex-1 border border-theme-border text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-bold font-body`,onMouseDown:$=>$.stopPropagation(),children:" Pass Time"}))]}),u&&r.jsx(lu,{title:"Add Effect",onClose:P,children:r.jsxs("div",{className:"space-y-3",children:[l.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1",children:l.map(($,F)=>r.jsx("button",{type:"button",className:"px-2 py-1 text-xs bg-theme-border/30 text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-body",onClick:()=>S($),children:$},F))}),r.jsx("input",{className:"w-full border border-theme-border focus:border-theme-accent focus:outline-none py-2 px-3 bg-theme-paper text-theme-ink font-body rounded-button",value:w,onChange:$=>S($.target.value),placeholder:"Effect name...",autoFocus:!0,onKeyDown:$=>{$.key==="Enter"&&M(),$.key==="Escape"&&P()}}),c?r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsx("input",{type:"number",min:"1",className:"w-20 border border-theme-border focus:border-theme-accent focus:outline-none py-2 px-3 bg-theme-paper text-theme-ink font-body rounded-button text-center",value:y,onChange:$=>v($.target.value===""?"":parseInt($.target.value)||1),onBlur:$=>v(Math.max(1,parseInt($.target.value)||1))}),r.jsx("span",{className:"text-theme-ink",children:y===1?"round":"rounds"})]}):r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"number",min:"1",className:"w-20 border border-theme-border focus:border-theme-accent focus:outline-none py-2 px-3 bg-theme-paper text-theme-ink font-body rounded-button text-center",value:y,onChange:$=>v($.target.value===""?"":parseInt($.target.value)||1),onBlur:$=>v(Math.max(1,parseInt($.target.value)||1))}),r.jsxs("select",{className:"flex-1 border border-theme-border focus:border-theme-accent focus:outline-none py-2 px-3 bg-theme-paper text-theme-ink font-body rounded-button",value:m,onChange:$=>d($.target.value),children:[r.jsx("option",{value:"seconds",children:"Seconds"}),r.jsx("option",{value:"minutes",children:"Minutes"}),r.jsx("option",{value:"hours",children:"Hours"}),r.jsx("option",{value:"days",children:"Days"}),r.jsx("option",{value:"months",children:"Months"}),r.jsx("option",{value:"years",children:"Years"})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsx("button",{onClick:M,className:"flex-1 py-2 px-4 bg-theme-accent text-theme-paper rounded-button hover:opacity-90 transition-colors font-bold font-body",children:"Add Effect"}),r.jsx("button",{onClick:P,className:"flex-1 py-2 px-4 border border-theme-border text-theme-muted rounded-button hover:bg-theme-border hover:text-theme-ink transition-colors font-body",children:"Cancel"})]})]})}),g&&r.jsx(lu,{title:"Pass Time",onClose:V,children:r.jsxs("div",{className:"space-y-3",children:[r.jsx("p",{className:"text-theme-muted text-sm",children:"How much time passes for all effects?"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"number",min:"1",className:"w-20 border border-theme-border focus:border-theme-accent focus:outline-none py-2 px-3 bg-theme-paper text-theme-ink font-body rounded-button text-center",value:b,onChange:$=>k($.target.value===""?"":parseInt($.target.value)||1),onBlur:$=>k(Math.max(1,parseInt($.target.value)||1)),autoFocus:!0,onKeyDown:$=>{$.key==="Enter"&&_(),$.key==="Escape"&&V()}}),r.jsxs("select",{className:"flex-1 border border-theme-border focus:border-theme-accent focus:outline-none py-2 px-3 bg-theme-paper text-theme-ink font-body rounded-button",value:C,onChange:$=>x($.target.value),children:[r.jsx("option",{value:"seconds",children:"Seconds"}),r.jsx("option",{value:"minutes",children:"Minutes"}),r.jsx("option",{value:"hours",children:"Hours"}),r.jsx("option",{value:"days",children:"Days"}),r.jsx("option",{value:"months",children:"Months"}),r.jsx("option",{value:"years",children:"Years"})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsx("button",{onClick:_,className:"flex-1 py-2 px-4 bg-theme-accent text-theme-paper rounded-button hover:opacity-90 transition-colors font-bold font-body",children:"Confirm"}),r.jsx("button",{onClick:V,className:"flex-1 py-2 px-4 border border-theme-border text-theme-muted rounded-button hover:bg-theme-border hover:text-theme-ink transition-colors font-body",children:"Cancel"})]})]})})]})}function Sc({widget:e,height:t}){const n=q(v=>v.updateWidgetData),a=q(v=>v.mode)==="print",{label:s,formItems:i=[],labelWidth:c=33}=e.data,l="text-xs",u="text-xs",h="gap-1",S=Math.max(30,t-16-4-0*2),y=(v,m)=>{const d=[...i];d[v]={...d[v],value:m},n(e.id,{formItems:d})};return r.jsxs("div",{className:`flex flex-col ${h} w-full h-full`,children:[s&&r.jsx("div",{className:`font-bold ${l} text-theme-ink font-heading flex-shrink-0`,children:s}),r.jsxs("div",{className:"flex flex-col gap-0.5 overflow-y-auto overflow-x-hidden flex-1 pr-1",style:{maxHeight:`${S}px`},onWheel:v=>{const m=v.currentTarget;m.scrollHeight>m.clientHeight&&v.stopPropagation()},children:[i.map((v,m)=>r.jsxs("div",{className:`flex items-center ${h}`,children:[r.jsx("span",{className:`${u} text-theme-ink font-body truncate flex-shrink-0`,style:{width:`${c}%`},children:v.name}),r.jsx("input",{type:"text",value:v.value,onChange:d=>y(m,d.target.value),onMouseDown:d=>d.stopPropagation(),className:`flex-1 ${u} px-1 py-0.5 border-b border-theme-border focus:border-theme-accent focus:outline-none bg-transparent text-theme-ink font-body min-w-0`,placeholder:a?"":"..."})]},m)),i.length===0&&r.jsx("div",{className:`${u} text-theme-muted italic`,children:"No fields yet"})]})]})}function M0({title:e,onClose:t,children:n}){return er.createPortal(r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999]",onClick:t,onMouseDown:o=>o.stopPropagation(),children:r.jsxs("div",{className:"bg-theme-paper border border-theme-border rounded-button shadow-xl p-4 min-w-[280px] max-w-[400px]",onClick:o=>o.stopPropagation(),children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"font-bold text-theme-ink font-heading",children:e}),r.jsx("button",{onClick:t,className:"text-theme-muted hover:text-theme-ink text-xl leading-none",children:""})]}),n]})}),document.body)}function cu(e,t){switch(t){case"seconds":return e;case"minutes":return e*60;case"hours":return e*60*60;case"days":return e*24*60*60;case"months":return e*30*24*60*60;case"years":return e*365*24*60*60;default:return e}}function P0(e){let t=0;for(const n of e)for(let o=0;o<n.count;o++)t+=Math.floor(Math.random()*n.faces)+1;return t}function R0(e){return e.map(t=>`${t.count}d${t.faces}`).join(" + ")}function Cc({widget:e}){const t=q(p=>p.performRest),[n,o]=T.useState(null),[a,s]=T.useState(!1),[i,c]=T.useState(!1),[l,u]=T.useState(1),[h,g]=T.useState("hours"),{buttonText:f="Rest",healToFull:w=!1,healRandomDice:S=[],healFlatAmount:y=0,clearConditions:v=!1,resetSpellSlots:m=!1,passTime:d=!1,passTimeAmount:b=0,passTimeUnit:k="hours"}=e.data,C=w||S.length>0||(y??0)>0||v||m||d,x=p=>{s(!0);let M,P="";w?(M="full",P="Healed to full!"):S.length>0?(M=P0(S)+(y??0),P=`Healed ${M} HP (${R0(S)}${y?` + ${y}`:""})`):y&&y>0&&(M=y,P=`Healed ${M} HP`);const A=[];M!==void 0&&A.push(P),v&&A.push("Conditions cleared"),m&&A.push("Spell slots reset"),p!==void 0&&p>0&&A.push("Time passed"),o(A.join("  ")),t({healAmount:M,clearConditions:v,resetSpellSlots:m,passTimeSeconds:p}),setTimeout(()=>{s(!1)},300),setTimeout(()=>{o(null)},3e3)},j=()=>{if(!C)return;if(d&&(!b||b<=0)){c(!0);return}const p=d&&b>0?cu(b,k):void 0;x(p)},E=()=>{const p=cu(l,h);c(!1),x(p)},N=()=>{u(1),g("hours"),c(!1)};return r.jsxs("div",{className:"flex flex-col gap-1 w-full h-full items-center justify-center p-1",children:[r.jsx("button",{onClick:j,onMouseDown:p=>p.stopPropagation(),disabled:!C,className:`w-full h-full min-w-0 px-2 py-1 font-bold text-xs border-[length:var(--border-width)] border-theme-border rounded-button shadow-theme transition-all font-body truncate ${C?"bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper active:translate-x-[2px] active:translate-y-[2px] active:shadow-none cursor-pointer":"bg-theme-muted text-theme-paper opacity-50 cursor-not-allowed"} ${a?"scale-95":""}`,children:f}),n&&r.jsx("div",{className:"absolute -bottom-5 left-0 right-0 text-[10px] text-theme-accent font-bold text-center font-body animate-pulse whitespace-nowrap",children:n}),i&&r.jsx(M0,{title:"Pass Time",onClose:N,children:r.jsxs("div",{className:"space-y-3",children:[r.jsx("p",{className:"text-theme-muted text-sm",children:"How much time passes?"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"number",min:"1",className:"w-20 border border-theme-border focus:border-theme-accent focus:outline-none py-2 px-3 bg-theme-paper text-theme-ink font-body rounded-button text-center",value:l,onChange:p=>u(p.target.value===""?"":parseInt(p.target.value)||1),onBlur:p=>u(Math.max(1,parseInt(p.target.value)||1)),autoFocus:!0,onKeyDown:p=>{p.key==="Enter"&&E(),p.key==="Escape"&&N()}}),r.jsxs("select",{className:"flex-1 border border-theme-border focus:border-theme-accent focus:outline-none py-2 px-3 bg-theme-paper text-theme-ink font-body rounded-button",value:h,onChange:p=>g(p.target.value),children:[r.jsx("option",{value:"seconds",children:"Seconds"}),r.jsx("option",{value:"minutes",children:"Minutes"}),r.jsx("option",{value:"hours",children:"Hours"}),r.jsx("option",{value:"days",children:"Days"}),r.jsx("option",{value:"months",children:"Months"}),r.jsx("option",{value:"years",children:"Years"})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsx("button",{onClick:E,className:"flex-1 py-2 px-4 bg-theme-accent text-theme-paper rounded-button hover:opacity-90 transition-colors font-bold",children:"Confirm"}),r.jsx("button",{onClick:N,className:"flex-1 py-2 px-4 border border-theme-border text-theme-muted rounded-button hover:bg-theme-border hover:text-theme-ink transition-colors",children:"Cancel"})]})]})})]})}function D0({title:e,onConfirm:t,onCancel:n,buttonLabel:o,currentValue:a,maxValue:s}){const[i,c]=T.useState(a),l=()=>{const u=typeof i=="string"?parseInt(i)||0:i;t(Math.max(0,Math.min(s,u)))};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:n}),r.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-button p-4 z-50 min-w-[200px]",children:[r.jsx("h3",{className:"font-heading text-theme-ink font-bold mb-3",children:e}),r.jsx("input",{type:"number",min:"0",max:s,className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent mb-3 text-center font-bold text-lg",value:i,onChange:u=>c(u.target.value===""?"":parseInt(u.target.value)||0),onBlur:u=>c(Math.max(0,Math.min(s,parseInt(u.target.value)||0))),autoFocus:!0,onKeyDown:u=>{u.key==="Enter"&&l(),u.key==="Escape"&&n()}}),r.jsxs("p",{className:"text-xs text-theme-muted mb-3 text-center",children:["Max: ",s]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:n,className:"flex-1 px-3 py-1.5 text-sm font-body text-theme-ink hover:bg-theme-accent/20 rounded-button transition-colors border border-theme-border",children:"Cancel"}),r.jsx("button",{onClick:l,className:"flex-1 px-3 py-1.5 text-sm font-body rounded-button transition-colors bg-theme-accent text-theme-paper hover:opacity-80",children:o})]})]})]})}function Tc({widget:e}){const t=q(v=>v.updateWidgetData),{label:n,currentValue:o=0,maxValue:a=100,showPercentage:s=!0,showValues:i=!0}=e.data,[c,l]=T.useState(!1),u=a>0?Math.max(0,Math.min(100,o/a*100)):0,h="text-xs",g="text-xs",f="gap-1",w="h-4",S=v=>{t(e.id,{currentValue:Math.max(0,Math.min(a,v))}),l(!1)},y=()=>i&&s?`${o} / ${a} (${Math.round(u)}%)`:i?`${o} / ${a}`:s?`${Math.round(u)}%`:"";return r.jsxs("div",{className:`flex flex-col ${f} w-full h-full justify-between`,children:[n&&r.jsx("div",{className:`font-bold ${h} text-theme-ink font-heading flex-shrink-0`,children:n}),r.jsx("div",{className:"flex-1 flex flex-col justify-start",children:r.jsxs("div",{className:`relative ${w} bg-theme-muted/30 rounded-button overflow-hidden border border-theme-border cursor-pointer`,onClick:()=>l(!0),onMouseDown:v=>v.stopPropagation(),title:"Click to set value",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 bg-theme-accent transition-all duration-300 ease-out",style:{width:`${u}%`}}),(i||s)&&r.jsx("div",{className:`absolute inset-0 flex items-center justify-center font-bold ${g} text-theme-ink font-body`,style:{textShadow:"0 0 3px var(--color-paper), 0 0 3px var(--color-paper), 0 0 3px var(--color-paper)"},children:y()})]})}),c&&r.jsx(D0,{title:"Set Progress",onConfirm:S,onCancel:()=>l(!1),buttonLabel:"Set",currentValue:o,maxValue:a})]})}function qt(e,t){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}function du(e,t,n,o){const a=Math.atan2(n.y-t.y,n.x-t.x),s=o/2,i=Math.cos(a+Math.PI/2)*s,c=Math.sin(a+Math.PI/2)*s;e.beginPath(),e.moveTo(t.x+i,t.y+c),e.lineTo(n.x+i,n.y+c),e.lineTo(n.x-i,n.y-c),e.lineTo(t.x-i,t.y-c),e.closePath()}function L0(e){return e.length<2?{start:e[0]||{x:0,y:0},end:e[0]||{x:0,y:0}}:{start:e[0],end:e[e.length-1]}}function di(e){const t=e.map(c=>c.x),n=e.map(c=>c.y),o=Math.min(...t),a=Math.min(...n),s=Math.max(...t),i=Math.max(...n);return{x:o,y:a,width:s-o,height:i-a}}function yf(e,t,n){const o=qt(t,n);if(o===0)return qt(e,t);const a=n.x-t.x,s=n.y-t.y;return Math.abs((e.x-t.x)*s-(e.y-t.y)*a)/o}function $0(e,t,n){const o=qt(t,n);if(o===0)return qt(e,t);const a=n.x-t.x,s=n.y-t.y;let i=((e.x-t.x)*a+(e.y-t.y)*s)/(o*o);i=Math.max(0,Math.min(1,i));const c=t.x+i*a,l=t.y+i*s;return qt(e,{x:c,y:l})}function A0(e){if(e.length<2)return!1;const t=e[0],n=e[e.length-1],o=qt(t,n);if(o<20)return!0;let a=0;for(const c of e)a+=yf(c,t,n);const s=a/e.length;return o<50?s<20:o/Math.max(s,1)>2}function _0(e){if(e.length<10)return"free";const t=di(e),n=qt(e[0],e[e.length-1]),o=e.reduce((w,S,y)=>y===0?0:w+qt(e[y-1],S),0);if(!(n<o*.15))return A0(e)?"corridor":"free";const s=t.width/2,i=t.height/2,c=t.x+s,l=t.y+i;let u=0,h=0;for(const w of e){const S=(w.x-c)**2/s**2+(w.y-l)**2/i**2;u+=Math.abs(S-1);const y=Math.abs(w.x-t.x),v=Math.abs(w.x-(t.x+t.width)),m=Math.abs(w.y-t.y),d=Math.abs(w.y-(t.y+t.height)),b=Math.min(y,v,m,d);h+=b}u/=e.length,h/=e.length;const g=(t.width+t.height)/2;h/=g;let f=0;for(let w=2;w<e.length;w++){const S=e[w-2],y=e[w-1],v=e[w],m=Math.atan2(y.y-S.y,y.x-S.x),d=Math.atan2(v.y-y.y,v.x-y.x);let b=Math.abs(d-m);b>Math.PI&&(b=2*Math.PI-b),b>Math.PI/4&&f++}return f>=3&&f<=8?"rectangle":u<.5?"ellipse":h<.1?"rectangle":u<h*2?"ellipse":"rectangle"}function Ec({widget:e,mode:t,width:n,height:o}){const{label:a,mapShapes:s=[],strokeColor:i="#333333",strokeWidth:c=2,gridEnabled:l=!0,gridSize:u=20,corridorWidth:h=10}=e.data,g=q(Q=>Q.updateWidgetData),[f,w]=T.useState(s),[S,y]=T.useState("auto"),[v,m]=T.useState(!1),[d,b]=T.useState([]),[k,C]=T.useState(null),x=T.useRef(null),j=T.useRef(null),[E,N]=T.useState({x:0,y:0}),[p,M]=T.useState(1),[P,A]=T.useState(!1),[_,O]=T.useState([]),[V,z]=T.useState(!1),[I,L]=T.useState([]),Y=[{tool:"auto",icon:r.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M12 2v4M12 18v4M2 12h4M18 12h4M5.6 5.6l2.8 2.8M15.6 15.6l2.8 2.8M5.6 18.4l2.8-2.8M15.6 8.4l2.8-2.8"})}),label:"Auto Detect"},{tool:"free",icon:r.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"})}),label:"Free Draw"},{tool:"rectangle",icon:r.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})}),label:"Rectangle"},{tool:"ellipse",icon:r.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("ellipse",{cx:"12",cy:"12",rx:"10",ry:"8"})}),label:"Ellipse"},{tool:"corridor",icon:r.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M4 9h16v6H4z"})}),label:"Corridor"},{tool:"eraser",icon:r.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21"}),r.jsx("path",{d:"M22 21H7"}),r.jsx("path",{d:"m5 11 9 9"})]}),label:"Eraser"},{tool:"clearAll",icon:r.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),r.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),label:"Clear All"}],J=50,$=()=>N(Q=>({...Q,x:Q.x+J})),F=()=>N(Q=>({...Q,x:Q.x-J})),X=()=>N(Q=>({...Q,y:Q.y+J})),oe=()=>N(Q=>({...Q,y:Q.y-J})),H=()=>M(Q=>Math.min(Q*1.25,4)),he=()=>M(Q=>Math.max(Q/1.25,.25)),je=()=>{N({x:0,y:0}),M(1)};T.useEffect(()=>{g(e.id,{mapShapes:f})},[f]);const $e=T.useCallback(()=>{const Q=x.current;if(!Q)return;const K=Q.getContext("2d");if(K){if(K.clearRect(0,0,Q.width,Q.height),K.save(),K.translate(E.x,E.y),K.scale(p,p),l){K.strokeStyle="#ddd",K.lineWidth=.5/p;const Z=Math.floor(-E.x/p/u)*u,W=Math.floor(-E.y/p/u)*u,B=Z+Q.width/p+u*2,re=W+Q.height/p+u*2;for(let te=Z;te<=B;te+=u)K.beginPath(),K.moveTo(te,W),K.lineTo(te,re),K.stroke();for(let te=W;te<=re;te+=u)K.beginPath(),K.moveTo(Z,te),K.lineTo(B,te),K.stroke()}for(const Z of f)if(K.strokeStyle=Z.color,K.lineWidth=Z.strokeWidth,K.fillStyle=Z.color+"20",K.lineCap="round",K.lineJoin="round",Z.type==="free"&&Z.points.length>0){K.beginPath(),K.moveTo(Z.points[0].x,Z.points[0].y);for(let W=1;W<Z.points.length;W++)K.lineTo(Z.points[W].x,Z.points[W].y);K.stroke()}else Z.type==="rectangle"&&Z.bounds?(K.beginPath(),K.rect(Z.bounds.x,Z.bounds.y,Z.bounds.width,Z.bounds.height),K.fill(),K.stroke()):Z.type==="ellipse"&&Z.bounds?(K.beginPath(),K.ellipse(Z.bounds.x+Z.bounds.width/2,Z.bounds.y+Z.bounds.height/2,Z.bounds.width/2,Z.bounds.height/2,0,0,Math.PI*2),K.fill(),K.stroke()):Z.type==="corridor"&&Z.corridorStart&&Z.corridorEnd&&(du(K,Z.corridorStart,Z.corridorEnd,Z.corridorWidth||20),K.fill(),K.stroke());if(v&&d.length>0){if(K.strokeStyle=i,K.lineWidth=c,K.lineCap="round",K.lineJoin="round",S==="free"||S==="auto"){K.beginPath(),K.moveTo(d[0].x,d[0].y);for(let Z=1;Z<d.length;Z++)K.lineTo(d[Z].x,d[Z].y);K.stroke()}else if(S==="rectangle"&&k&&d.length>0){const Z=d[d.length-1],W=Math.min(k.x,Z.x),B=Math.min(k.y,Z.y),re=Math.abs(Z.x-k.x),te=Math.abs(Z.y-k.y);K.fillStyle=i+"20",K.beginPath(),K.rect(W,B,re,te),K.fill(),K.stroke()}else if(S==="ellipse"&&k&&d.length>0){const Z=d[d.length-1],W=Math.min(k.x,Z.x),B=Math.min(k.y,Z.y),re=Math.abs(Z.x-k.x),te=Math.abs(Z.y-k.y);K.fillStyle=i+"20",K.beginPath(),K.ellipse(W+re/2,B+te/2,re/2,te/2,0,0,Math.PI*2),K.fill(),K.stroke()}else if(S==="corridor"&&k&&d.length>0){const Z=d[d.length-1];K.fillStyle=i+"20",du(K,k,Z,h),K.fill(),K.stroke()}}K.restore()}},[f,d,v,S,i,c,l,u,k,h,E,p]);T.useEffect(()=>{$e()},[$e]),T.useEffect(()=>{const Q=x.current,K=j.current;if(Q&&K){const Z=t==="print"?0:32,W=a?20:0,B=K.clientWidth,re=Math.max(B-8,100),te=Math.max(o-Z-W-12,100);Q.width=re,Q.height=te,Q.style.width=`${re}px`,Q.style.height=`${te}px`,$e()}},[n,o,a,$e,t]);const Se=Q=>{const K=x.current;if(!K)return{x:0,y:0};const Z=K.getBoundingClientRect();let W,B;"touches"in Q?(W=Q.touches[0].clientX,B=Q.touches[0].clientY):(W=Q.clientX,B=Q.clientY);const re=K.width/Z.width,te=K.height/Z.height,fe=(W-Z.left)*re,me=(B-Z.top)*te;return{x:(fe-E.x)/p,y:(me-E.y)/p}},Qe=Q=>{const K=5/p;for(let Z=f.length-1;Z>=0;Z--){const W=f[Z];if(W.type==="free"&&W.points.length>0)for(let B=0;B<W.points.length-1;B++){const re=W.points[B],te=W.points[B+1];if($0(Q,re,te)<K+W.strokeWidth/2)return W.id}else if(W.type==="rectangle"&&W.bounds){const B=W.bounds,re=K+W.strokeWidth/2,te=Math.abs(Q.x-B.x)<re&&Q.y>=B.y&&Q.y<=B.y+B.height,fe=Math.abs(Q.x-(B.x+B.width))<re&&Q.y>=B.y&&Q.y<=B.y+B.height,me=Math.abs(Q.y-B.y)<re&&Q.x>=B.x&&Q.x<=B.x+B.width,be=Math.abs(Q.y-(B.y+B.height))<re&&Q.x>=B.x&&Q.x<=B.x+B.width;if(te||fe||me||be)return W.id}else if(W.type==="ellipse"&&W.bounds){const B=W.bounds,re=B.x+B.width/2,te=B.y+B.height/2,fe=B.width/2,me=B.height/2;if(fe>0&&me>0){const be=Math.sqrt(((Q.x-re)/fe)**2+((Q.y-te)/me)**2),Ie=(K+W.strokeWidth/2)/Math.min(fe,me);if(Math.abs(be-1)<Ie)return W.id}}else if(W.type==="corridor"&&W.corridorStart&&W.corridorEnd){const B=yf(Q,W.corridorStart,W.corridorEnd),re=(W.corridorWidth||20)/2;if(B<re+K){const te=qt(W.corridorStart,W.corridorEnd),fe=qt(Q,W.corridorStart),me=qt(Q,W.corridorEnd);if(fe<=te+K&&me<=te+K)return W.id}}}return null},Ae=Q=>{if(t==="edit")return;if(Q.stopPropagation(),S==="clearAll"){f.length>0&&A(!0);return}if(S==="eraser"){z(!0),L([]);const Z=Se(Q),W=Qe(Z);if(W){const B=f.find(re=>re.id===W);B&&(L([B]),w(re=>re.filter(te=>te.id!==W)))}return}const K=Se(Q);m(!0),C(K),b([K])},G=Q=>{if(Q.stopPropagation(),V&&S==="eraser"){const Z=Se(Q),W=Qe(Z);if(W){const B=f.find(re=>re.id===W);B&&(L(re=>[...re,B]),w(re=>re.filter(te=>te.id!==W)))}return}if(!v)return;const K=Se(Q);b(Z=>[...Z,K])},ae=Q=>{if(Q.stopPropagation(),V){z(!1),I.length>0&&O(W=>[...W,{type:"erase",shapes:I}]),L([]);return}if(!v)return;if(m(!1),d.length<2){b([]),C(null);return}let K;const Z=`shape-${Date.now()}`;if(S==="free")K={id:Z,type:"free",points:d,color:i,strokeWidth:c};else if(S==="auto"){const W=_0(d);if(W==="free")K={id:Z,type:"free",points:d,color:i,strokeWidth:c};else if(W==="corridor"){const{start:B,end:re}=L0(d);K={id:Z,type:"corridor",points:[],corridorStart:B,corridorEnd:re,corridorWidth:h,color:i,strokeWidth:c}}else{const B=di(d);K={id:Z,type:W,points:[],bounds:B,color:i,strokeWidth:c}}}else if(S==="corridor"){const W=d[d.length-1];K={id:Z,type:"corridor",points:[],corridorStart:k,corridorEnd:W,corridorWidth:h,color:i,strokeWidth:c}}else{const W=k&&d.length>0?{x:Math.min(k.x,d[d.length-1].x),y:Math.min(k.y,d[d.length-1].y),width:Math.abs(d[d.length-1].x-k.x),height:Math.abs(d[d.length-1].y-k.y)}:di(d);K={id:Z,type:S,points:[],bounds:W,color:i,strokeWidth:c}}w(W=>[...W,K]),O(W=>[...W,{type:"add",shapes:[K]}]),b([]),C(null)},de=Q=>{Q==="clearAll"?f.length>0&&A(!0):y(Q)},ce=()=>{O(Q=>[...Q,{type:"erase",shapes:f}]),w([]),A(!1)},Ne=()=>{A(!1)},Te=()=>{if(_.length>0){const Q=_[_.length-1];Q.type==="erase"?w(K=>[...K,...Q.shapes]):w(K=>K.filter(Z=>!Q.shapes.some(W=>W.id===Z.id))),O(K=>K.slice(0,-1))}};return r.jsxs("div",{ref:j,className:"flex flex-col w-full h-full gap-1 relative",children:[a&&r.jsx("div",{className:"font-bold text-center text-xs text-theme-ink font-heading flex-shrink-0",children:a}),P&&r.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-50 rounded-button",children:r.jsxs("div",{className:"bg-theme-paper border border-theme-border rounded-button p-4 shadow-lg max-w-xs text-center",children:[r.jsx("p",{className:"text-theme-ink text-sm mb-3",children:"Clear all shapes?"}),r.jsxs("div",{className:"flex gap-2 justify-center",children:[r.jsx("button",{onClick:ce,onMouseDown:Q=>Q.stopPropagation(),className:"px-3 py-1 text-xs border border-theme-border rounded-button bg-red-500 text-white hover:bg-red-600",children:"Clear"}),r.jsx("button",{onClick:Ne,onMouseDown:Q=>Q.stopPropagation(),className:"px-3 py-1 text-xs border border-theme-border rounded-button bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper",children:"Cancel"})]})]})}),t!=="print"&&r.jsxs("div",{className:"flex gap-1 justify-center flex-wrap flex-shrink-0 px-1",children:[Y.map(({tool:Q,icon:K,label:Z})=>r.jsx("button",{onClick:()=>de(Q),onMouseDown:W=>W.stopPropagation(),className:`p-1 text-xs border border-theme-border rounded-button transition-all ${S===Q&&Q!=="clearAll"?"bg-theme-accent text-theme-paper":"bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,title:Z,children:K},Q)),_.length>0&&r.jsx("button",{onClick:Te,onMouseDown:Q=>Q.stopPropagation(),className:"p-1 text-xs border border-theme-border rounded-button bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper",title:"Undo",children:r.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 7v6h6"}),r.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})})]}),r.jsxs("div",{className:"flex-1 border border-theme-border rounded-theme overflow-hidden bg-white mx-1 mb-1 relative",children:[r.jsx("canvas",{ref:x,onMouseDown:Ae,onMouseMove:G,onMouseUp:ae,onMouseLeave:ae,onTouchStart:Ae,onTouchMove:G,onTouchEnd:ae,className:"touch-none cursor-crosshair",style:{display:"block"}}),t!=="print"&&r.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-1 items-end",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-0.5",children:[r.jsx("div",{}),r.jsx("button",{onClick:X,onMouseDown:Q=>Q.stopPropagation(),className:"p-1 text-xs border border-theme-border rounded-button bg-theme-paper/90 text-theme-ink hover:bg-theme-accent hover:text-theme-paper",title:"Pan Up",children:""}),r.jsx("div",{}),r.jsx("button",{onClick:$,onMouseDown:Q=>Q.stopPropagation(),className:"p-1 text-xs border border-theme-border rounded-button bg-theme-paper/90 text-theme-ink hover:bg-theme-accent hover:text-theme-paper",title:"Pan Left",children:""}),r.jsx("button",{onClick:je,onMouseDown:Q=>Q.stopPropagation(),className:"p-1 text-xs border border-theme-border rounded-button bg-theme-paper/90 text-theme-ink hover:bg-theme-accent hover:text-theme-paper",title:"Reset View",children:""}),r.jsx("button",{onClick:F,onMouseDown:Q=>Q.stopPropagation(),className:"p-1 text-xs border border-theme-border rounded-button bg-theme-paper/90 text-theme-ink hover:bg-theme-accent hover:text-theme-paper",title:"Pan Right",children:""}),r.jsx("div",{}),r.jsx("button",{onClick:oe,onMouseDown:Q=>Q.stopPropagation(),className:"p-1 text-xs border border-theme-border rounded-button bg-theme-paper/90 text-theme-ink hover:bg-theme-accent hover:text-theme-paper",title:"Pan Down",children:""}),r.jsx("div",{})]}),r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsx("button",{onClick:H,onMouseDown:Q=>Q.stopPropagation(),className:"p-1 text-xs border border-theme-border rounded-button bg-theme-paper/90 text-theme-ink hover:bg-theme-accent hover:text-theme-paper",title:"Zoom In",children:"+"}),r.jsx("button",{onClick:he,onMouseDown:Q=>Q.stopPropagation(),className:"p-1 text-xs border border-theme-border rounded-button bg-theme-paper/90 text-theme-ink hover:bg-theme-accent hover:text-theme-paper",title:"Zoom Out",children:""})]})]})]})]})}function Ic({widget:e,height:t}){const n=q(N=>N.updateWidgetData),{label:o,rollTableItems:a=[{text:"",weight:1}],showRollTableItems:s=!0}=e.data,[i,c]=T.useState(null),[l,u]=T.useState(!1),h="text-xs",g="text-xs py-0.5",f="py-1 px-2 text-xs",w="gap-1",S=16,y=32,v=i?28:0,b=Math.max(40,t-S-y-v-8*3-0*2),k=a.length>0?a:[{text:"",weight:1}],C=(N,p,M)=>{const P=[...k];P[N]={...P[N],text:M},n(e.id,{rollTableItems:P})},x=()=>{const N=k.filter(p=>p.text.trim()&&p.weight>0);if(N.length===0){c("No valid items to roll!");return}u(!0),setTimeout(()=>{const p=N.reduce((_,O)=>_+O.weight,0),M=Math.random()*p;let P=0,A=N[0];for(const _ of N)if(P+=_.weight,M<P){A=_;break}c(A.text),u(!1)},300)},j=()=>k.reduce((N,p)=>N+(p.weight||0),0),E=N=>{const p=j();return p===0?0:Math.round(N/p*100)};return r.jsxs("div",{className:`flex flex-col ${w} w-full h-full`,children:[o&&r.jsx("div",{className:`font-bold ${h} text-theme-ink font-heading flex-shrink-0`,children:o}),r.jsx("button",{onClick:x,onMouseDown:N=>N.stopPropagation(),className:`${f} border border-theme-border font-bold transition-all rounded-button flex-shrink-0 font-body ${l?"bg-theme-muted animate-pulse text-theme-paper":"bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,disabled:l,children:"Roll Table"}),i&&r.jsx("div",{className:"text-center bg-theme-accent/10 border border-theme-accent/30 rounded-button py-1 px-2 flex-shrink-0",children:r.jsx("span",{className:"font-bold text-sm text-theme-ink font-heading",children:i})}),s&&r.jsx("div",{className:"space-y-1 overflow-y-auto flex-1",style:{maxHeight:`${b}px`},onWheel:N=>{const p=N.currentTarget;p.scrollHeight>p.clientHeight&&N.stopPropagation()},children:k.map((N,p)=>r.jsxs("div",{className:"flex items-center gap-1 group",children:[r.jsx("input",{className:`flex-1 border-b border-theme-border/50 focus:border-theme-border focus:outline-none ${g} min-w-0 bg-transparent text-theme-ink font-body`,value:N.text,onChange:M=>C(p,"text",M.target.value),placeholder:"Item text...",onMouseDown:M=>M.stopPropagation()}),r.jsxs("span",{className:"text-[10px] text-theme-muted w-8 text-right",title:"Probability",children:[E(N.weight),"%"]})]},p))})]})}function uu(){return Math.random().toString(36).substr(2,9)}function O0({showRollButton:e,onClose:t,onAdd:n}){const[o,a]=T.useState(""),[s,i]=T.useState(20),[c,l]=T.useState(0),u=h=>{h.preventDefault(),o.trim()&&(n(o.trim(),s,c),t())};return er.createPortal(r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999]",onClick:t,onMouseDown:h=>h.stopPropagation(),children:r.jsxs("div",{className:"bg-theme-paper border border-theme-border rounded-button shadow-xl p-4 min-w-[280px] max-w-[400px]",onClick:h=>h.stopPropagation(),children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"font-bold text-theme-ink font-heading",children:"Add Temporary Participant"}),r.jsx("button",{onClick:t,className:"text-theme-muted hover:text-theme-ink text-xl leading-none",children:""})]}),r.jsxs("form",{onSubmit:u,className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Name"}),r.jsx("input",{type:"text",value:o,onChange:h=>a(h.target.value),className:"w-full px-2 py-1 border border-theme-border rounded bg-theme-paper text-theme-ink",autoFocus:!0})]}),e&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Dice Faces (e.g., 20 for d20)"}),r.jsx("input",{type:"number",min:1,value:s,onChange:h=>i(Math.max(1,parseInt(h.target.value)||1)),className:"w-full px-2 py-1 border border-theme-border rounded bg-theme-paper text-theme-ink"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Flat Bonus"}),r.jsx("input",{type:"number",value:c,onChange:h=>l(parseInt(h.target.value)||0),className:"w-full px-2 py-1 border border-theme-border rounded bg-theme-paper text-theme-ink"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[r.jsx("button",{type:"button",onClick:t,className:"px-3 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper font-body",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-3 py-1 text-sm bg-theme-accent text-theme-paper rounded hover:opacity-90 font-body",children:"Add"})]})]})]})}),document.body)}function Mc({widget:e}){const t=q(F=>F.updateWidgetData),o=q(F=>F.mode)==="print",a=q(F=>F.characters),s=q(F=>F.activeCharacterId),{label:i,initiativePool:c=[],initiativeEncounter:l=[],initiativeShowRollButton:u=!0,initiativeCurrentIndex:h=0,initiativeAdvanceTimeTrackers:g=!1,initiativeAdvanceByRound:f=!0,initiativeAdvanceTimeAmount:w=6,initiativeAdvanceTimeUnit:S="seconds"}=e.data,[y,v]=T.useState(!1),[m,d]=T.useState(null),[b,k]=T.useState(null),[C,x]=T.useState(!1),j=(F,X)=>{switch(X){case"seconds":return F;case"minutes":return F*60;case"hours":return F*60*60;case"days":return F*24*60*60;default:return F}},E=()=>{const F=a.find(H=>H.id===s);if(!F)return;const X=F.sheets.find(H=>H.id===F.activeSheetId);if(!X)return;const oe=X.widgets.filter(H=>H.type==="TIME_TRACKER");for(const H of oe){const he=H.data.timedEffects||[];if(he.length===0)continue;const je=H.data.roundMode===!0;let $e=0;if(je&&f&&($e=1),!je&&w>0&&($e=j(w,S)),$e>0){const Se=he.map(Qe=>({...Qe,remainingSeconds:Math.max(0,Qe.remainingSeconds-$e)}));t(H.id,{timedEffects:Se})}}},N=(F,X,oe)=>{const H={id:uu(),name:F,diceFaces:X,flatBonus:oe,isTemporary:!0};t(e.id,{initiativeEncounter:[...l,H]})},p=F=>{const X=l.filter(he=>he.id!==F);let oe=h;const H=l.findIndex(he=>he.id===F);H!==-1&&H<=h&&h>0&&(oe=Math.max(0,h-1)),X.length===0?oe=0:oe>=X.length&&(oe=X.length-1),t(e.id,{initiativeEncounter:X,initiativeCurrentIndex:oe})},M=T.useCallback(()=>{x(!0),setTimeout(()=>{const X=[...l.map(oe=>{const H=Math.floor(Math.random()*oe.diceFaces)+1;return{...oe,rollResult:H+oe.flatBonus}})].sort((oe,H)=>(H.rollResult??0)!==(oe.rollResult??0)?(H.rollResult??0)-(oe.rollResult??0):H.flatBonus!==oe.flatBonus?H.flatBonus-oe.flatBonus:Math.random()-.5);t(e.id,{initiativeEncounter:X,initiativeCurrentIndex:0}),x(!1)},300)},[l,e.id,t]),P=()=>{if(l.length===0)return;const F=(h+1)%l.length;F===0&&g&&E(),t(e.id,{initiativeCurrentIndex:F})},A=()=>{if(l.length===0)return;const F=h===0?l.length-1:h-1;t(e.id,{initiativeCurrentIndex:F})},_=()=>{const F=c.map(X=>({id:uu(),name:X.name,diceFaces:X.diceFaces,flatBonus:X.flatBonus,isTemporary:!1}));t(e.id,{initiativeEncounter:F,initiativeCurrentIndex:0})},O=(F,X)=>{F.stopPropagation(),d(X),F.dataTransfer.effectAllowed="move",F.dataTransfer.setData("text/plain",X.toString())},V=(F,X)=>{F.preventDefault(),F.stopPropagation(),F.dataTransfer.dropEffect="move",k(X)},z=F=>{F.stopPropagation(),k(null)},I=(F,X)=>{F.preventDefault(),F.stopPropagation();const oe=m??parseInt(F.dataTransfer.getData("text/plain"),10);if(isNaN(oe)||oe===X){d(null),k(null);return}const H=[...l],[he]=H.splice(oe,1);H.splice(X,0,he);let je=h;oe===h?je=X:oe<h&&X>=h?je=h-1:oe>h&&X<=h&&(je=h+1),t(e.id,{initiativeEncounter:H,initiativeCurrentIndex:je}),d(null),k(null)},L=()=>{d(null),k(null)},Y="text-xs",J="text-xs",$="text-xs px-2 py-1";return o?r.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[i&&r.jsx("div",{className:`font-bold text-theme-ink mb-1 ${Y} font-heading truncate`,children:i}),r.jsx("div",{className:"flex-1 overflow-hidden",children:l.length===0?r.jsx("div",{className:`text-theme-muted italic ${J}`,children:"No participants"}):r.jsx("div",{className:"space-y-0.5",children:l.map((F,X)=>r.jsxs("div",{className:`flex items-center gap-2 px-1 py-0.5 rounded ${X===h?"bg-theme-accent/20 font-bold":""}`,children:[r.jsxs("span",{className:`${J} text-theme-muted w-4 font-body`,children:[X+1,"."]}),r.jsx("span",{className:`${J} text-theme-ink flex-1 truncate font-body`,children:F.name}),F.rollResult!==void 0&&r.jsx("span",{className:`${J} text-theme-accent font-mono font-body`,children:F.rollResult})]},F.id))})})]}):r.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[i&&r.jsx("div",{className:`font-bold text-theme-ink mb-1 ${Y} font-heading truncate`,children:i}),r.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[r.jsx("button",{onClick:_,className:`${$} border border-theme-border text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-body`,children:"Reset"}),r.jsx("button",{onClick:()=>v(!0),className:`${$} border border-theme-border text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-body`,children:"Add"}),u&&l.length>0&&r.jsx("button",{onClick:M,disabled:C,className:`${$} border border-theme-border text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-body ${C?"opacity-50 cursor-not-allowed":""}`,children:C?"...":"Roll"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:l.length===0?r.jsx("div",{className:`text-theme-muted italic ${J} text-center py-2`,children:"Add participants to start"}):r.jsx("div",{className:"space-y-0.5",children:l.map((F,X)=>r.jsxs("div",{draggable:!0,onDragStart:oe=>O(oe,X),onDragOver:oe=>V(oe,X),onDragLeave:oe=>z(oe),onDrop:oe=>I(oe,X),onDragEnd:L,className:`flex items-center gap-1 px-1 py-0.5 rounded transition-colors ${X===h?"bg-theme-accent text-theme-paper":"bg-theme-background text-theme-ink hover:bg-theme-border/30"} ${b===X?"ring-2 ring-theme-accent":""} ${m===X?"opacity-50":""}`,children:[r.jsx("span",{className:`${J} cursor-grab active:cursor-grabbing select-none px-0.5 ${X===h?"text-theme-paper/70":"text-theme-muted"}`,children:""}),r.jsx("span",{className:`${J} flex-1 truncate font-body ${F.isTemporary?"italic":""}`,children:F.name}),F.rollResult!==void 0&&r.jsx("span",{className:`${J} font-mono font-bold min-w-[24px] text-center font-body`,children:F.rollResult}),r.jsx("button",{onClick:oe=>{oe.stopPropagation(),p(F.id)},className:`${J} hover:text-red-500 transition-colors px-1 font-body`,children:""})]},F.id))})}),l.length>0&&r.jsxs("div",{className:"flex gap-1 mt-1",children:[r.jsx("button",{onClick:A,className:`${$} flex-1 border border-theme-border text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-body`,children:" Back"}),r.jsx("button",{onClick:P,className:`${$} flex-1 border border-theme-border text-theme-ink rounded-button hover:bg-theme-accent hover:text-theme-paper transition-colors font-body`,children:"Next "})]}),y&&r.jsx(O0,{showRollButton:u,onClose:()=>v(!1),onAdd:N})]})}function hu({title:e,cards:t,onClose:n,showCounts:o=!1,onReturnCard:a}){const s={};t.forEach(c=>{s[c]=(s[c]||0)+1});const i=Object.entries(s).sort((c,l)=>c[0].localeCompare(l[0]));return er.createPortal(r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:n,onMouseDown:c=>c.stopPropagation(),children:r.jsxs("div",{className:"bg-theme-paper border-2 border-theme-border rounded-button p-4 max-w-sm w-full max-h-[60vh] flex flex-col shadow-xl",onClick:c=>c.stopPropagation(),children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("h3",{className:"font-bold text-theme-ink font-heading",children:e}),r.jsx("button",{onClick:n,className:"text-theme-muted hover:text-theme-ink transition-colors text-xl leading-none",children:""})]}),t.length===0?r.jsx("p",{className:"text-theme-muted text-sm italic",children:"No cards"}):r.jsx("div",{className:"overflow-y-auto flex-1 space-y-1",children:o?i.map(([c,l],u)=>r.jsxs("div",{className:"flex justify-between items-center text-sm text-theme-ink py-0.5 border-b border-theme-border/30",children:[r.jsx("span",{children:c}),r.jsxs("span",{className:"text-theme-muted",children:["",l]})]},u)):t.map((c,l)=>r.jsxs("div",{className:"flex justify-between items-center text-sm text-theme-ink py-0.5 border-b border-theme-border/30",children:[r.jsxs("span",{children:[l+1,". ",c]}),a&&r.jsx("button",{onClick:()=>a(l),className:"text-xs px-1.5 py-0.5 text-theme-muted hover:text-theme-ink hover:bg-theme-accent/20 rounded transition-colors",title:"Return to draw pile",children:""})]},l))}),r.jsxs("div",{className:"mt-3 text-xs text-theme-muted text-center",children:["Total: ",t.length," card",t.length!==1?"s":""]})]})}),document.body)}function Pc({widget:e,mode:t}){const n=q(p=>p.updateWidgetData),{label:o,deckCards:a=[{name:"",amount:1}],deckState:s=null}=e.data,[i,c]=T.useState(null),[l,u]=T.useState(!1),[h,g]=T.useState(!1),[f,w]=T.useState(!1),S="text-xs",y="py-1 px-2 text-xs",v="gap-1",m=a.length>0?a:[{name:"",amount:1}],d=()=>{const p=[];return m.forEach(M=>{if(M.name.trim()&&M.amount>0)for(let P=0;P<M.amount;P++)p.push(M.name)}),{remaining:p,discarded:[]}},b=()=>s||d(),k=()=>{const p=b();if(p.remaining.length===0){c("Deck is empty!");return}u(!0),setTimeout(()=>{const M=Math.floor(Math.random()*p.remaining.length),P=p.remaining[M],A=[...p.remaining];A.splice(M,1);const _=[...p.discarded,P];n(e.id,{deckState:{remaining:A,discarded:_}}),c(P),u(!1)},300)},C=()=>{n(e.id,{deckState:null}),c(null)},x=p=>{const M=b(),P=M.discarded[p],A=[...M.discarded];A.splice(p,1);const _=[...M.remaining,P];n(e.id,{deckState:{remaining:_,discarded:A}})},j=()=>b().remaining.length,E=()=>m.reduce((p,M)=>p+(M.name.trim()?M.amount:0),0),N=b();return r.jsxs("div",{className:`flex flex-col ${v} w-full h-full`,children:[o&&r.jsx("div",{className:`font-bold ${S} text-theme-ink font-heading flex-shrink-0`,children:o}),r.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[r.jsxs("button",{onClick:k,onMouseDown:p=>p.stopPropagation(),className:`flex-1 ${y} border border-theme-border font-bold transition-all rounded-button font-body ${l?"bg-theme-muted animate-pulse text-theme-paper":j()===0?"bg-theme-muted/50 text-theme-muted cursor-not-allowed":"bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,disabled:l||j()===0,children:["Draw (",j(),"/",E(),")"]}),t==="play"&&N.discarded.length>0&&r.jsx("button",{onClick:C,onMouseDown:p=>p.stopPropagation(),className:`${y} border border-theme-border font-bold transition-all rounded-button bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper font-body`,title:"Reset deck",children:""})]}),i&&r.jsx("div",{className:"text-center bg-theme-accent/10 border border-theme-accent/30 rounded-button py-1 px-2 flex-shrink-0",children:r.jsx("span",{className:"font-bold text-sm text-theme-ink font-heading",children:i})}),r.jsxs("div",{className:"flex gap-1 flex-shrink-0 mt-auto",children:[r.jsxs("button",{onClick:()=>g(!0),onMouseDown:p=>p.stopPropagation(),className:"flex-1 py-0.5 px-1 text-[10px] border border-theme-border rounded-button text-theme-muted hover:text-theme-ink hover:border-theme-border transition-colors bg-theme-paper/50 font-body",children:["Draw Pile (",j(),")"]}),r.jsxs("button",{onClick:()=>w(!0),onMouseDown:p=>p.stopPropagation(),className:"flex-1 py-0.5 px-1 text-[10px] border border-theme-border rounded-button text-theme-muted hover:text-theme-ink hover:border-theme-border transition-colors bg-theme-paper/50 font-body",children:["Discard (",N.discarded.length,")"]})]}),h&&r.jsx(hu,{title:"Draw Pile",cards:N.remaining,onClose:()=>g(!1),showCounts:!0}),f&&r.jsx(hu,{title:"Discard Pile",cards:N.discarded,onClose:()=>w(!1),showCounts:!1,onReturnCard:x})]})}function W0({widget:e,updateData:t}){const{label:n,numberItems:o=[]}=e.data,[a,s]=T.useState(""),[i,c]=T.useState(null),[l,u]=T.useState(null),[h,g]=T.useState(!1),f=T.useRef(0),w=T.useRef([]),S=T.useRef(null),y=_=>{_.preventDefault(),a.trim()&&(t({numberItems:[...o,{name:a.trim(),value:0}]}),s(""))},v=_=>{const O=[...o];O.splice(_,1),t({numberItems:O})},m=(_,O)=>{const V=[...o];V[_]={...V[_],name:O},t({numberItems:V})},d=(_,O)=>{const V=[...o];V[_]={...V[_],value:O},t({numberItems:V})},b=(_,O)=>{c(_),g(!0),f.current=O},k=_=>{if(i===null||!S.current)return;let O=null;if(w.current.forEach((V,z)=>{if(V&&z!==i){const I=V.getBoundingClientRect(),L=I.top+I.height/2;_<L&&(O===null||z<O)?O=z:_>=L&&_<I.bottom&&(O=z+1)}}),O===null&&_>0){const V=w.current[w.current.length-1];if(V){const z=V.getBoundingClientRect();_>z.bottom&&(O=o.length)}}u(O)},C=()=>{if(i!==null&&l!==null&&i!==l){const _=[...o],[O]=_.splice(i,1),V=l>i?l-1:l;_.splice(V,0,O),t({numberItems:_})}c(null),u(null),g(!1)},x=(_,O)=>{_.preventDefault(),_.stopPropagation(),_.target.setPointerCapture(_.pointerId),b(O,_.clientY)},j=_=>{h&&(_.preventDefault(),_.stopPropagation(),k(_.clientY))},E=_=>{h&&(_.preventDefault(),_.stopPropagation(),_.target.releasePointerCapture(_.pointerId),C())},N=(_,O)=>{c(O),_.dataTransfer.effectAllowed="move",_.dataTransfer.setData("text/plain",O.toString())},p=(_,O)=>{_.preventDefault(),_.stopPropagation(),_.dataTransfer.dropEffect="move",i!==null&&i!==O&&u(O)},M=()=>{u(null)},P=(_,O)=>{_.preventDefault(),_.stopPropagation();const V=i??parseInt(_.dataTransfer.getData("text/plain"),10);if(isNaN(V)||V===O){c(null),u(null);return}const z=[...o],[I]=z.splice(V,1),L=V<O?O-1:O;z.splice(L,0,I),t({numberItems:z}),c(null),u(null)},A=()=>{c(null),u(null)};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:_=>t({label:_.target.value}),placeholder:"Trackers"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Items"}),r.jsx("div",{ref:S,className:"space-y-2 max-h-48 overflow-y-auto",children:o.map((_,O)=>r.jsxs("div",{ref:V=>{w.current[O]=V},className:`flex items-center gap-2 rounded px-1 transition-colors ${l===O?"border-t-2 border-theme-accent":""} ${i===O?"opacity-50 bg-theme-accent/10":""}`,onDragOver:V=>p(V,O),onDragLeave:M,onDrop:V=>P(V,O),children:[r.jsx("div",{className:"cursor-grab active:cursor-grabbing text-theme-muted hover:text-theme-ink px-1 select-none touch-none",title:"Drag to reorder",draggable:!0,onDragStart:V=>N(V,O),onDragEnd:A,onPointerDown:V=>x(V,O),onPointerMove:j,onPointerUp:E,onPointerCancel:E,children:""}),r.jsx("input",{className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm",value:_.name,onChange:V=>m(O,V.target.value),placeholder:"Name"}),r.jsx("input",{type:"number",className:"w-20 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center",value:_.value,onChange:V=>d(O,parseInt(V.target.value)||0)}),r.jsx("button",{onClick:()=>v(O),className:"text-red-500 hover:text-red-700 px-2",children:""})]},O))}),r.jsxs("form",{onSubmit:y,className:"flex gap-2 mt-2",children:[r.jsx("input",{type:"text",value:a,onChange:_=>s(_.target.value),placeholder:"Add new item...",className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"}),r.jsx("button",{type:"submit",className:"px-3 py-1 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90",children:"Add"})]})]})]})}function F0({widget:e,updateData:t}){const{label:n,displayNumbers:o=[],displayLayout:a="horizontal"}=e.data,[s,i]=T.useState(""),[c,l]=T.useState(null),[u,h]=T.useState(null),[g,f]=T.useState(!1),w=T.useRef(0),S=T.useRef([]),y=T.useRef(null),v=O=>{O.preventDefault(),s.trim()&&(t({displayNumbers:[...o,{label:s.trim(),value:0}]}),i(""))},m=O=>{const V=[...o];V.splice(O,1),t({displayNumbers:V})},d=(O,V)=>{const z=[...o];z[O]={...z[O],label:V},t({displayNumbers:z})},b=(O,V)=>{const z=[...o];z[O]={...z[O],value:V},t({displayNumbers:z})},k=(O,V)=>{l(O),f(!0),w.current=V},C=O=>{if(c===null||!y.current)return;let V=null;if(S.current.forEach((z,I)=>{if(z&&I!==c){const L=z.getBoundingClientRect(),Y=L.top+L.height/2;O<Y&&(V===null||I<V)?V=I:O>=Y&&O<L.bottom&&(V=I+1)}}),V===null&&O>0){const z=S.current[S.current.length-1];if(z){const I=z.getBoundingClientRect();O>I.bottom&&(V=o.length)}}h(V)},x=()=>{if(c!==null&&u!==null&&c!==u){const O=[...o],[V]=O.splice(c,1),z=u>c?u-1:u;O.splice(z,0,V),t({displayNumbers:O})}l(null),h(null),f(!1)},j=(O,V)=>{O.preventDefault(),O.stopPropagation(),O.target.setPointerCapture(O.pointerId),k(V,O.clientY)},E=O=>{g&&(O.preventDefault(),O.stopPropagation(),C(O.clientY))},N=O=>{g&&(O.preventDefault(),O.stopPropagation(),O.target.releasePointerCapture(O.pointerId),x())},p=(O,V)=>{l(V),O.dataTransfer.effectAllowed="move",O.dataTransfer.setData("text/plain",V.toString())},M=(O,V)=>{O.preventDefault(),O.stopPropagation(),O.dataTransfer.dropEffect="move",c!==null&&c!==V&&h(V)},P=()=>{h(null)},A=(O,V)=>{O.preventDefault(),O.stopPropagation();const z=c??parseInt(O.dataTransfer.getData("text/plain"),10);if(isNaN(z)||z===V){l(null),h(null);return}const I=[...o],[L]=I.splice(z,1),Y=z<V?V-1:V;I.splice(Y,0,L),t({displayNumbers:I}),l(null),h(null)},_=()=>{l(null),h(null)};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:O=>t({label:O.target.value}),placeholder:"Stats"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Layout"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"displayLayout",value:"horizontal",checked:a==="horizontal",onChange:O=>t({displayLayout:O.target.value}),className:"w-4 h-4 text-theme-accent border-theme-border focus:ring-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Horizontal"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"displayLayout",value:"vertical",checked:a==="vertical",onChange:O=>t({displayLayout:O.target.value}),className:"w-4 h-4 text-theme-accent border-theme-border focus:ring-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Vertical"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Numbers"}),r.jsx("div",{ref:y,className:"space-y-2 max-h-48 overflow-y-auto",children:o.map((O,V)=>r.jsxs("div",{ref:z=>{S.current[V]=z},className:`flex items-center gap-2 rounded px-1 transition-colors ${u===V?"border-t-2 border-theme-accent":""} ${c===V?"opacity-50 bg-theme-accent/10":""}`,onDragOver:z=>M(z,V),onDragLeave:P,onDrop:z=>A(z,V),children:[r.jsx("div",{className:"cursor-grab active:cursor-grabbing text-theme-muted hover:text-theme-ink px-1 select-none touch-none",title:"Drag to reorder",draggable:!0,onDragStart:z=>p(z,V),onDragEnd:_,onPointerDown:z=>j(z,V),onPointerMove:E,onPointerUp:N,onPointerCancel:N,children:""}),r.jsx("input",{className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm",value:O.label,onChange:z=>d(V,z.target.value),placeholder:"Label"}),r.jsx("input",{type:"number",className:"w-20 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center",value:O.value,onChange:z=>b(V,parseInt(z.target.value)||0)}),r.jsx("button",{onClick:()=>m(V),className:"text-red-500 hover:text-red-700 px-2",children:""})]},V))}),r.jsxs("form",{onSubmit:v,className:"flex gap-2 mt-2",children:[r.jsx("input",{type:"text",value:s,onChange:O=>i(O.target.value),placeholder:"Add new number...",className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"}),r.jsx("button",{type:"submit",className:"px-3 py-1 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90",children:"Add"})]})]})]})}function B0({widget:e,updateData:t}){const{label:n,formItems:o=[]}=e.data,[a,s]=T.useState(""),i=ot(z=>z.tutorialStep),c=ot(z=>z.advanceTutorial),[l,u]=T.useState(null),[h,g]=T.useState(null),[f,w]=T.useState(!1),S=T.useRef(0),y=T.useRef([]),v=T.useRef(null),m=z=>{var I;z.preventDefault(),a.trim()&&(t({formItems:[...o,{name:a.trim(),value:""}]}),s(""),i===20&&((I=_e[20])==null?void 0:I.id)==="form-click-add"&&c())},d=z=>{const I=[...o];I.splice(z,1),t({formItems:I})},b=(z,I)=>{const L=[...o];L[z]={...L[z],name:I},t({formItems:L})},k=(z,I)=>{const L=[...o];L[z]={...L[z],value:I},t({formItems:L})},C=(z,I)=>{u(z),w(!0),S.current=I},x=z=>{if(l===null||!v.current)return;let I=null;if(y.current.forEach((L,Y)=>{if(L&&Y!==l){const J=L.getBoundingClientRect(),$=J.top+J.height/2;z<$&&(I===null||Y<I)?I=Y:z>=$&&z<J.bottom&&(I=Y+1)}}),I===null&&z>0){const L=y.current[y.current.length-1];if(L){const Y=L.getBoundingClientRect();z>Y.bottom&&(I=o.length)}}g(I)},j=()=>{if(l!==null&&h!==null&&l!==h){const z=[...o],[I]=z.splice(l,1),L=h>l?h-1:h;z.splice(L,0,I),t({formItems:z})}u(null),g(null),w(!1)},E=(z,I)=>{z.preventDefault(),z.stopPropagation(),z.target.setPointerCapture(z.pointerId),C(I,z.clientY)},N=z=>{f&&(z.preventDefault(),z.stopPropagation(),x(z.clientY))},p=z=>{f&&(z.preventDefault(),z.stopPropagation(),z.target.releasePointerCapture(z.pointerId),j())},M=(z,I)=>{u(I),z.dataTransfer.effectAllowed="move",z.dataTransfer.setData("text/plain",I.toString())},P=(z,I)=>{z.preventDefault(),z.stopPropagation(),z.dataTransfer.dropEffect="move",l!==null&&l!==I&&g(I)},A=()=>{g(null)},_=(z,I)=>{z.preventDefault(),z.stopPropagation();const L=l??parseInt(z.dataTransfer.getData("text/plain"),10);if(isNaN(L)||L===I){u(null),g(null);return}const Y=[...o],[J]=Y.splice(L,1),$=L<I?I-1:I;Y.splice($,0,J),t({formItems:Y}),u(null),g(null)},O=()=>{u(null),g(null)},V=e.data.labelWidth??33;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{"data-tutorial":"widget-label-input",className:`w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent ${i===18?"outline outline-4 outline-blue-500 outline-offset-2":""}`,value:n||"",onChange:z=>t({label:z.target.value}),placeholder:"Form Fields"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:["Label Width: ",V,"%"]}),r.jsx("input",{type:"range",min:"10",max:"70",value:V,onChange:z=>t({labelWidth:parseInt(z.target.value)}),className:"w-full accent-theme-accent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Items"}),r.jsx("div",{ref:v,className:"space-y-2 max-h-48 overflow-y-auto",children:o.map((z,I)=>r.jsxs("div",{ref:L=>{y.current[I]=L},className:`flex items-center gap-2 rounded px-1 transition-colors ${h===I?"border-t-2 border-theme-accent":""} ${l===I?"opacity-50 bg-theme-accent/10":""}`,onDragOver:L=>P(L,I),onDragLeave:A,onDrop:L=>_(L,I),children:[r.jsx("div",{className:"cursor-grab active:cursor-grabbing text-theme-muted hover:text-theme-ink px-1 select-none touch-none",title:"Drag to reorder",draggable:!0,onDragStart:L=>M(L,I),onDragEnd:O,onPointerDown:L=>E(L,I),onPointerMove:N,onPointerUp:p,onPointerCancel:p,children:""}),r.jsx("input",{className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm",value:z.name,onChange:L=>b(I,L.target.value),placeholder:"Name"}),r.jsx("input",{type:"text",className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm",value:z.value,onChange:L=>k(I,L.target.value),placeholder:"Value"}),r.jsx("button",{onClick:()=>d(I),className:"text-red-500 hover:text-red-700 px-2",children:""})]},I))}),r.jsxs("form",{onSubmit:m,className:"flex gap-2 mt-2",children:[r.jsx("input",{"data-tutorial":"form-field-input",type:"text",value:a,onChange:z=>{var I;s(z.target.value),i===19&&z.target.value.length>0&&((I=_e[19])==null?void 0:I.id)==="form-type-field"&&c()},placeholder:"Add new field...",className:`flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm ${i===19?"outline outline-4 outline-blue-500 outline-offset-2":""}`}),r.jsx("button",{"data-tutorial":"form-add-button",type:"submit",className:`px-3 py-1 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90 ${i===20?"outline outline-4 outline-blue-500 outline-offset-2":""}`,children:"Add"})]})]})]})}function z0({widget:e,updateData:t}){const{label:n,itemCount:o=5}=e.data;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:a=>t({label:a.target.value}),placeholder:"List Title"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Number of Item Slots"}),r.jsx("input",{type:"number",min:"1",max:"50",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:o,onChange:a=>t({itemCount:a.target.value===""?"":parseInt(a.target.value)||""}),onBlur:a=>t({itemCount:Math.max(1,Math.min(50,parseInt(a.target.value)||1))})}),r.jsx("p",{className:"text-xs text-theme-muted mt-1",children:"Items can be filled in during play mode"})]})]})}function H0({widget:e,updateData:t}){const{label:n}=e.data;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:o=>t({label:o.target.value}),placeholder:"Title"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsx("p",{className:"text-xs text-theme-muted",children:"Use the resize handle on the widget in edit mode to adjust the size."})]})}function U0({widget:e,updateData:t}){const{label:n,checkboxItems:o=[],checklistSettings:a}=e.data,[s,i]=T.useState(""),[c,l]=T.useState(null),[u,h]=T.useState(""),[g,f]=T.useState(null),[w,S]=T.useState(null),y=T.useRef(null),v=(a==null?void 0:a.strikethrough)!==!1,m=M=>{M.preventDefault(),s.trim()&&(t({checkboxItems:[...o,{name:s.trim(),checked:!1}]}),i(""))},d=M=>{const P=[...o];P.splice(M,1),t({checkboxItems:P}),c===M&&l(null)},b=M=>{l(M),h(o[M].name),setTimeout(()=>{var P;return(P=y.current)==null?void 0:P.focus()},0)},k=()=>{if(c!==null&&u.trim()){const M=[...o];M[c]={...M[c],name:u.trim()},t({checkboxItems:M})}l(null),h("")},C=M=>{M.key==="Enter"?k():M.key==="Escape"&&(l(null),h(""))},x=(M,P)=>{f(P),M.dataTransfer.effectAllowed="move",M.dataTransfer.setData("text/plain",P.toString()),M.currentTarget.parentElement&&M.dataTransfer.setDragImage(M.currentTarget.parentElement,0,0)},j=(M,P)=>{M.preventDefault(),M.stopPropagation(),M.dataTransfer.dropEffect="move",g!==null&&g!==P&&S(P)},E=M=>{M.preventDefault(),S(null)},N=(M,P)=>{M.preventDefault(),M.stopPropagation();const A=g??parseInt(M.dataTransfer.getData("text/plain"),10);if(isNaN(A)||A===P){f(null),S(null);return}const _=[...o],[O]=_.splice(A,1),V=A<P?P-1:P;_.splice(V,0,O),t({checkboxItems:_}),f(null),S(null)},p=()=>{f(null),S(null)};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:M=>t({label:M.target.value}),placeholder:"Checklist Title"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsx("div",{children:r.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-theme-ink mb-2",children:[r.jsx("input",{type:"checkbox",checked:v,onChange:M=>t({checklistSettings:{...a,strikethrough:M.target.checked}}),className:"rounded"}),"Strike through checked items"]})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Checkbox Items"}),r.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:o.map((M,P)=>r.jsxs("div",{className:`flex items-center gap-2 text-sm rounded px-1 transition-colors ${w===P?"border-t-2 border-theme-accent":""} ${g===P?"opacity-50":""}`,onDragOver:A=>j(A,P),onDragLeave:A=>E(A),onDrop:A=>N(A,P),children:[r.jsx("div",{className:"cursor-grab active:cursor-grabbing text-theme-muted hover:text-theme-ink px-1 select-none",title:"Drag to reorder",draggable:!0,onDragStart:A=>x(A,P),onDragEnd:p,children:""}),c===P?r.jsx("input",{ref:y,type:"text",value:u,onChange:A=>h(A.target.value),onBlur:k,onKeyDown:C,className:"flex-1 px-2 py-0.5 border border-theme-accent rounded bg-theme-paper text-theme-ink text-sm"}):r.jsx("span",{className:"flex-1 text-theme-ink cursor-pointer hover:text-theme-accent",onClick:()=>b(P),title:"Click to edit",children:M.name}),r.jsx("button",{onClick:()=>d(P),className:"text-red-500 hover:text-red-700 px-2",children:""})]},P))}),r.jsxs("form",{onSubmit:m,className:"flex gap-2 mt-2",children:[r.jsx("input",{type:"text",value:s,onChange:M=>i(M.target.value),placeholder:"Add new item...",className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"}),r.jsx("button",{type:"submit",className:"px-3 py-1 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90",children:"Add"})]})]})]})}function V0({widget:e,updateData:t}){const{label:n,maxValue:o=100,currentValue:a=0,showPercentage:s=!0,showValues:i=!0}=e.data;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:c=>t({label:c.target.value}),placeholder:"Progress"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Current Value"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:a,onChange:c=>{const l=c.target.value===""?"":parseInt(c.target.value)||0;t({currentValue:l})},onBlur:c=>{const l=parseInt(c.target.value)||0;t({currentValue:Math.max(0,Math.min(o,l))})},min:0})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Maximum Value"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:o,onChange:c=>{t({maxValue:c.target.value===""?"":parseInt(c.target.value)||""})},onBlur:c=>{const l=parseInt(c.target.value)||1;t({maxValue:Math.max(1,l)})},min:1})]})]}),r.jsxs("div",{className:"border border-theme-border rounded-button p-3",children:[r.jsx("h4",{className:"font-medium text-theme-ink mb-3",children:"Display Options"}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer mb-2",children:[r.jsx("input",{type:"checkbox",checked:i,onChange:c=>t({showValues:c.target.checked}),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Show Values (e.g., 50 / 100)"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:s,onChange:c=>t({showPercentage:c.target.checked}),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Show Percentage"})]})]})]})}function G0({widget:e,updateData:t}){const{label:n,maxValue:o=10}=e.data;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:a=>t({label:a.target.value}),placeholder:"Health"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Maximum Value"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:o,onChange:a=>{t({maxValue:a.target.value===""?"":parseInt(a.target.value)||""})},onBlur:a=>{const s=parseInt(a.target.value)||1;t({maxValue:Math.max(1,s)})},min:1})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Button Increment"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:e.data.increment??1,onChange:a=>{t({increment:a.target.value===""?"":parseInt(a.target.value)||""})},onBlur:a=>{const s=parseInt(a.target.value)||1;t({increment:Math.max(1,s)})},min:1}),r.jsx("p",{className:"text-xs text-theme-muted mt-1",children:"Amount changed by +/ buttons"})]})]})}const Y0=e=>typeof e=="object"&&"faces"in e&&Array.isArray(e.faces);function X0({widget:e,updateData:t}){const{label:n,diceGroups:o=[{count:1,faces:20}],modifier:a=0}=e.data,[s,i]=T.useState({open:!1,groupIndex:-1,faces:[],diceName:""}),[c,l]=T.useState(""),u=q(x=>x.characters),h=q(x=>x.activeCharacterId),g=T.useMemo(()=>{const x=u.find(E=>E.id===h);if(!x)return[];const j=[];for(const E of x.sheets)for(const N of E.widgets){if(N.type==="DICE_ROLLER"&&N.data.diceGroups)for(const p of N.data.diceGroups)p.customFaces&&p.customFaces.length>0&&p.customDiceName&&(j.some(M=>M.name===p.customDiceName)||j.push({name:p.customDiceName,faces:p.customFaces}));if(N.type==="DICE_TRAY"&&N.data.availableDice)for(const p of N.data.availableDice)Y0(p)&&p.name&&(j.some(M=>M.name===p.name)||j.push({name:p.name,faces:p.faces}))}return j},[u,h]),f=x=>{const j=g.find(E=>E.name===x);j&&i(E=>({...E,diceName:j.name,faces:[...j.faces]}))},w=(x,j,E)=>{const N=[...o];N[x]={...N[x],[j]:E},t({diceGroups:N})},S=x=>{const j=o[x].customFaces||[],E=o[x].customDiceName||"";i({open:!0,groupIndex:x,faces:[...j],diceName:E}),l("")},y=()=>{i({open:!1,groupIndex:-1,faces:[],diceName:""}),l("")},v=()=>{if(s.groupIndex>=0){const x=[...o];if(s.faces.length>0)x[s.groupIndex]={...x[s.groupIndex],customFaces:s.faces,customDiceName:s.diceName.trim()||void 0,faces:s.faces.length};else{const{customFaces:j,customDiceName:E,...N}=x[s.groupIndex];x[s.groupIndex]=N}t({diceGroups:x})}y()},m=()=>{c.trim()&&(i(x=>({...x,faces:[...x.faces,c.trim()]})),l(""))},d=x=>{i(j=>({...j,faces:j.faces.filter((E,N)=>N!==x)}))},b=x=>{const j=[...o],{customFaces:E,customDiceName:N,...p}=j[x];j[x]={...p,faces:6},t({diceGroups:j})},k=()=>{t({diceGroups:[...o,{count:1,faces:6}]})},C=x=>{if(o.length>1){const j=o.filter((E,N)=>N!==x);t({diceGroups:j})}};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:x=>t({label:x.target.value}),placeholder:"Roll Name"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Dice Groups"}),r.jsx("div",{className:"space-y-2",children:o.map((x,j)=>{var E,N,p,M,P;return r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",min:"1",value:x.count,onChange:A=>w(j,"count",A.target.value===""?"":parseInt(A.target.value)||""),onBlur:A=>w(j,"count",Math.max(1,parseInt(A.target.value)||1)),className:"w-16 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center"}),r.jsx("span",{className:"text-theme-ink",children:"d"}),r.jsx("input",{type:"number",min:"1",value:x.faces,onChange:A=>w(j,"faces",A.target.value===""?"":parseInt(A.target.value)||""),onBlur:A=>w(j,"faces",Math.max(1,parseInt(A.target.value)||1)),className:"w-16 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center",disabled:!!((E=x.customFaces)!=null&&E.length),title:(N=x.customFaces)!=null&&N.length?"Faces set by custom faces":""}),r.jsx("button",{onClick:()=>S(j),className:`px-2 py-1 border border-theme-border rounded-button text-xs hover:bg-theme-accent hover:text-theme-paper ${(p=x.customFaces)!=null&&p.length?"bg-theme-accent text-theme-paper":"bg-theme-paper text-theme-ink"}`,title:"Set custom faces",children:"Custom Faces"}),(M=x.customFaces)!=null&&M.length?r.jsx("button",{onClick:()=>b(j),className:"text-orange-500 hover:text-orange-700 px-1 text-xs",title:"Clear custom faces",children:""}):null,o.length>1&&r.jsx("button",{onClick:()=>C(j),className:"text-red-500 hover:text-red-700 px-2",children:""})]}),(P=x.customFaces)!=null&&P.length?r.jsxs("div",{className:"text-xs text-theme-muted ml-2 flex flex-wrap gap-1",children:[x.customDiceName&&r.jsxs("span",{className:"font-medium text-theme-ink",children:[x.customDiceName,":"]}),r.jsx("span",{className:"italic",children:"Faces:"}),x.customFaces.map((A,_)=>r.jsx("span",{className:"bg-theme-border/30 px-1 rounded",children:A},_))]}):null]},j)})}),r.jsx("button",{onClick:k,className:"mt-2 px-3 py-1 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper",children:"+ Add Dice"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Modifier"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:a,onChange:x=>t({modifier:parseInt(x.target.value)||0})})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",id:"showIndividualResults",checked:e.data.showIndividualResults||!1,onChange:x=>t({showIndividualResults:x.target.checked}),className:"w-4 h-4 border border-theme-border rounded bg-theme-paper text-theme-accent focus:ring-theme-accent"}),r.jsx("label",{htmlFor:"showIndividualResults",className:"text-sm font-medium text-theme-ink",children:"Show individual dice results (don't sum)"})]}),s.open&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:y,children:r.jsxs("div",{className:"bg-theme-paper border-2 border-theme-border rounded-lg p-4 w-96 max-h-[80vh] overflow-y-auto shadow-xl",onClick:x=>x.stopPropagation(),children:[r.jsx("h3",{className:"text-lg font-bold text-theme-ink mb-4",children:"Custom Dice Faces"}),g.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Copy from existing dice"}),r.jsxs("select",{className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm",value:"",onChange:x=>{x.target.value&&f(x.target.value)},children:[r.jsx("option",{value:"",children:"Select a custom dice to copy..."}),g.map(x=>r.jsxs("option",{value:x.name,children:[x.name," (",x.faces.length," faces)"]},x.name))]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Dice Name (optional)"}),r.jsx("input",{type:"text",value:s.diceName,onChange:x=>i(j=>({...j,diceName:x.target.value})),placeholder:"e.g., Fate Die, Doom Die, Attack Die",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"})]}),r.jsxs("p",{className:"text-sm text-theme-muted mb-4",children:["Add any values for dice faces: numbers, emojis, symbols, or text.",r.jsx("br",{}),r.jsx("span",{className:"font-medium",children:"Tip:"})," Use ",r.jsx("code",{className:"bg-theme-border/30 px-1 rounded",children:","})," to put multiple values on one face (e.g., ",r.jsx("code",{className:"bg-theme-border/30 px-1 rounded",children:",poison"})," or ",r.jsx("code",{className:"bg-theme-border/30 px-1 rounded",children:"2,"}),")"]}),r.jsxs("div",{className:"flex gap-2 mb-4",children:[r.jsx("input",{type:"text",value:c,onChange:x=>l(x.target.value),onKeyDown:x=>x.key==="Enter"&&m(),placeholder:"e.g., , poison, 5, or ,poison",className:"flex-1 px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"}),r.jsx("button",{onClick:m,className:"px-3 py-2 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90",children:"Add"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:["Current Faces (",s.faces.length,")"]}),s.faces.length===0?r.jsx("p",{className:"text-sm text-theme-muted italic",children:"No custom faces added yet"}):r.jsx("div",{className:"flex flex-wrap gap-2",children:s.faces.map((x,j)=>r.jsxs("div",{className:"flex items-center gap-1 bg-theme-border/30 px-2 py-1 rounded-button group",children:[r.jsx("span",{className:"text-theme-ink",children:x}),r.jsx("button",{onClick:()=>d(j),className:"text-red-500 hover:text-red-700 text-xs opacity-60 group-hover:opacity-100",children:""})]},j))})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Quick Add (click to append to input)"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:["","","","","","","","miss","hit","crit","poison","bleed","stun","1","2","3"].map(x=>r.jsx("button",{onClick:()=>l(j=>j?`${j},${x}`:x),className:"px-2 py-1 border border-theme-border rounded-button text-xs hover:bg-theme-accent hover:text-theme-paper",children:x},x))})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-theme-border",children:[r.jsx("button",{onClick:y,className:"px-4 py-2 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-muted hover:text-theme-paper",children:"Cancel"}),r.jsx("button",{onClick:v,className:"px-4 py-2 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90",children:"Save"})]})]})})]})}const Dr=e=>typeof e=="object"&&"faces"in e&&Array.isArray(e.faces);function K0({widget:e,updateData:t}){const{label:n,availableDice:o=[4,6,8,10,12,20]}=e.data,[a,s]=T.useState(""),[i,c]=T.useState({open:!1,faces:[],diceName:"",editIndex:null}),[l,u]=T.useState(""),h=[4,6,8,10,12,20,100],g=q(N=>N.characters),f=q(N=>N.activeCharacterId),w=T.useMemo(()=>{const N=g.find(M=>M.id===f);if(!N)return[];const p=[];for(const M of N.sheets)for(const P of M.widgets){if(P.type==="DICE_ROLLER"&&P.data.diceGroups)for(const A of P.data.diceGroups)A.customFaces&&A.customFaces.length>0&&A.customDiceName&&(p.some(_=>_.name===A.customDiceName)||p.push({name:A.customDiceName,faces:A.customFaces}));if(P.type==="DICE_TRAY"&&P.data.availableDice)for(const A of P.data.availableDice)Dr(A)&&A.name&&(p.some(_=>_.name===A.name)||p.push({name:A.name,faces:A.faces}))}return p},[g,f]),S=N=>{const p=w.find(M=>M.name===N);p&&c(M=>({...M,diceName:p.name,faces:[...p.faces]}))},y=N=>{const p=o,M=p.filter(A=>!Dr(A)),P=p.filter(A=>Dr(A));if(M.includes(N)){const A=M.filter(_=>_!==N);t({availableDice:[...A.sort((_,O)=>_-O),...P]})}else{const A=[...M,N].sort((_,O)=>_-O);t({availableDice:[...A,...P]})}},v=N=>{N.preventDefault();const p=parseInt(a),M=o,P=M.filter(A=>!Dr(A));if(p&&p>0&&!P.includes(p)){const A=M.filter(O=>Dr(O)),_=[...P,p].sort((O,V)=>O-V);t({availableDice:[..._,...A]}),s("")}},m=N=>{const p=[...o];p.splice(N,1),t({availableDice:p})},d=(N=null)=>{if(N!==null){const p=o[N];Dr(p)&&c({open:!0,faces:[...p.faces],diceName:p.name,editIndex:N})}else c({open:!0,faces:[],diceName:"",editIndex:null});u("")},b=()=>{c({open:!1,faces:[],diceName:"",editIndex:null}),u("")},k=()=>{if(i.faces.length===0||!i.diceName.trim())return;const N={name:i.diceName.trim(),faces:i.faces},p=[...o];i.editIndex!==null?p[i.editIndex]=N:p.push(N),t({availableDice:p}),b()},C=()=>{l.trim()&&(c(N=>({...N,faces:[...N.faces,l.trim()]})),u(""))},x=N=>{c(p=>({...p,faces:p.faces.filter((M,P)=>P!==N)}))},j=o.map((N,p)=>({die:N,index:p})).filter(({die:N})=>!Dr(N)),E=o.map((N,p)=>({die:N,index:p})).filter(({die:N})=>Dr(N));return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:N=>t({label:N.target.value}),placeholder:"Dice Tray"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Quick Add Common Dice"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(N=>r.jsxs("button",{onClick:()=>y(N),className:`px-3 py-2 border border-theme-border rounded-button text-sm font-bold transition-all ${j.some(({die:p})=>p===N)?"bg-theme-accent text-theme-paper":"bg-theme-paper text-theme-ink hover:bg-theme-muted hover:text-theme-paper"}`,children:["d",N]},N))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Add Custom Numeric Dice"}),r.jsxs("form",{onSubmit:v,className:"flex gap-2",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-theme-ink",children:"d"}),r.jsx("input",{type:"number",min:"1",value:a,onChange:N=>s(N.target.value),placeholder:"faces",className:"w-20 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"})]}),r.jsx("button",{type:"submit",className:"px-3 py-1 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90",children:"Add"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Custom Faces Dice"}),r.jsx("button",{onClick:()=>d(),className:"px-3 py-2 border border-theme-border rounded-button text-sm font-bold bg-theme-paper text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-all",children:"+ Add Custom Faces Die"}),E.length>0&&r.jsx("div",{className:"mt-2 space-y-2",children:E.map(({die:N,index:p})=>r.jsxs("div",{className:"flex items-start gap-2 p-2 bg-theme-border/20 rounded-button",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-bold text-sm text-theme-ink",children:N.name}),r.jsx("div",{className:"text-xs text-theme-muted flex flex-wrap gap-1 mt-1",children:N.faces.map((M,P)=>r.jsx("span",{className:"bg-theme-border/30 px-1 rounded",children:M},P))})]}),r.jsx("button",{onClick:()=>d(p),className:"text-theme-accent hover:opacity-80 text-xs px-2 py-1",children:"Edit"}),r.jsx("button",{onClick:()=>m(p),className:"text-red-500 hover:text-red-700 px-1",children:""})]},`custom-${N.name}-${p}`))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Current Standard Dice"}),j.length>0?r.jsx("div",{className:"flex flex-wrap gap-2",children:j.map(({die:N,index:p})=>r.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-theme-accent text-theme-paper rounded-button text-sm",children:[r.jsxs("span",{children:["d",N]}),r.jsx("button",{onClick:()=>m(p),className:"hover:text-red-300 ml-1",children:""})]},`standard-${N}`))}):r.jsx("p",{className:"text-xs text-theme-muted",children:"No standard dice selected"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",id:"showIndividualResults",checked:e.data.showIndividualResults||!1,onChange:N=>t({showIndividualResults:N.target.checked}),className:"w-4 h-4 border border-theme-border rounded bg-theme-paper text-theme-accent focus:ring-theme-accent"}),r.jsx("label",{htmlFor:"showIndividualResults",className:"text-sm font-medium text-theme-ink",children:"Show individual dice results (don't sum)"})]}),i.open&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:b,children:r.jsxs("div",{className:"bg-theme-paper border-2 border-theme-border rounded-lg p-4 w-96 max-h-[80vh] overflow-y-auto shadow-xl",onClick:N=>N.stopPropagation(),children:[r.jsx("h3",{className:"text-lg font-bold text-theme-ink mb-4",children:i.editIndex!==null?"Edit Custom Die":"Create Custom Die"}),w.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Copy from existing dice"}),r.jsxs("select",{className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm",value:"",onChange:N=>{N.target.value&&S(N.target.value)},children:[r.jsx("option",{value:"",children:"Select a custom dice to copy..."}),w.map(N=>r.jsxs("option",{value:N.name,children:[N.name," (",N.faces.length," faces)"]},N.name))]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Dice Name (required)"}),r.jsx("input",{type:"text",value:i.diceName,onChange:N=>c(p=>({...p,diceName:N.target.value})),placeholder:"e.g., Fate Die, Doom Die, Attack Die",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"})]}),r.jsxs("p",{className:"text-sm text-theme-muted mb-4",children:["Add any values for dice faces: numbers, emojis, symbols, or text.",r.jsx("br",{}),r.jsx("span",{className:"font-medium",children:"Tip:"})," Use ",r.jsx("code",{className:"bg-theme-border/30 px-1 rounded",children:","})," to put multiple values on one face (e.g., ",r.jsx("code",{className:"bg-theme-border/30 px-1 rounded",children:",poison"}),")"]}),r.jsxs("div",{className:"flex gap-2 mb-4",children:[r.jsx("input",{type:"text",value:l,onChange:N=>u(N.target.value),onKeyDown:N=>N.key==="Enter"&&(N.preventDefault(),C()),placeholder:"e.g., , poison, 5, or ,poison",className:"flex-1 px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"}),r.jsx("button",{onClick:C,className:"px-3 py-2 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90",children:"Add"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:["Current Faces (",i.faces.length,")"]}),i.faces.length===0?r.jsx("p",{className:"text-sm text-theme-muted italic",children:"No custom faces added yet"}):r.jsx("div",{className:"flex flex-wrap gap-2",children:i.faces.map((N,p)=>r.jsxs("div",{className:"flex items-center gap-1 bg-theme-border/30 px-2 py-1 rounded-button group",children:[r.jsx("span",{className:"text-theme-ink",children:N}),r.jsx("button",{onClick:()=>x(p),className:"text-red-500 hover:text-red-700 text-xs opacity-60 group-hover:opacity-100",children:""})]},p))})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Quick Add (click to append to input)"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:["","","","","","","","miss","hit","crit","poison","bleed","stun","1","2","3"].map(N=>r.jsx("button",{onClick:()=>u(p=>p?`${p},${N}`:N),className:"px-2 py-1 border border-theme-border rounded-button text-xs hover:bg-theme-accent hover:text-theme-paper",children:N},N))})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-theme-border",children:[r.jsx("button",{onClick:b,className:"px-4 py-2 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-muted hover:text-theme-paper",children:"Cancel"}),r.jsx("button",{onClick:k,disabled:!i.diceName.trim()||i.faces.length===0,className:`px-4 py-2 rounded-button text-sm ${!i.diceName.trim()||i.faces.length===0?"bg-theme-muted text-theme-paper cursor-not-allowed":"bg-theme-accent text-theme-paper hover:opacity-90"}`,children:"Save"})]})]})})]})}function Q0({widget:e,updateData:t}){const{label:n,spellLevels:o=[{level:1,max:4,used:0}]}=e.data,a=()=>{const l=o.map(h=>h.level),u=Math.min(9,Math.max(...l,0)+1);u<=9&&!l.includes(u)&&t({spellLevels:[...o,{level:u,max:2,used:0}]})},s=l=>{const u=[...o];u.splice(l,1),t({spellLevels:u})},i=(l,u)=>{const h=[...o];if(typeof u=="string")h[l]={...h[l],max:u};else{const g=Math.max(1,Math.min(10,u));h[l]={...h[l],max:g,used:Math.min(h[l].used,g)}}t({spellLevels:h})},c=(l,u)=>{const h=[...o];typeof u=="string"?h[l]={...h[l],level:u}:h[l]={...h[l],level:Math.max(1,Math.min(9,u))},t({spellLevels:h})};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:l=>t({label:l.target.value}),placeholder:"Spell Slots"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Spell Levels"}),r.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:o.map((l,u)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-theme-ink text-sm",children:"Level"}),r.jsx("input",{type:"number",value:l.level,onChange:h=>c(u,h.target.value===""?"":parseInt(h.target.value)||""),onBlur:h=>c(u,Math.max(1,Math.min(9,parseInt(h.target.value)||1))),className:"w-12 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center",min:1,max:9}),r.jsx("span",{className:"text-theme-ink text-sm",children:"Max Slots"}),r.jsx("input",{type:"number",value:l.max,onChange:h=>i(u,h.target.value===""?"":parseInt(h.target.value)||""),onBlur:h=>i(u,Math.max(1,Math.min(10,parseInt(h.target.value)||1))),className:"w-12 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center",min:1,max:10}),r.jsx("button",{onClick:()=>s(u),className:"text-red-500 hover:text-red-700 px-2",children:""})]},u))}),o.length<9&&r.jsx("button",{onClick:a,className:"mt-2 px-3 py-1 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper",children:"+ Add Level"})]})]})}function J0({widget:e,updateData:t}){const{label:n,imageUrl:o=""}=e.data,a=i=>{var l;const c=(l=i.target.files)==null?void 0:l[0];if(c){const u=new FileReader;u.onload=h=>{var f;const g=(f=h.target)==null?void 0:f.result;t({imageUrl:g})},u.readAsDataURL(c)}},s=()=>{t({imageUrl:""})};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:i=>t({label:i.target.value}),placeholder:"Portrait"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Image"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("label",{className:"flex-1 px-3 py-2 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90 cursor-pointer text-center",children:["Upload Image",r.jsx("input",{type:"file",accept:"image/*",onChange:a,className:"hidden"})]}),o&&r.jsx("button",{onClick:s,className:"px-3 py-2 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-red-500 hover:text-white hover:border-red-500",children:"Clear"})]}),o&&r.jsx("div",{className:"mt-2 border border-theme-border rounded-button overflow-hidden",children:r.jsx("img",{src:o,alt:"Preview",className:"w-full h-32 object-cover"})})]})]})}function q0({widget:e,updateData:t}){const{label:n,maxPool:o=5,poolStyle:a="dots",showPoolCount:s=!0,poolResources:i=[],inlineLabels:c=!1}=e.data,l=i.length>0,u=()=>{const y={name:`Resource ${i.length+1}`,max:5,current:5,style:"dots"};t({poolResources:[...i,y]})},h=y=>{const v=[...i];v.splice(y,1),t({poolResources:v})},g=(y,v,m)=>{const d=[...i];d[y]={...d[y],[v]:m},v==="max"&&d[y].current>m&&(d[y].current=m),t({poolResources:d})},f=()=>{t({poolResources:[{name:n||"Resource 1",max:o,current:o,style:a}]})},w=()=>{if(i.length>0){const y=i[0];t({poolResources:[],maxPool:y.max,currentPool:y.current,poolStyle:y.style})}else t({poolResources:[]})},S=r.jsxs(r.Fragment,{children:[r.jsxs("optgroup",{label:"Basic",children:[r.jsx("option",{value:"dots",children:" Dots"}),r.jsx("option",{value:"boxes",children:" Boxes"}),r.jsx("option",{value:"stars",children:" Stars"}),r.jsx("option",{value:"diamonds",children:" Diamonds"}),r.jsx("option",{value:"crosses",children:" Crosses"}),r.jsx("option",{value:"checkmarks",children:" Checkmarks"})]}),r.jsxs("optgroup",{label:"Themed",children:[r.jsx("option",{value:"hearts",children:" Hearts"}),r.jsx("option",{value:"flames",children:" Flames"}),r.jsx("option",{value:"skulls",children:" Skulls"}),r.jsx("option",{value:"shields",children:" Shields"}),r.jsx("option",{value:"swords",children:" Swords"}),r.jsx("option",{value:"lightning",children:" Lightning"}),r.jsx("option",{value:"moons",children:" Moons"}),r.jsx("option",{value:"suns",children:" Suns"}),r.jsx("option",{value:"coins",children:" Coins"}),r.jsx("option",{value:"gems",children:" Gems"})]})]});return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:y=>t({label:y.target.value}),placeholder:"Resource Pool"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),l?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:i.map((y,v)=>r.jsxs("div",{className:"border border-theme-border rounded-button p-3 space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("input",{className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm focus:outline-none focus:border-theme-accent",value:y.name,onChange:m=>g(v,"name",m.target.value),placeholder:"Resource name"}),r.jsx("button",{onClick:()=>h(v),className:"ml-2 text-red-500 hover:text-red-700 px-2",children:""})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs text-theme-muted mb-1",children:"Max"}),r.jsx("input",{type:"number",min:"1",max:"100",className:"w-full px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm focus:outline-none focus:border-theme-accent",value:y.max,onChange:m=>g(v,"max",parseInt(m.target.value)||1),onBlur:m=>g(v,"max",Math.max(1,Math.min(100,parseInt(m.target.value)||1)))})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs text-theme-muted mb-1",children:"Style"}),r.jsx("select",{value:y.style,onChange:m=>g(v,"style",m.target.value),className:"w-full px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm focus:outline-none focus:border-theme-accent",children:S})]})]})]},v))}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:u,className:"flex-1 px-3 py-2 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"+ Add Resource"}),r.jsx("button",{onClick:w,className:"px-3 py-2 border border-theme-border rounded-button text-sm text-theme-muted hover:bg-theme-border hover:text-theme-ink transition-colors",children:"Single Mode"})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Maximum Pool"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:o,onChange:y=>{t({maxPool:y.target.value===""?"":parseInt(y.target.value)||""})},onBlur:y=>{const v=Math.max(1,Math.min(1e3,parseInt(y.target.value)||1));t({maxPool:v})},min:1,max:1e3})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Style"}),r.jsx("select",{value:a,onChange:y=>t({poolStyle:y.target.value}),className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",children:S})]}),r.jsx("button",{onClick:f,className:"w-full px-3 py-2 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"+ Add Multiple Resources"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:s,onChange:y=>t({showPoolCount:y.target.checked}),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Show Counter (e.g., 3 / 5)"})]}),l&&r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:c,onChange:y=>t({inlineLabels:y.target.checked}),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Inline labels with icons"})]})]})}function Z0({widget:e,updateData:t}){const{label:n,toggleItems:o=[]}=e.data,[a,s]=T.useState(""),i=["Blinded","Charmed","Frightened","Poisoned","Stunned","Prone","Invisible","Paralyzed","Unconscious","Exhausted","Afraid","Angry","Confused","Wounded","Dazed"],c=f=>{f.trim()&&!o.some(w=>w.name.toLowerCase()===f.trim().toLowerCase())&&t({toggleItems:[...o,{name:f.trim(),active:!1}]}),s("")},l=f=>{f.preventDefault(),c(a)},u=f=>{const w=[...o];w.splice(f,1),t({toggleItems:w})},h=o.map(f=>f.name.toLowerCase()),g=i.filter(f=>!h.includes(f.toLowerCase()));return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:f=>t({label:f.target.value}),placeholder:"Conditions"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Conditions"}),r.jsx("div",{className:"flex flex-wrap gap-1 max-h-32 overflow-y-auto",children:o.map((f,w)=>r.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-theme-background rounded-button text-sm",children:[r.jsx("span",{className:"text-theme-ink",children:f.name}),r.jsx("button",{onClick:()=>u(w),className:"text-red-500 hover:text-red-700",children:""})]},w))}),r.jsxs("form",{onSubmit:l,className:"flex gap-2 mt-2",children:[r.jsx("input",{type:"text",value:a,onChange:f=>s(f.target.value),placeholder:"Add condition...",className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm"}),r.jsx("button",{type:"submit",className:"px-3 py-1 bg-theme-accent text-theme-paper rounded-button text-sm hover:opacity-90",children:"Add"})]}),g.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("span",{className:"text-xs text-theme-muted",children:"Quick add:"}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:g.slice(0,8).map(f=>r.jsx("button",{onClick:()=>c(f),className:"px-2 py-0.5 text-xs border border-theme-border rounded-button text-theme-ink hover:bg-theme-accent hover:text-theme-paper",children:f},f))})]})]})]})}function ev({widget:e,updateData:t}){const{label:n,roundMode:o=!1,effectSuggestions:a=[]}=e.data,[s,i]=T.useState(""),c=()=>{s.trim()&&!a.includes(s.trim())&&(t({effectSuggestions:[...a,s.trim()]}),i(""))},l=u=>{const h=[...a];h.splice(u,1),t({effectSuggestions:h})};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:u=>t({label:u.target.value}),placeholder:"Temporary Effects"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:o,onChange:u=>t({roundMode:u.target.checked}),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm font-medium text-theme-ink",children:"Round Mode"})]}),r.jsx("p",{className:"text-xs text-theme-muted mt-1 ml-6",children:"In round mode, time is tracked in rounds instead of real-world time units."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Effect Suggestions"}),r.jsx("p",{className:"text-xs text-theme-muted mb-2",children:"Add common effects that will appear as suggestions when adding new effects."}),r.jsxs("div",{className:"flex gap-2 mb-2",children:[r.jsx("input",{className:"flex-1 px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:s,onChange:u=>i(u.target.value),placeholder:"e.g., Bless, Haste, Shield...",onKeyDown:u=>{u.key==="Enter"&&(u.preventDefault(),c())}}),r.jsx("button",{type:"button",onClick:c,className:"px-3 py-2 bg-theme-accent text-theme-paper rounded-button hover:opacity-90 transition-colors font-bold",children:"Add"})]}),a.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1",children:a.map((u,h)=>r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-theme-border/30 text-theme-ink rounded-button text-sm",children:[u,r.jsx("button",{type:"button",onClick:()=>l(h),className:"text-theme-muted hover:text-red-500 transition-colors ml-1",children:""})]},h))})]}),r.jsxs("div",{className:"text-sm text-theme-muted",children:[r.jsx("p",{children:"Use this widget to track timed effects in your game."}),r.jsxs("ul",{className:"list-disc ml-4 mt-2 space-y-1",children:[r.jsx("li",{children:"Add effects with their remaining duration"}),r.jsx("li",{children:o?'Use "Pass Round" to advance all timers by 1 round':'Use the "Pass Time" controls to advance all timers at once'}),r.jsx("li",{children:"Expired effects will be highlighted"})]})]})]})}function tv({widget:e,updateData:t}){const{label:n,columns:o=["Item","Qty","Weight"],rows:a=[]}=e.data,[s,i]=T.useState(null),[c,l]=T.useState(null),u=xi.useRef(null),h=(k,C)=>{const x=[...o];x[k]=C,t({columns:x})},g=()=>{const k=a.map(C=>({...C,cells:[...C.cells,""]}));t({columns:[...o,"New"],rows:k})},f=k=>{if(o.length<=1)return;const C=[...o];C.splice(k,1);const x=a.map(j=>({...j,cells:j.cells.filter((E,N)=>N!==k)}));t({columns:C,rows:x})},w=(k,C)=>{u.current=C,i(C),k.dataTransfer.effectAllowed="move",k.dataTransfer.setData("text/plain",C.toString());const x=k.currentTarget;x&&k.dataTransfer.setDragImage(x,0,0)},S=(k,C)=>{k.preventDefault(),k.stopPropagation(),u.current!==null&&u.current!==C&&l(C)},y=()=>{l(null)},v=(k,C)=>{k.preventDefault(),k.stopPropagation();const x=u.current;if(x!==null&&x!==C){const j=[...o],E=a.map(M=>({...M,cells:[...M.cells]})),[N]=j.splice(x,1),p=x<C?C-1:C;j.splice(p,0,N),E.forEach(M=>{const[P]=M.cells.splice(x,1);M.cells.splice(p,0,P)}),t({columns:j,rows:E})}u.current=null,i(null),l(null)},m=()=>{u.current=null,i(null),l(null)},d=()=>{const k={cells:o.map(()=>"")};t({rows:[...a,k]})},b=k=>{if(a.length<=1)return;const C=[...a];C.splice(k,1),t({rows:C})};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:k=>t({label:k.target.value}),placeholder:"Inventory"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Columns"}),r.jsx("div",{className:"space-y-2",onDragOver:k=>k.preventDefault(),children:o.map((k,C)=>r.jsxs("div",{className:`flex items-center gap-2 ${s===C?"opacity-50":""} ${c===C&&s!==C?"border-t-2 border-theme-accent":""}`,draggable:!0,onDragStart:x=>w(x,C),onDragOver:x=>{x.preventDefault(),x.stopPropagation(),S(x,C)},onDragLeave:y,onDrop:x=>{x.preventDefault(),x.stopPropagation(),v(x,C)},onDragEnd:m,children:[r.jsx("div",{className:"cursor-grab active:cursor-grabbing text-theme-muted hover:text-theme-ink px-1 touch-none",title:"Drag to reorder",children:""}),r.jsx("input",{className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm",value:k,onChange:x=>h(C,x.target.value),placeholder:"Column name",draggable:!1,onDragOver:x=>x.stopPropagation()}),o.length>1&&r.jsx("button",{onClick:()=>f(C),className:"text-red-500 hover:text-red-700 px-2",children:""})]},C))}),r.jsx("button",{onClick:g,className:"mt-2 px-3 py-1 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper",children:"+ Add Column"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:["Rows (",a.length,")"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:d,className:"px-3 py-1 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper",children:"+ Add Row"}),a.length>1&&r.jsx("button",{onClick:()=>b(a.length-1),className:"px-3 py-1 border border-theme-border rounded-button text-sm text-red-500 hover:bg-red-500 hover:text-white",children:"- Remove Row"})]}),r.jsx("p",{className:"text-xs text-theme-muted mt-1",children:"Row contents can be edited in play mode"})]})]})}function rv({widget:e,updateData:t}){const{buttonText:n="Rest",healToFull:o=!1,healRandomDice:a=[],healFlatAmount:s=0,clearConditions:i=!1,resetSpellSlots:c=!1,passTime:l=!1,passTimeAmount:u=0,passTimeUnit:h="hours"}=e.data,g=(y,v,m)=>{const d=[...a];d[y]={...d[y],[v]:m},t({healRandomDice:d})},f=()=>{t({healRandomDice:[...a,{count:1,faces:8}]})},w=y=>{const v=a.filter((m,d)=>d!==y);t({healRandomDice:v})},S=y=>{t(y?{healToFull:!0,healRandomDice:[],healFlatAmount:0}:{healToFull:!1})};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Button Text"}),r.jsx("input",{className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n,onChange:y=>t({buttonText:y.target.value}),placeholder:"Rest"})]}),r.jsxs("div",{className:"border border-theme-border rounded-button p-3",children:[r.jsx("h4",{className:"font-medium text-theme-ink mb-3",children:"Healing Options"}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer mb-3",children:[r.jsx("input",{type:"checkbox",checked:o,onChange:y=>S(y.target.checked),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Heal to Full"})]}),!o&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Random Heal Dice"}),r.jsx("div",{className:"space-y-2",children:a.map((y,v)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",min:"1",value:y.count,onChange:m=>g(v,"count",m.target.value===""?"":parseInt(m.target.value)||""),onBlur:m=>g(v,"count",Math.max(1,parseInt(m.target.value)||1)),className:"w-16 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center"}),r.jsx("span",{className:"text-theme-ink",children:"d"}),r.jsx("input",{type:"number",min:"1",value:y.faces,onChange:m=>g(v,"faces",m.target.value===""?"":parseInt(m.target.value)||""),onBlur:m=>g(v,"faces",Math.max(1,parseInt(m.target.value)||1)),className:"w-16 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center"}),r.jsx("button",{onClick:()=>w(v),className:"text-red-500 hover:text-red-700 px-2",children:""})]},v))}),r.jsx("button",{onClick:f,className:"mt-2 px-3 py-1 border border-theme-border rounded-button text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper",children:"+ Add Dice"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Flat Heal Amount"}),r.jsx("input",{type:"number",min:"0",className:"w-full px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:s??0,onChange:y=>t({healFlatAmount:parseInt(y.target.value)||0})}),r.jsx("p",{className:"text-xs text-theme-muted mt-1",children:"Added to dice result if dice are configured"})]})]})]}),r.jsxs("div",{className:"border border-theme-border rounded-button p-3",children:[r.jsx("h4",{className:"font-medium text-theme-ink mb-3",children:"Other Actions"}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer mb-2",children:[r.jsx("input",{type:"checkbox",checked:i,onChange:y=>t({clearConditions:y.target.checked}),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Clear All Conditions"})]}),r.jsx("p",{className:"text-xs text-theme-muted ml-6 mb-3",children:"Turns off all active conditions in Condition widgets"}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:c,onChange:y=>t({resetSpellSlots:y.target.checked}),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Reset Spell Slots"})]}),r.jsx("p",{className:"text-xs text-theme-muted ml-6 mb-3",children:"Restores all used spell slots in Spell Slot widgets"}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:l,onChange:y=>t({passTime:y.target.checked,passTimeAmount:0,passTimeUnit:"hours"}),className:"w-4 h-4 accent-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Pass Time"})]}),r.jsx("p",{className:"text-xs text-theme-muted ml-6 mb-2",children:"Advances time for all Temporary Effects widgets"}),l&&r.jsxs("div",{className:"ml-6 mt-2",children:[r.jsx("label",{className:"block text-xs text-theme-muted mb-1",children:"Flat Time Amount (leave 0 to prompt when clicked)"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"number",min:"0",className:"w-20 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center",value:u??0,onChange:y=>t({passTimeAmount:parseInt(y.target.value)||0})}),r.jsxs("select",{className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm",value:h,onChange:y=>t({passTimeUnit:y.target.value}),children:[r.jsx("option",{value:"seconds",children:"Seconds"}),r.jsx("option",{value:"minutes",children:"Minutes"}),r.jsx("option",{value:"hours",children:"Hours"}),r.jsx("option",{value:"days",children:"Days"}),r.jsx("option",{value:"months",children:"Months"}),r.jsx("option",{value:"years",children:"Years"})]})]})]})]})]})}function nv({widget:e,updateData:t}){const{label:n,strokeColor:o="#333333",strokeWidth:a=2,gridEnabled:s=!0,gridSize:i=20,corridorWidth:c=10}=e.data;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:l=>t({label:l.target.value}),placeholder:"Dungeon Map"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Stroke Color"}),r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsx("input",{type:"color",value:o,onChange:l=>t({strokeColor:l.target.value}),className:"w-10 h-10 border border-theme-border rounded-button cursor-pointer"}),r.jsx("input",{className:"flex-1 px-3 py-2 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:o,onChange:l=>t({strokeColor:l.target.value}),placeholder:"#333333"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Stroke Width"}),r.jsx("input",{type:"range",min:"1",max:"10",value:a,onChange:l=>t({strokeWidth:parseInt(l.target.value)}),className:"w-full"}),r.jsxs("div",{className:"text-xs text-theme-muted text-center",children:[a,"px"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Corridor Width"}),r.jsx("input",{type:"range",min:"5",max:"50",value:c,onChange:l=>t({corridorWidth:parseInt(l.target.value)}),className:"w-full"}),r.jsxs("div",{className:"text-xs text-theme-muted text-center",children:[c,"px"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",id:"gridEnabled",checked:s,onChange:l=>t({gridEnabled:l.target.checked}),className:"w-4 h-4"}),r.jsx("label",{htmlFor:"gridEnabled",className:"text-sm font-medium text-theme-ink",children:"Show Grid"})]}),s&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Grid Size"}),r.jsx("input",{type:"range",min:"10",max:"50",value:i,onChange:l=>t({gridSize:parseInt(l.target.value)}),className:"w-full"}),r.jsxs("div",{className:"text-xs text-theme-muted text-center",children:[i,"px"]})]})]})}function ov({widget:e,updateData:t}){const{label:n,rollTableItems:o=[{text:"",weight:1}],showRollTableItems:a=!0}=e.data,s=(h,g,f)=>{const w=[...o];if(g==="text")w[h]={...w[h],text:f};else{const S=Math.max(0,Number(f)||0);w[h]={...w[h],weight:S}}t({rollTableItems:w})},i=()=>{const h=[...o,{text:"",weight:1}];t({rollTableItems:h})},c=h=>{if(o.length<=1)return;const g=o.filter((f,w)=>w!==h);t({rollTableItems:g})},l=()=>o.reduce((h,g)=>h+(g.weight||0),0),u=h=>{const g=l();return g===0?0:Math.round(h/g*100)};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:h=>t({label:h.target.value}),placeholder:"Roll Table Title"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:a,onChange:h=>t({showRollTableItems:h.target.checked}),className:"w-4 h-4 rounded border-theme-border text-theme-accent focus:ring-theme-accent"}),r.jsx("span",{className:"text-sm text-theme-ink",children:"Show items in widget"})]}),r.jsx("p",{className:"text-xs text-theme-muted mt-1 mb-4",children:"When unchecked, only the roll button and result will be visible"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Table Items"}),r.jsx("p",{className:"text-xs text-theme-muted mb-2",children:"Add items with weights. Higher weights = higher probability. All weights are normalized when rolling."}),r.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:o.map((h,g)=>r.jsxs("div",{className:"flex items-center gap-2 p-2 bg-theme-background rounded-button",children:[r.jsxs("span",{className:"text-xs text-theme-muted w-6",children:[g+1,"."]}),r.jsx("input",{className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm focus:outline-none focus:border-theme-accent",value:h.text,onChange:f=>s(g,"text",f.target.value),placeholder:"Item text..."}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("label",{className:"text-xs text-theme-muted",children:"Weight:"}),r.jsx("input",{type:"number",min:"0",step:"1",className:"w-16 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center focus:outline-none focus:border-theme-accent",value:h.weight,onChange:f=>s(g,"weight",f.target.value)})]}),r.jsxs("span",{className:"text-xs text-theme-muted w-10 text-right",children:[u(h.weight),"%"]}),r.jsx("button",{onClick:()=>c(g),disabled:o.length<=1,className:"text-red-500 hover:text-red-700 disabled:opacity-30 disabled:cursor-not-allowed px-1",children:""})]},g))}),r.jsx("button",{onClick:i,className:"mt-2 w-full px-3 py-2 text-sm border border-dashed border-theme-border rounded-button text-theme-muted hover:text-theme-ink hover:border-theme-accent transition-colors",children:"+ Add Item"})]}),r.jsxs("div",{className:"text-xs text-theme-muted bg-theme-background p-2 rounded-button",children:[r.jsx("strong",{children:"How it works:"})," When you roll, each item's probability is calculated as (item weight / total weight). For example, if you have items with weights 1, 2, and 3, they have ~17%, ~33%, and ~50% chance respectively."]})]})}function av({widget:e,updateData:t}){const{label:n,initiativePool:o=[],initiativeShowRollButton:a=!0,initiativeAdvanceTimeTrackers:s=!1,initiativeAdvanceByRound:i=!0,initiativeAdvanceTimeAmount:c=6,initiativeAdvanceTimeUnit:l="seconds"}=e.data,[u,h]=T.useState(""),[g,f]=T.useState(20),[w,S]=T.useState(0),[y,v]=T.useState(null),[m,d]=T.useState(""),[b,k]=T.useState(20),[C,x]=T.useState(0),[j,E]=T.useState(null),[N,p]=T.useState(null),M=T.useRef(null),P=$=>{if($.preventDefault(),u.trim()){const F={name:u.trim(),diceFaces:g,flatBonus:w};t({initiativePool:[...o,F]}),h(""),f(20),S(0)}},A=$=>{const F=[...o];F.splice($,1),t({initiativePool:F}),y===$&&v(null)},_=$=>{const F=o[$];v($),d(F.name),k(F.diceFaces),x(F.flatBonus),setTimeout(()=>{var X;return(X=M.current)==null?void 0:X.focus()},0)},O=()=>{if(y!==null&&m.trim()){const $=[...o];$[y]={name:m.trim(),diceFaces:b,flatBonus:C},t({initiativePool:$})}v(null),d(""),k(20),x(0)},V=$=>{$.key==="Enter"?O():$.key==="Escape"&&(v(null),d(""))},z=($,F)=>{$.stopPropagation(),E(F),$.dataTransfer.effectAllowed="move",$.dataTransfer.setData("text/plain",F.toString())},I=($,F)=>{$.preventDefault(),$.stopPropagation(),$.dataTransfer.dropEffect="move",p(F)},L=$=>{$.stopPropagation(),p(null)},Y=($,F)=>{$.preventDefault(),$.stopPropagation();const X=j??parseInt($.dataTransfer.getData("text/plain"),10);if(isNaN(X)||X===F){E(null),p(null);return}const oe=[...o],[H]=oe.splice(X,1);oe.splice(F,0,H),t({initiativePool:oe}),E(null),p(null)},J=()=>{E(null),p(null)};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:$=>t({label:$.target.value}),placeholder:"Initiative Tracker"}),n&&r.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink",onClick:()=>t({label:""}),children:""})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",id:"showRollButton",checked:a,onChange:$=>t({initiativeShowRollButton:$.target.checked}),className:"w-4 h-4 rounded border-theme-border text-theme-accent focus:ring-theme-accent"}),r.jsx("label",{htmlFor:"showRollButton",className:"text-sm text-theme-ink",children:'Include "Roll Initiative" button'})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",id:"advanceTimeTrackers",checked:s,onChange:$=>t({initiativeAdvanceTimeTrackers:$.target.checked}),className:"w-4 h-4 rounded border-theme-border text-theme-accent focus:ring-theme-accent"}),r.jsx("label",{htmlFor:"advanceTimeTrackers",className:"text-sm text-theme-ink",children:"Advance Time Trackers on new round"})]}),s&&r.jsxs("div",{className:"ml-6 p-2 border border-theme-border rounded bg-theme-background/50 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",id:"advanceByRound",checked:i,onChange:$=>t({initiativeAdvanceByRound:$.target.checked}),className:"w-4 h-4 rounded border-theme-border text-theme-accent focus:ring-theme-accent"}),r.jsx("label",{htmlFor:"advanceByRound",className:"text-sm text-theme-ink",children:"Advance by 1 round (for round-mode trackers)"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-sm text-theme-ink",children:"Also advance by:"}),r.jsx("input",{type:"number",min:0,value:c,onChange:$=>t({initiativeAdvanceTimeAmount:Math.max(0,parseInt($.target.value)||0)}),className:"w-16 px-2 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent"}),r.jsxs("select",{value:l,onChange:$=>t({initiativeAdvanceTimeUnit:$.target.value}),className:"px-2 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",children:[r.jsx("option",{value:"seconds",children:"seconds"}),r.jsx("option",{value:"minutes",children:"minutes"}),r.jsx("option",{value:"hours",children:"hours"}),r.jsx("option",{value:"days",children:"days"})]})]}),r.jsx("p",{className:"text-xs text-theme-muted",children:"Time Trackers will be updated when the turn cycles back to the first participant."})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Participant Pool"}),r.jsx("form",{onSubmit:P,className:"mb-3 p-2 border border-theme-border rounded bg-theme-background/50",children:r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("input",{type:"text",value:u,onChange:$=>h($.target.value),placeholder:"Participant name...",className:"w-full px-2 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent"}),a&&r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"text-xs text-theme-muted",children:"Die"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-sm text-theme-ink",children:"d"}),r.jsx("input",{type:"number",min:1,value:g,onChange:$=>f(Math.max(1,parseInt($.target.value)||1)),className:"w-16 px-2 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent"})]})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"text-xs text-theme-muted",children:"Bonus"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-sm text-theme-ink",children:"+"}),r.jsx("input",{type:"number",value:w,onChange:$=>S(parseInt($.target.value)||0),className:"w-16 px-2 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent"})]})]})]}),r.jsx("button",{type:"submit",className:"w-full px-3 py-1 text-sm bg-theme-accent text-theme-paper rounded hover:opacity-90 transition-opacity",children:"Add to Pool"})]})}),o.length===0?r.jsx("div",{className:"text-sm text-theme-muted italic text-center py-2",children:"No participants in pool"}):r.jsx("div",{className:"space-y-1 max-h-[200px] overflow-y-auto",children:o.map(($,F)=>r.jsx("div",{draggable:y!==F,onDragStart:X=>z(X,F),onDragOver:X=>I(X,F),onDragLeave:X=>L(X),onDrop:X=>Y(X,F),onDragEnd:J,className:`flex items-center gap-2 p-2 border border-theme-border rounded bg-theme-paper transition-colors ${N===F?"ring-2 ring-theme-accent":""} ${j===F?"opacity-50":""}`,children:y===F?r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx("input",{ref:M,type:"text",value:m,onChange:X=>d(X.target.value),onKeyDown:V,className:"w-full px-2 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent"}),a&&r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-theme-muted",children:"d"}),r.jsx("input",{type:"number",min:1,value:b,onChange:X=>k(Math.max(1,parseInt(X.target.value)||1)),onKeyDown:V,className:"w-14 px-1 py-0.5 text-xs border border-theme-border rounded bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-theme-muted",children:"+"}),r.jsx("input",{type:"number",value:C,onChange:X=>x(parseInt(X.target.value)||0),onKeyDown:V,className:"w-14 px-1 py-0.5 text-xs border border-theme-border rounded bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent"})]})]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:O,className:"flex-1 px-2 py-0.5 text-xs bg-theme-accent text-theme-paper rounded hover:opacity-90",children:"Save"}),r.jsx("button",{onClick:()=>v(null),className:"flex-1 px-2 py-0.5 text-xs border border-theme-border text-theme-ink rounded hover:bg-theme-background",children:"Cancel"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-theme-muted cursor-grab active:cursor-grabbing select-none",children:""}),r.jsx("span",{className:"flex-1 text-sm text-theme-ink truncate",children:$.name}),a&&r.jsxs("span",{className:"text-xs text-theme-muted",children:["d",$.diceFaces,"+",$.flatBonus]}),r.jsx("button",{onClick:()=>_(F),className:"text-theme-muted hover:text-theme-ink text-sm",title:"Edit",children:""}),r.jsx("button",{onClick:()=>A(F),className:"text-theme-muted hover:text-red-500 text-sm",title:"Remove",children:""})]})},F))})]})]})}function sv({widget:e,updateData:t}){const{label:n,deckCards:o=[{name:"",amount:1}]}=e.data,a=(u,h,g)=>{const f=[...o];if(h==="name")f[u]={...f[u],name:g};else{const w=Math.max(0,Number(g)||0);f[u]={...f[u],amount:w}}t({deckCards:f,deckState:null})},s=()=>{const u=[...o,{name:"",amount:1}];t({deckCards:u,deckState:null})},i=u=>{if(o.length<=1)return;const h=o.filter((g,f)=>f!==u);t({deckCards:h,deckState:null})},c=()=>o.reduce((u,h)=>u+(h.name.trim()?h.amount:0),0),l=(u,h)=>{if(!h.trim())return 0;const g=c();return g===0?0:Math.round(u/g*100)};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-1",children:"Widget Label"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{className:"w-full px-3 py-2 pr-8 border border-theme-border rounded-button bg-theme-paper text-theme-ink focus:outline-none focus:border-theme-accent",value:n||"",onChange:u=>t({label:u.target.value}),placeholder:"Deck Name"}),n&&r.jsx("button",{type:"button",onClick:()=>t({label:""}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-theme-muted hover:text-theme-ink transition-colors",title:"Clear label",children:""})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-theme-ink mb-2",children:"Deck Cards"}),r.jsx("p",{className:"text-xs text-theme-muted mb-2",children:"Add cards with amounts. When you draw, a card is removed from the deck and added to the discard pile."}),r.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:o.map((u,h)=>r.jsxs("div",{className:"flex items-center gap-2 p-2 bg-theme-background rounded-button",children:[r.jsxs("span",{className:"text-xs text-theme-muted w-6",children:[h+1,"."]}),r.jsx("input",{className:"flex-1 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm focus:outline-none focus:border-theme-accent",value:u.name,onChange:g=>a(h,"name",g.target.value),placeholder:"Card name..."}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("label",{className:"text-xs text-theme-muted",children:""}),r.jsx("input",{type:"number",min:"0",step:"1",className:"w-16 px-2 py-1 border border-theme-border rounded-button bg-theme-paper text-theme-ink text-sm text-center focus:outline-none focus:border-theme-accent",value:u.amount,onChange:g=>a(h,"amount",g.target.value)})]}),r.jsxs("span",{className:"text-xs text-theme-muted w-10 text-right",children:[l(u.amount,u.name),"%"]}),r.jsx("button",{onClick:()=>i(h),disabled:o.length<=1,className:"text-red-500 hover:text-red-700 disabled:opacity-30 disabled:cursor-not-allowed px-1",children:""})]},h))}),r.jsx("button",{onClick:s,className:"mt-2 w-full px-3 py-2 text-sm border border-dashed border-theme-border rounded-button text-theme-muted hover:text-theme-ink hover:border-theme-accent transition-colors",children:"+ Add Card"})]}),c()>0&&r.jsxs("div",{className:"text-xs text-theme-ink bg-theme-accent/10 p-2 rounded-button",children:[r.jsx("strong",{children:"Total cards in deck:"})," ",c()]})]})}function lv(e){return{NUMBER:"Number Tracker",NUMBER_DISPLAY:"Number Display",LIST:"List",TEXT:"Text",CHECKBOX:"Checklist",HEALTH_BAR:"Health Bar",DICE_ROLLER:"Dice Roller",DICE_TRAY:"Dice Tray",SPELL_SLOT:"Spell Slots",IMAGE:"Image",POOL:"Resource Pool",TOGGLE_GROUP:"Conditions",TABLE:"Table",TIME_TRACKER:"Temporary Effects",FORM:"Form",REST_BUTTON:"Rest Button",PROGRESS_BAR:"Progress Bar",MAP_SKETCHER:"Map Sketcher",ROLL_TABLE:"Roll Table",INITIATIVE_TRACKER:"Initiative Tracker",DECK:"Deck of Cards"}[e]||"Widget"}function iv({widget:e,onClose:t}){const n=q(v=>v.updateWidgetData),o=q(v=>v.updateWidgetSize),a=ot(v=>v.tutorialStep),s=ot(v=>v.advanceTutorial),[i,c]=T.useState({...e.data}),[l,u]=T.useState(e.w||200),h=v=>{const m={...i,...v};c(m),n(e.id,v)},g=v=>{u(v),o(e.id,v,e.h||0)},f={...e,data:i,w:l},w=()=>{const v={widget:f,updateData:h,updateWidth:g};switch(e.type){case"NUMBER":return r.jsx(W0,{...v});case"NUMBER_DISPLAY":return r.jsx(F0,{...v});case"LIST":return r.jsx(z0,{...v});case"TEXT":return r.jsx(H0,{...v});case"CHECKBOX":return r.jsx(U0,{...v});case"HEALTH_BAR":return r.jsx(G0,{...v});case"DICE_ROLLER":return r.jsx(X0,{...v});case"DICE_TRAY":return r.jsx(K0,{...v});case"SPELL_SLOT":return r.jsx(Q0,{...v});case"IMAGE":return r.jsx(J0,{...v});case"POOL":return r.jsx(q0,{...v});case"TOGGLE_GROUP":return r.jsx(Z0,{...v});case"TABLE":return r.jsx(tv,{...v});case"TIME_TRACKER":return r.jsx(ev,{...v});case"FORM":return r.jsx(B0,{...v});case"REST_BUTTON":return r.jsx(rv,{...v});case"PROGRESS_BAR":return r.jsx(V0,{...v});case"MAP_SKETCHER":return r.jsx(nv,{...v});case"ROLL_TABLE":return r.jsx(ov,{...v});case"INITIATIVE_TRACKER":return r.jsx(av,{...v});case"DECK":return r.jsx(sv,{...v});default:return null}},S=()=>{const v=l||e.w||200,m=e.h||200;return{width:v,height:m}},y=()=>{const{width:v,height:m}=S(),d={widget:f,mode:"play",width:v,height:m};switch(e.type){case"NUMBER":return r.jsx(uc,{...d});case"NUMBER_DISPLAY":return r.jsx(hc,{...d});case"LIST":return r.jsx(mc,{...d});case"TEXT":return r.jsx(fc,{...d});case"CHECKBOX":return r.jsx(pc,{...d});case"HEALTH_BAR":return r.jsx(xc,{...d});case"DICE_ROLLER":return r.jsx(gc,{...d});case"DICE_TRAY":return r.jsx(bc,{...d});case"SPELL_SLOT":return r.jsx(vc,{...d});case"IMAGE":return r.jsx(yc,{...d});case"POOL":return r.jsx(wc,{...d});case"TOGGLE_GROUP":return r.jsx(kc,{...d});case"TABLE":return r.jsx(jc,{...d});case"TIME_TRACKER":return r.jsx(Nc,{...d});case"FORM":return r.jsx(Sc,{...d});case"REST_BUTTON":return r.jsx(Cc,{...d});case"PROGRESS_BAR":return r.jsx(Tc,{...d});case"MAP_SKETCHER":return r.jsx(Ec,{...d});case"ROLL_TABLE":return r.jsx(Ic,{...d});case"INITIATIVE_TRACKER":return r.jsx(Mc,{...d});case"DECK":return r.jsx(Pc,{...d});default:return null}};return T.useEffect(()=>{const v=m=>{m.key==="Escape"&&t()};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[t]),er.createPortal(r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:v=>{v.target===v.currentTarget&&t()},onMouseDown:v=>v.stopPropagation(),onMouseUp:v=>v.stopPropagation(),onMouseMove:v=>v.stopPropagation(),onWheel:v=>v.stopPropagation(),onTouchStart:v=>v.stopPropagation(),onTouchMove:v=>v.stopPropagation(),onTouchEnd:v=>v.stopPropagation(),onDragOver:v=>v.preventDefault(),children:r.jsxs("div",{className:"bg-theme-paper border-[length:var(--border-width)] border-theme-border rounded-theme shadow-theme w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-theme-border",children:[r.jsxs("h2",{className:"text-lg font-bold text-theme-ink font-heading",children:["Edit ",lv(e.type)]}),r.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center text-theme-muted hover:text-theme-ink hover:bg-theme-background rounded-button transition-colors",children:""})]}),r.jsx("div",{className:"flex-1 overflow-auto p-4",children:r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-sm font-medium text-theme-muted mb-3",children:"Settings"}),w()]}),r.jsxs("div",{className:"flex-shrink-0",children:[r.jsx("h3",{className:"text-sm font-medium text-theme-muted mb-3",children:"Preview"}),r.jsx("div",{className:"bg-theme-paper border-[length:var(--border-width)] border-theme-border rounded-theme p-2 shadow-theme",style:{width:`${S().width+16}px`,height:`${S().height+16}px`},children:y()})]})]})}),r.jsx("div",{className:"px-4 py-3 border-t border-theme-border flex justify-end",children:r.jsx("button",{"data-tutorial":"edit-done-button",disabled:a!==null&&a>=18&&a<21,onClick:()=>{var v;a===21&&((v=_e[21])==null?void 0:v.id)==="form-click-done"&&s(),t()},className:`px-4 py-2 bg-theme-accent text-theme-paper rounded-button font-medium ${a!==null&&a>=18&&a<21?"opacity-50 cursor-not-allowed":"hover:opacity-90"} ${a===21?"outline outline-4 outline-blue-500 outline-offset-2":""}`,children:"Done"})})]})}),document.body)}const Ye=10,Ea=10,cv={NUMBER:{width:60,height:30},NUMBER_DISPLAY:{width:50,height:40},LIST:{width:60,height:40},TEXT:{width:50,height:30},CHECKBOX:{width:60,height:30},HEALTH_BAR:{width:80,height:40},DICE_ROLLER:{width:80,height:60},DICE_TRAY:{width:70,height:60},SPELL_SLOT:{width:80,height:40},IMAGE:{width:40,height:40},POOL:{width:60,height:40},TOGGLE_GROUP:{width:60,height:30},TABLE:{width:80,height:40},TIME_TRACKER:{width:90,height:70},FORM:{width:80,height:30},REST_BUTTON:{width:60,height:40},PROGRESS_BAR:{width:50,height:20},MAP_SKETCHER:{width:100,height:100},ROLL_TABLE:{width:70,height:30},INITIATIVE_TRACKER:{width:90,height:60},DECK:{width:70,height:40}};function dv({widget:e,scale:t}){var Er,oo;const n=q(R=>R.updateWidgetPosition),o=q(R=>R.updateWidgetSize),a=q(R=>R.moveWidgetGroup),s=q(R=>R.removeWidget),i=q(R=>R.cloneWidget),c=q(R=>R.detachWidgets),l=q(R=>R.toggleWidgetLock),u=q(R=>R.moveWidgetToSheet),h=q(R=>R.getWidgetsInGroup),g=q(R=>R.cloneGroup),f=q(R=>R.removeGroup),w=q(R=>R.toggleGroupLock),S=q(R=>R.moveGroupToSheet),y=q(R=>R.detachAllInGroup),v=q(R=>R.mode),m=q(R=>R.setEditingWidgetId),d=q(R=>R.selectedWidgetId),b=q(R=>R.setSelectedWidgetId),k=bn(R=>R.addTemplate),C=bn(R=>R.addGroupTemplate),x=ot(R=>R.tutorialStep),j=ot(R=>R.advanceTutorial),E=ht(R=>R.textureDisabled),N=ht(R=>R.bordersDisabled),p=q(R=>R.activeCharacterId),P=q(R=>R.characters).find(R=>R.id===p),A=P!=null&&P.theme?dr(P.theme):void 0,_=P!=null&&P.theme?Ms(P.theme):void 0,O=(A==null?void 0:A.cardTexture)||(_==null?void 0:_.cardTexture)||"none",V=Et(O)&&!E&&v!=="print",z=(P==null?void 0:P.sheets)||[],I=z.length>1,L=T.useRef(null),Y=T.useRef(null),J=T.useRef(null),$=T.useRef(null),[F,X]=T.useState(!1),[oe,H]=T.useState(!1),[he,je]=T.useState(!1),[$e,Se]=T.useState(!1),[Qe,Ae]=T.useState(!1),[G,ae]=T.useState(""),[de,ce]=T.useState(!1),[Ne,Te]=T.useState(!1),[Q,K]=T.useState(!1),[Z,W]=T.useState(""),[B,re]=T.useState(!1),[te,fe]=T.useState("widget"),[me,be]=T.useState(!1),[Ie,Je]=T.useState(null),qe=T.useRef({x:0,y:0}),ue=["NUMBER","NUMBER_DISPLAY"].includes(e.type),Me=q(R=>R.updateWidgetData),[pe,xe]=T.useState(!1),le=T.useRef({mouseX:0,mouseY:0,width:0,height:0}),tt=d===e.id,tr=cv[e.type]||{width:120,height:60};T.useEffect(()=>{x===17&&e.type==="FORM"&&H(!0)},[x,e.type]),T.useEffect(()=>{const R=se=>{x===17&&e.type==="FORM"||J.current&&!J.current.contains(se.target)&&(H(!1),Se(!1),Ae(!1),ae(""),ce(!1),Te(!1),K(!1),W(""),re(!1),fe("widget"))};if(oe)return document.addEventListener("mousedown",R),document.addEventListener("touchstart",R),()=>{document.removeEventListener("mousedown",R),document.removeEventListener("touchstart",R)}},[oe,x,e.type]),T.useEffect(()=>{const R=se=>{$.current&&!$.current.contains(se.target)&&je(!1)};if(he)return document.addEventListener("mousedown",R),document.addEventListener("touchstart",R),()=>{document.removeEventListener("mousedown",R),document.removeEventListener("touchstart",R)}},[he]),T.useEffect(()=>{if(e.h&&e.h>0){Je(e.h);return}if(L.current){const R=new ResizeObserver(se=>{for(const D of se){const ee=D.target.scrollHeight,ve=Math.ceil(ee/Ea)*Ea;Je(ve)}});return R.observe(L.current),()=>R.disconnect()}},[e.data,e.h]);const ze=R=>{R.touches.length>=2||v==="edit"&&(tt||(R.preventDefault(),R.stopPropagation(),b(e.id)))},kn=R=>{v==="edit"&&!_t&&(R.preventDefault(),R.stopPropagation(),b(e.id))},_t=me||tt,ra=()=>{X(!0),m(e.id)},na=()=>{X(!1),m(null)},Tr=R=>Math.round(R/Ea)*Ea,oa=(()=>{if(e.w)return e.w;if(e.type==="TABLE"){const se=(e.data.columns||["Item","Qty","Weight"]).length,ve=Math.max(200,se*80+40);return Tr(ve)}return 200})(),aa=T.useCallback(R=>{R.preventDefault(),R.stopPropagation(),e.groupId&&c(e.id,e.id);const se="touches"in R?R.touches[0].clientX:R.clientX,D="touches"in R?R.touches[0].clientY:R.clientY,ee=e.w||200,ve=e.h||120;le.current={mouseX:se,mouseY:D,width:ee,height:ve},xe(!0)},[e.w,e.h,e.groupId,e.id,c]),tn=T.useCallback(R=>{if(!pe)return;const se="touches"in R?R.touches[0].clientX:R.clientX,D="touches"in R?R.touches[0].clientY:R.clientY,ee=(se-le.current.mouseX)/t,ve=(D-le.current.mouseY)/t,ye=Tr(Math.max(tr.width,le.current.width+ee)),Ce=Tr(Math.max(tr.height,le.current.height+ve));o(e.id,ye,Ce)},[pe,t,tr,e.id,o]),mr=T.useCallback(()=>{xe(!1)},[]);T.useEffect(()=>{if(pe)return window.addEventListener("mousemove",tn),window.addEventListener("mouseup",mr),window.addEventListener("touchmove",tn),window.addEventListener("touchend",mr),()=>{window.removeEventListener("mousemove",tn),window.removeEventListener("mouseup",mr),window.removeEventListener("touchmove",tn),window.removeEventListener("touchend",mr)}},[pe,tn,mr]);const sa=(R,se)=>{qe.current={x:se.x,y:se.y}},jn=(R,se)=>{if(e.groupId){const D=se.x-qe.current.x,ee=se.y-qe.current.y;document.querySelectorAll(`[data-group-id="${e.groupId}"]`).forEach(ye=>{const Ce=ye.getAttribute("data-widget-id");if(Ce&&Ce!==e.id){const fr=q.getState().getWidgetsInGroup(e.groupId).find(we=>we.id===Ce);fr&&(ye.style.transform=`translate(${fr.x+D}px, ${fr.y+ee}px)`)}})}},$s=(R,se)=>{const D=Tr(se.x),ee=Tr(se.y);if(e.groupId){const ve=D-e.x,ye=ee-e.y;(ve!==0||ye!==0)&&a(e.id,ve,ye)}else n(e.id,D,ee)},rr=e.h&&e.h>0?e.h:Ie,Nn=P?((Er=P.sheets.find(R=>R.id===P.activeSheetId))==null?void 0:Er.widgets)||[]:[],rn=T.useMemo(()=>{const R={topLeft:!0,topRight:!0,bottomLeft:!0,bottomRight:!0};if(!e.attachedTo||e.attachedTo.length===0)return R;const se=e.w||200,D=rr||120,ee={left:e.x,right:e.x+se,top:e.y,bottom:e.y+D};for(const ve of e.attachedTo){const ye=Nn.find(Ir=>Ir.id===ve);if(!ye)continue;const Ce=document.querySelector(`[data-widget-id="${ve}"]`),wt=ye.w||(Ce?Ce.offsetWidth:200),fr=ye.h||(Ce?Ce.offsetHeight:120),we={left:ye.x,right:ye.x+wt,top:ye.y,bottom:ye.y+fr};Math.abs(we.right-ee.left)<=Ye&&(we.top<=ee.top+Ye&&we.bottom>=ee.top-Ye&&(R.topLeft=!1),we.top<=ee.bottom+Ye&&we.bottom>=ee.bottom-Ye&&(R.bottomLeft=!1)),Math.abs(we.left-ee.right)<=Ye&&(we.top<=ee.top+Ye&&we.bottom>=ee.top-Ye&&(R.topRight=!1),we.top<=ee.bottom+Ye&&we.bottom>=ee.bottom-Ye&&(R.bottomRight=!1)),Math.abs(we.bottom-ee.top)<=Ye&&(we.left<=ee.left+Ye&&we.right>=ee.left-Ye&&(R.topLeft=!1),we.left<=ee.right+Ye&&we.right>=ee.right-Ye&&(R.topRight=!1)),Math.abs(we.top-ee.bottom)<=Ye&&(we.left<=ee.left+Ye&&we.right>=ee.left-Ye&&(R.bottomLeft=!1),we.left<=ee.right+Ye&&we.right>=ee.right-Ye&&(R.bottomRight=!1))}return R},[e.attachedTo,e.x,e.y,e.w,rr,Nn]),Sn=T.useMemo(()=>{const R="var(--border-radius)",se="0px";return{borderTopLeftRadius:rn.topLeft?R:se,borderTopRightRadius:rn.topRight?R:se,borderBottomLeftRadius:rn.bottomLeft?R:se,borderBottomRightRadius:rn.bottomRight?R:se}},[rn]),As=T.useMemo(()=>{if(!e.groupId)return{backgroundSize:"cover",backgroundPosition:"center"};const R=Nn.filter(we=>we.groupId===e.groupId);if(R.length<=1)return{backgroundSize:"cover",backgroundPosition:"center"};let se=1/0,D=1/0,ee=-1/0,ve=-1/0;for(const we of R){const Ir=document.querySelector(`[data-widget-id="${we.id}"]`),wf=we.w||(Ir?Ir.offsetWidth:200),kf=we.h||(Ir?Ir.offsetHeight:120);se=Math.min(se,we.x),D=Math.min(D,we.y),ee=Math.max(ee,we.x+wf),ve=Math.max(ve,we.y+kf)}const ye=ee-se,Ce=ve-D,wt=e.x-se,fr=e.y-D;return{backgroundSize:`${ye}px ${Ce}px`,backgroundPosition:`-${wt}px -${fr}px`}},[e.groupId,e.x,e.y,e.w,rr,Nn]),la=()=>{const se={widget:e,mode:v==="print"?"print":"play",width:oa,height:rr||120};switch(e.type){case"NUMBER":return r.jsx(uc,{...se});case"NUMBER_DISPLAY":return r.jsx(hc,{...se});case"LIST":return r.jsx(mc,{...se});case"TEXT":return r.jsx(fc,{...se});case"CHECKBOX":return r.jsx(pc,{...se});case"HEALTH_BAR":return r.jsx(xc,{...se});case"DICE_ROLLER":return r.jsx(gc,{...se});case"DICE_TRAY":return r.jsx(bc,{...se});case"SPELL_SLOT":return r.jsx(vc,{...se});case"IMAGE":return r.jsx(yc,{...se});case"POOL":return r.jsx(wc,{...se});case"TOGGLE_GROUP":return r.jsx(kc,{...se});case"TABLE":return r.jsx(jc,{...se});case"TIME_TRACKER":return r.jsx(Nc,{...se});case"FORM":return r.jsx(Sc,{...se});case"REST_BUTTON":return r.jsx(Cc,{...se});case"PROGRESS_BAR":return r.jsx(Tc,{...se});case"MAP_SKETCHER":return r.jsx(Ec,{...se});case"ROLL_TABLE":return r.jsx(Ic,{...se});case"INITIATIVE_TRACKER":return r.jsx(Mc,{...se});case"DECK":return r.jsx(Pc,{...se});default:return null}};return r.jsxs(r.Fragment,{children:[r.jsx(S0,{nodeRef:L,position:{x:e.x,y:e.y},onStart:sa,onDrag:jn,onStop:$s,scale:t,handle:".drag-handle",disabled:v==="play"||v==="print",children:r.jsxs("div",{ref:L,"data-widget-id":e.id,"data-group-id":e.groupId||"",className:`react-draggable absolute bg-theme-paper border-[length:var(--border-width)] border-theme-border p-1 cursor-default group ${pe?"select-none":""} ${v==="print"&&!ue?"pointer-events-none":""}`,style:{width:`${oa}px`,minWidth:`${tr.width}px`,height:rr?`${rr}px`:"auto",minHeight:rr?`${rr}px`:Ie?`${Ie}px`:"auto",zIndex:oe?200:he?9999:_t&&v==="print"&&ue?9998:_t&&v==="edit"?100:void 0,...Sn,...N?{borderWidth:"0px"}:{}},onMouseEnter:()=>be(!0),onMouseLeave:()=>be(!1),onTouchStart:ze,onClick:kn,children:[V&&r.jsx("div",{className:"absolute inset-0 pointer-events-none z-0 overflow-hidden",style:{backgroundColor:"var(--color-paper)",...Sn},children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url(${Jt[O]})`,...As,filter:"grayscale(100%)",opacity:"var(--card-texture-opacity)",mixBlendMode:"overlay"}})}),v==="edit"&&r.jsx("div",{className:"drag-handle absolute -top-2 left-8 right-8 h-8 bg-transparent cursor-move hover:opacity-70 active:opacity-50 flex justify-center items-center touch-none rounded-t-theme z-[60]",children:_t&&r.jsx("div",{className:"flex gap-1",children:r.jsx("div",{className:"w-8 h-1 bg-theme-muted/50 rounded-full"})})}),v==="edit"&&(_t||oe||x===16&&e.type==="FORM")&&(x===null||x>=16)&&r.jsxs("div",{className:"absolute -top-3 -right-3 z-[200] flex items-center gap-1",ref:J,children:[r.jsx("button",{"data-tutorial":e.type==="FORM"?"widget-menu-FORM":void 0,className:`w-8 h-8 bg-theme-accent text-theme-paper rounded-full flex items-center justify-center transition-opacity hover:bg-theme-accent/80 text-lg ${x===16&&e.type==="FORM"?"outline outline-4 outline-blue-500 outline-offset-2":""}`,onClick:R=>{var se;R.stopPropagation(),x===16&&e.type==="FORM"&&((se=_e[16])==null?void 0:se.id)==="widget-menu"&&j(),H(!oe),oe&&(Se(!1),Ae(!1),ae(""),ce(!1),Te(!1),K(!1),W(""),re(!1),fe("widget"))},onMouseDown:R=>R.stopPropagation(),onTouchStart:R=>R.stopPropagation(),title:"Widget options",children:""}),oe&&r.jsxs("div",{className:"absolute top-full right-0 mt-1 bg-theme-paper border-[length:var(--border-width)] border-theme-border rounded-theme shadow-theme min-w-[160px] overflow-hidden z-[200] font-body",children:[e.groupId&&r.jsxs("div",{className:"flex border-b border-theme-border",children:[r.jsx("button",{className:`flex-1 px-3 py-1.5 text-xs font-semibold transition-colors ${te==="widget"?"bg-theme-accent text-theme-paper":"text-theme-muted hover:bg-theme-border/30"}`,onClick:R=>{R.stopPropagation(),fe("widget"),Se(!1),Ae(!1),ce(!1),Te(!1),K(!1),re(!1)},children:"Widget"}),r.jsxs("button",{className:`flex-1 px-3 py-1.5 text-xs font-semibold transition-colors flex items-center justify-center gap-1 ${te==="group"?"bg-theme-accent text-theme-paper":"text-theme-muted hover:bg-theme-border/30"}`,onClick:R=>{R.stopPropagation(),fe("group"),Se(!1),Ae(!1),ce(!1),Te(!1),K(!1),re(!1)},children:[r.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]}),"Group"]})]}),te==="widget"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{"data-tutorial":e.type==="FORM"?"edit-button-FORM":void 0,className:`w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2 ${x===17&&e.type==="FORM"?"bg-blue-500 text-white":""}`,onClick:R=>{var se;R.stopPropagation(),x===17&&e.type==="FORM"&&((se=_e[17])==null?void 0:se.id)==="edit-widget"&&j(),H(!1),ra()},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Edit"]}),r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),H(!1),i(e.id)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2"}),r.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),"Clone"]}),r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),H(!1),l(e.id)},children:[e.locked?r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}):r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),e.locked?"Unlock":"Lock"]}),Qe?r.jsxs("div",{className:"px-2 py-2",children:[r.jsx("input",{type:"text",value:G,onChange:R=>ae(R.target.value),placeholder:"Template name...",className:"w-full px-2 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink mb-2",autoFocus:!0,onClick:R=>R.stopPropagation(),onKeyDown:R=>{R.stopPropagation(),R.key==="Enter"&&G.trim()?(k(e,G.trim()),H(!1),Ae(!1),ae("")):R.key==="Escape"&&(Ae(!1),ae(""))}}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{className:"flex-1 px-2 py-1 text-xs bg-theme-accent text-theme-paper rounded hover:bg-theme-accent/80 transition-colors",onClick:R=>{R.stopPropagation(),G.trim()&&(k(e,G.trim()),H(!1),Ae(!1),ae(""))},children:"Save"}),r.jsx("button",{className:"flex-1 px-2 py-1 text-xs text-theme-muted hover:bg-theme-border/50 rounded transition-colors",onClick:R=>{R.stopPropagation(),Ae(!1),ae("")},children:"Cancel"})]})]}):r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),ae(e.data.label||""),Ae(!0)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),r.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),r.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"Save as Template"]}),I&&r.jsx(r.Fragment,{children:de?r.jsxs("div",{className:"px-2 py-2",children:[r.jsx("div",{className:"text-xs text-theme-muted mb-2",children:"Select target sheet:"}),z.filter(R=>R.id!==(P==null?void 0:P.activeSheetId)).map(R=>r.jsx("button",{className:"w-full px-2 py-1.5 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors rounded mb-1",onClick:se=>{se.stopPropagation(),u(e.id,R.id),H(!1),ce(!1)},children:R.name},R.id)),r.jsx("button",{className:"w-full px-2 py-1 text-xs text-theme-muted hover:bg-theme-border/50 rounded transition-colors mt-1",onClick:R=>{R.stopPropagation(),ce(!1)},children:"Cancel"})]}):r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),ce(!0)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]}),"Move to Sheet"]})}),e.groupId&&r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),H(!1),c(e.id,e.id)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M18 6L6 18"}),r.jsx("path",{d:"M6 6l12 12"})]}),"Detach from Group"]}),r.jsx("div",{className:"border-t border-theme-border"}),$e?r.jsxs("div",{className:"flex",children:[r.jsx("button",{className:"flex-1 px-3 py-2 text-sm text-red-500 hover:bg-red-500 hover:text-white transition-colors font-bold",onClick:R=>{R.stopPropagation(),H(!1),Se(!1),s(e.id)},children:"Confirm"}),r.jsx("button",{className:"flex-1 px-3 py-2 text-sm text-theme-muted hover:bg-theme-accent hover:text-theme-paper transition-colors",onClick:R=>{R.stopPropagation(),Se(!1)},children:"Cancel"})]}):r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-red-500 hover:bg-red-500 hover:text-white transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),Se(!0)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),r.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),r.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"Delete"]})]}),te==="group"&&e.groupId&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),H(!1),g(e.groupId)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2"}),r.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),"Clone Group"]}),r.jsx("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),H(!1),w(e.groupId)},children:(()=>{const R=h(e.groupId);return R.length>0&&R.every(D=>D.locked)?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),"Unlock Group"]}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Lock Group"]})})()}),Q?r.jsxs("div",{className:"px-2 py-2",children:[r.jsx("input",{type:"text",value:Z,onChange:R=>W(R.target.value),placeholder:"Group template name...",className:"w-full px-2 py-1 text-sm border border-theme-border rounded bg-theme-paper text-theme-ink mb-2",autoFocus:!0,onClick:R=>R.stopPropagation(),onKeyDown:R=>{if(R.stopPropagation(),R.key==="Enter"&&Z.trim()){const se=h(e.groupId);C(se,Z.trim()),H(!1),K(!1),W("")}else R.key==="Escape"&&(K(!1),W(""))}}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{className:"flex-1 px-2 py-1 text-xs bg-theme-accent text-theme-paper rounded hover:bg-theme-accent/80 transition-colors",onClick:R=>{if(R.stopPropagation(),Z.trim()){const se=h(e.groupId);C(se,Z.trim()),H(!1),K(!1),W("")}},children:"Save"}),r.jsx("button",{className:"flex-1 px-2 py-1 text-xs text-theme-muted hover:bg-theme-border/50 rounded transition-colors",onClick:R=>{R.stopPropagation(),K(!1),W("")},children:"Cancel"})]})]}):r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),W(""),K(!0)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),r.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),r.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"Save as Template"]}),I&&r.jsx(r.Fragment,{children:B?r.jsxs("div",{className:"px-2 py-2",children:[r.jsx("div",{className:"text-xs text-theme-muted mb-2",children:"Move group to:"}),z.filter(R=>R.id!==(P==null?void 0:P.activeSheetId)).map(R=>r.jsx("button",{className:"w-full px-2 py-1.5 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors rounded mb-1",onClick:se=>{se.stopPropagation(),S(e.groupId,R.id),H(!1),re(!1)},children:R.name},R.id)),r.jsx("button",{className:"w-full px-2 py-1 text-xs text-theme-muted hover:bg-theme-border/50 rounded transition-colors mt-1",onClick:R=>{R.stopPropagation(),re(!1)},children:"Cancel"})]}):r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),re(!0)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]}),"Move to Sheet"]})}),r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),H(!1),y(e.groupId)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M18 6L6 18"}),r.jsx("path",{d:"M6 6l12 12"})]}),"Detach All"]}),r.jsx("div",{className:"border-t border-theme-border"}),Ne?r.jsxs("div",{className:"flex",children:[r.jsx("button",{className:"flex-1 px-3 py-2 text-sm text-red-500 hover:bg-red-500 hover:text-white transition-colors font-bold",onClick:R=>{R.stopPropagation(),H(!1),Te(!1),f(e.groupId)},children:"Confirm"}),r.jsx("button",{className:"flex-1 px-3 py-2 text-sm text-theme-muted hover:bg-theme-accent hover:text-theme-paper transition-colors",onClick:R=>{R.stopPropagation(),Te(!1)},children:"Cancel"})]}):r.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-red-500 hover:bg-red-500 hover:text-white transition-colors flex items-center gap-2",onClick:R=>{R.stopPropagation(),Te(!0)},children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),r.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),r.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"Delete Group (",h(e.groupId).length,")"]})]})]})]}),v==="print"&&ue&&(_t||he)&&r.jsxs("div",{className:"absolute -top-3 -right-3 z-[9999]",ref:$,"data-print-hide":"true",children:[r.jsx("button",{className:"w-8 h-8 bg-theme-accent text-theme-paper rounded-full flex items-center justify-center transition-opacity hover:bg-theme-accent/80 text-sm",onClick:R=>{R.stopPropagation(),je(!he)},onMouseDown:R=>R.stopPropagation(),onTouchStart:R=>R.stopPropagation(),title:"Print settings",children:""}),he&&r.jsx("div",{className:"absolute top-full right-0 mt-1 bg-theme-paper border-[length:var(--border-width)] border-theme-border rounded-theme shadow-theme min-w-[160px] overflow-hidden z-[9999] p-2",children:(e.type==="NUMBER"||e.type==="NUMBER_DISPLAY")&&r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm text-theme-ink hover:bg-theme-accent/10 p-1 rounded",children:[r.jsx("input",{type:"checkbox",checked:((oo=e.data.printSettings)==null?void 0:oo.hideValues)??!1,onChange:R=>{Me(e.id,{printSettings:{...e.data.printSettings,hideValues:R.target.checked}})},className:"w-4 h-4 accent-theme-accent"}),"Hide values"]})})]}),v==="edit"&&tt&&r.jsx("div",{className:"absolute inset-0 z-40 bg-theme-accent/10",style:Sn,onTouchStart:R=>R.stopPropagation()}),v==="play"&&e.locked&&r.jsx("div",{className:"absolute inset-0 z-40 cursor-not-allowed",style:Sn,title:"This widget is locked",children:r.jsx("div",{className:"absolute top-1 right-1 text-theme-ink",children:r.jsxs("svg",{className:"w-2 h-2",fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})}),v==="edit"&&_t&&r.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 cursor-se-resize z-50 flex items-center justify-center",onMouseDown:aa,onTouchStart:aa,title:"Drag to resize",children:r.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",className:"text-theme-muted hover:text-theme-ink transition-colors",children:r.jsx("path",{d:"M10 2L2 10M10 6L6 10M10 10L10 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),r.jsx("div",{ref:Y,className:"h-full overflow-hidden relative z-10 pt-1 pl-1",children:la()})]})}),F&&r.jsx(iv,{widget:e,onClose:na})]})}function uv({widget:e,index:t,totalWidgets:n,isDragging:o,draggedIndex:a,dropTargetIndex:s,onDragStart:i,onDragOver:c,onDragEnd:l}){const u=T.useRef(null),h=q(I=>I.activeCharacterId),f=q(I=>I.characters).find(I=>I.id===h),w=f!=null&&f.theme?dr(f.theme):void 0,S=f!=null&&f.theme?Ms(f.theme):void 0,y=(w==null?void 0:w.cardTexture)||(S==null?void 0:S.cardTexture)||"none",v=Et(y),[m,d]=T.useState(null),[b,k]=T.useState(!1),[C,x]=T.useState(()=>{try{return localStorage.getItem(`ucs:vertical-collapsed:${e.id}`)==="true"}catch{return!1}});T.useEffect(()=>{try{localStorage.setItem(`ucs:vertical-collapsed:${e.id}`,String(C))}catch{}},[C,e.id]),T.useEffect(()=>{const I=L=>{x(L.detail)};return window.addEventListener("vertical-collapse-all",I),()=>{window.removeEventListener("vertical-collapse-all",I)}},[]);const j={CHECKBOX:"Checklist",TOGGLE_GROUP:"Conditions",DICE_ROLLER:"Dice Roller",DICE_TRAY:"Dice Tray",FORM:"Form",HEALTH_BAR:"Health Bar",IMAGE:"Image",INITIATIVE_TRACKER:"Initiative Tracker",LIST:"List",MAP_SKETCHER:"Map Sketcher",NUMBER_DISPLAY:"Number Display",NUMBER:"Number Tracker",POOL:"Resource Pool",PROGRESS_BAR:"Progress Bar",REST_BUTTON:"Rest Button",SPELL_SLOT:"Spell Slots",TABLE:"Table",TEXT:"Text Area",TIME_TRACKER:"Temporary Effects",ROLL_TABLE:"Roll Table",DECK:"Deck of Cards"},E=()=>e.data.label||j[e.type]||e.type,N=o&&a!==null&&s===t&&a>t,p=o&&a!==null&&s===t&&a<t,M=I=>{I.target.closest(".vertical-drag-handle")&&(k(!0),d(I.touches[0].clientY),i(t))},P=I=>{if(!b||m===null)return;const L=I.touches[0],Y=document.elementsFromPoint(L.clientX,L.clientY);for(const J of Y){const $=J.closest("[data-vertical-index]");if($){const F=parseInt($.getAttribute("data-vertical-index")||"0",10);F!==t&&c(F);break}}},A=()=>{b&&(k(!1),d(null),l())},_=I=>{if(!I.target.closest(".vertical-drag-handle")){I.preventDefault();return}I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("text/plain",t.toString()),i(t)},O=I=>{I.preventDefault(),I.dataTransfer.dropEffect="move",c(t)},V=()=>{l()},z=()=>{const I={widget:e,mode:"play",width:320,height:1e4};switch(e.type){case"NUMBER":return r.jsx(uc,{...I});case"NUMBER_DISPLAY":return r.jsx(hc,{...I});case"LIST":return r.jsx(mc,{...I});case"TEXT":return r.jsx(fc,{...I});case"CHECKBOX":return r.jsx(pc,{...I});case"HEALTH_BAR":return r.jsx(xc,{...I});case"DICE_ROLLER":return r.jsx(gc,{...I});case"DICE_TRAY":return r.jsx(bc,{...I});case"SPELL_SLOT":return r.jsx(vc,{...I});case"IMAGE":return r.jsx(yc,{...I});case"POOL":return r.jsx(wc,{...I});case"TOGGLE_GROUP":return r.jsx(kc,{...I});case"TABLE":return r.jsx(jc,{...I});case"TIME_TRACKER":return r.jsx(Nc,{...I});case"FORM":return r.jsx(Sc,{...I});case"REST_BUTTON":return r.jsx(Cc,{...I});case"PROGRESS_BAR":return r.jsx(Tc,{...I});case"MAP_SKETCHER":return r.jsx(Ec,{...I,height:300});case"ROLL_TABLE":return r.jsx(Ic,{...I});case"INITIATIVE_TRACKER":return r.jsx(Mc,{...I});case"DECK":return r.jsx(Pc,{...I});default:return null}};return r.jsxs("div",{ref:u,"data-vertical-index":t,className:`vertical-widget relative transition-all duration-200 ${o&&a===t?"opacity-50 scale-95":""}`,onDragOver:O,onDragEnd:V,onTouchStart:M,onTouchMove:P,onTouchEnd:A,children:[N&&r.jsx("div",{className:"absolute -top-2 left-0 right-0 h-1 bg-theme-accent rounded-full z-50"}),r.jsxs("div",{className:"bg-theme-paper border-[length:var(--border-width)] border-theme-border rounded-theme overflow-visible relative",children:[v&&r.jsx("div",{className:"absolute inset-0 pointer-events-none rounded-theme z-0 overflow-hidden",style:{backgroundColor:"var(--color-paper)"},children:r.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url(${Jt[y]})`,backgroundSize:"cover",filter:"grayscale(100%)",opacity:"var(--card-texture-opacity)",mixBlendMode:"overlay"}})}),r.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 relative z-20",children:[r.jsx("div",{className:"vertical-drag-handle cursor-grab active:cursor-grabbing flex items-center gap-2 touch-none select-none",draggable:!0,onDragStart:_,children:r.jsxs("svg",{width:"10",height:"16",viewBox:"0 0 10 16",className:"text-theme-muted flex-shrink-0",fill:"currentColor",children:[r.jsx("circle",{cx:"2",cy:"2",r:"1.5"}),r.jsx("circle",{cx:"8",cy:"2",r:"1.5"}),r.jsx("circle",{cx:"2",cy:"8",r:"1.5"}),r.jsx("circle",{cx:"8",cy:"8",r:"1.5"}),r.jsx("circle",{cx:"2",cy:"14",r:"1.5"}),r.jsx("circle",{cx:"8",cy:"14",r:"1.5"})]})}),e.locked&&r.jsxs("svg",{className:"w-3.5 h-3.5 text-theme-ink ml-1",fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),C&&r.jsx("span",{className:"text-xs font-bold text-theme-ink font-heading truncate flex-1 ml-2",children:E()}),!C&&r.jsx("div",{className:"flex-1"}),r.jsx("button",{onClick:()=>x(!C),className:"w-6 h-6 flex items-center justify-center text-theme-muted hover:text-theme-ink transition-colors",children:r.jsx("span",{className:`transform transition-transform ${C?"":"rotate-180"}`,children:""})})]}),!C&&r.jsx("div",{className:`relative px-3 pb-2 ${e.locked?"pointer-events-none opacity-70":""}`,children:z()})]}),p&&r.jsx("div",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-theme-accent rounded-full z-50"}),t<n-1&&r.jsx("div",{className:"h-px bg-theme-border/30 my-1"})]})}const Ia=10,Ma=20;function hv({widgets:e,scale:t}){const n=q(m=>m.attachWidgets),o=q(m=>m.detachWidgets),a=q(m=>m.selectedWidgetId),[s,i]=T.useState(0),[c,l]=T.useState(!1),[u,h]=T.useState(null),g=a||u,f=e.map(m=>`${m.id}:${m.x}:${m.y}:${m.groupId||""}`).join("|");T.useEffect(()=>{const m=()=>{const b=document.querySelector(".react-draggable-dragging");l(!!b)},d=new MutationObserver(m);return d.observe(document.body,{subtree:!0,attributes:!0,attributeFilter:["class"]}),()=>d.disconnect()},[]),T.useEffect(()=>{const m=b=>{const k=b.target;if(k.closest("[data-attach-widget-ids]"))return;const x=k.closest("[data-widget-id]");h(x?x.getAttribute("data-widget-id"):null)},d=b=>{const k=b.target;if(k.closest("[data-attach-widget-ids]"))return;const x=k.closest("[data-widget-id]");h(x?x.getAttribute("data-widget-id"):null)};return document.addEventListener("mouseover",m),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mouseover",m),document.removeEventListener("touchstart",d)}},[]),T.useEffect(()=>{const m=setTimeout(()=>{i(d=>d+1)},100);return()=>clearTimeout(m)},[f,t]);const w=T.useMemo(()=>{const m=[];return e.forEach(d=>{const b=document.querySelector(`[data-widget-id="${d.id}"]`);if(b){const k=b.getBoundingClientRect();m.push({id:d.id,groupId:d.groupId,attachedTo:d.attachedTo,left:d.x,right:d.x+k.width/t,top:d.y,bottom:d.y+k.height/t})}}),m},[e,t,s]),S=T.useMemo(()=>{var d,b;const m=[];for(let k=0;k<w.length;k++)for(let C=k+1;C<w.length;C++){const x=w[k],j=w[C],E=!!((d=x.attachedTo)!=null&&d.includes(j.id)||(b=j.attachedTo)!=null&&b.includes(x.id));if(Math.abs(x.right-j.left)<=Ia){const N=Math.max(x.top,j.top),p=Math.min(x.bottom,j.bottom);p-N>=Ma&&m.push({widget1Id:x.id,widget2Id:j.id,x:x.right,y:(N+p)/2,orientation:"vertical",direction:"right",isAttached:E})}if(Math.abs(x.left-j.right)<=Ia){const N=Math.max(x.top,j.top),p=Math.min(x.bottom,j.bottom);p-N>=Ma&&m.push({widget1Id:x.id,widget2Id:j.id,x:x.left,y:(N+p)/2,orientation:"vertical",direction:"left",isAttached:E})}if(Math.abs(x.bottom-j.top)<=Ia){const N=Math.max(x.left,j.left),p=Math.min(x.right,j.right);p-N>=Ma&&m.push({widget1Id:x.id,widget2Id:j.id,x:(N+p)/2,y:x.bottom,orientation:"horizontal",direction:"down",isAttached:E})}if(Math.abs(x.top-j.bottom)<=Ia){const N=Math.max(x.left,j.left),p=Math.min(x.right,j.right);p-N>=Ma&&m.push({widget1Id:x.id,widget2Id:j.id,x:(N+p)/2,y:x.top,orientation:"horizontal",direction:"up",isAttached:E})}}return m},[w]),y=m=>{if(m.isAttached){const d=g===m.widget1Id?m.widget1Id:g===m.widget2Id?m.widget2Id:m.widget1Id;o(d,m.widget2Id)}else{const d=w.find(j=>j.id===m.widget1Id),b=w.find(j=>j.id===m.widget2Id);if(!d||!b){n(m.widget1Id,m.widget2Id);return}let k,C;if(b.groupId&&!d.groupId)k=d.id,C=b.groupId;else if(d.groupId&&!b.groupId)k=b.id,C=d.groupId;else if(d.groupId&&b.groupId&&d.groupId!==b.groupId){n(m.widget1Id,m.widget2Id);return}else{n(m.widget1Id,m.widget2Id);return}const x=S.filter(j=>{if(j.isAttached)return!1;const E=w.find(p=>p.id===j.widget1Id),N=w.find(p=>p.id===j.widget2Id);return!E||!N?!1:j.widget1Id===k&&N.groupId===C||j.widget2Id===k&&E.groupId===C});for(const j of x)n(j.widget1Id,j.widget2Id)}};if(c)return null;const v=g?S.filter(m=>m.widget1Id===g||m.widget2Id===g):[];return r.jsx(r.Fragment,{children:v.map((m,d)=>{const b=()=>{if(m.isAttached)return"";if(g===m.widget1Id)switch(m.direction){case"right":return"";case"left":return"";case"down":return"";case"up":return""}else switch(m.direction){case"right":return"";case"left":return"";case"down":return"";case"up":return""}};return r.jsx("button",{"data-attach-widget-ids":`${m.widget1Id},${m.widget2Id}`,className:`absolute w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold transition-all transform -translate-x-1/2 -translate-y-1/2 hover:scale-125 ${m.isAttached?"bg-green-500 hover:bg-red-500 text-white":"bg-blue-500 hover:bg-green-500 text-white"}`,style:{left:`${m.x}px`,top:`${m.y}px`,zIndex:100},onClick:()=>y(m),onMouseDown:k=>k.stopPropagation(),onTouchStart:k=>k.stopPropagation(),title:m.isAttached?"Click to detach widgets":"Click to attach widgets",children:b()},`${m.widget1Id}-${m.widget2Id}-${d}`)})})}const Xe=10;function mv(e,t){const n={topLeft:!0,topRight:!0,bottomLeft:!0,bottomRight:!0};if(!e.attachedTo||e.attachedTo.length===0)return n;const o={left:e.x,right:e.x+e.width,top:e.y,bottom:e.y+e.height};for(const a of e.attachedTo){const s=t.find(c=>c.id===a);if(!s)continue;const i={left:s.x,right:s.x+s.width,top:s.y,bottom:s.y+s.height};Math.abs(i.right-o.left)<=Xe&&(i.top<=o.top+Xe&&i.bottom>=o.top-Xe&&(n.topLeft=!1),i.top<=o.bottom+Xe&&i.bottom>=o.bottom-Xe&&(n.bottomLeft=!1)),Math.abs(i.left-o.right)<=Xe&&(i.top<=o.top+Xe&&i.bottom>=o.top-Xe&&(n.topRight=!1),i.top<=o.bottom+Xe&&i.bottom>=o.bottom-Xe&&(n.bottomRight=!1)),Math.abs(i.bottom-o.top)<=Xe&&(i.left<=o.left+Xe&&i.right>=o.left-Xe&&(n.topLeft=!1),i.left<=o.right+Xe&&i.right>=o.right-Xe&&(n.topRight=!1)),Math.abs(i.top-o.bottom)<=Xe&&(i.left<=o.left+Xe&&i.right>=o.left-Xe&&(n.bottomLeft=!1),i.left<=o.right+Xe&&i.right>=o.right-Xe&&(n.bottomRight=!1))}return n}function fv(e){const t="var(--border-radius)",n="0px";return{borderTopLeftRadius:e.topLeft?t:n,borderTopRightRadius:e.topRight?t:n,borderBottomLeftRadius:e.bottomLeft?t:n,borderBottomRightRadius:e.bottomRight?t:n}}function pv({widgets:e,scale:t}){const[n,o]=T.useState([]),[a,s]=T.useState(!1),i=e.map(l=>`${l.id}:${l.x}:${l.y}:${(l.attachedTo||[]).join(",")}`).join("|");T.useEffect(()=>{const l=()=>{const h=document.querySelector(".react-draggable-dragging");s(!!h)},u=new MutationObserver(l);return u.observe(document.body,{subtree:!0,attributes:!0,attributeFilter:["class"]}),()=>u.disconnect()},[]),T.useEffect(()=>{const l=setTimeout(()=>{const u=[];e.forEach(h=>{const g=document.querySelector(`[data-widget-id="${h.id}"]`);if(g){const f=g.getBoundingClientRect();u.push({id:h.id,x:h.x,y:h.y,width:f.width/t,height:f.height/t,attachedTo:h.attachedTo})}}),o(u)},50);return()=>clearTimeout(l)},[e,t,i]);const c=T.useMemo(()=>{const l={};return n.forEach(u=>{const h=mv(u,n);l[u.id]=fv(h)}),l},[n]);return a?null:r.jsx("div",{className:"pointer-events-none",children:n.map(l=>r.jsx("div",{className:"absolute shadow-theme glow-theme",style:{left:`${l.x}px`,top:`${l.y}px`,width:`${l.width}px`,height:`${l.height}px`,...c[l.id]}},`shadow-${l.id}`))})}function xv({scale:e}){const t=ht(f=>f.printArea),n=ht(f=>f.setPrintArea),[o,a]=T.useState(null),s=T.useRef({mouseX:0,mouseY:0,area:{x:0,y:0,width:0,height:0}}),i=T.useCallback((f,w)=>{if(f.preventDefault(),f.stopPropagation(),!t)return;let S,y;"touches"in f?(S=f.touches[0].clientX,y=f.touches[0].clientY):(S=f.clientX,y=f.clientY),s.current={mouseX:S,mouseY:y,area:{...t}},a(w)},[t]),c=T.useCallback((f,w)=>{if(!o||!t)return;const S=(f-s.current.mouseX)/e,y=(w-s.current.mouseY)/e,{area:v}=s.current,m={...v};switch(o){case"n":m.y=v.y+y,m.height=v.height-y;break;case"s":m.height=v.height+y;break;case"e":m.width=v.width+S;break;case"w":m.x=v.x+S,m.width=v.width-S;break;case"ne":m.y=v.y+y,m.height=v.height-y,m.width=v.width+S;break;case"nw":m.x=v.x+S,m.width=v.width-S,m.y=v.y+y,m.height=v.height-y;break;case"se":m.width=v.width+S,m.height=v.height+y;break;case"sw":m.x=v.x+S,m.width=v.width-S,m.height=v.height+y;break}m.width<100&&(m.width=100,o.includes("w")&&(m.x=v.x+v.width-100)),m.height<100&&(m.height=100,o.includes("n")&&(m.y=v.y+v.height-100)),n(m)},[o,t,e,n]),l=T.useCallback(f=>{c(f.clientX,f.clientY)},[c]),u=T.useCallback(f=>{f.touches.length===1&&(f.preventDefault(),c(f.touches[0].clientX,f.touches[0].clientY))},[c]),h=T.useCallback(()=>{a(null)},[]);if(T.useEffect(()=>{if(o)return window.addEventListener("mousemove",l),window.addEventListener("mouseup",h),window.addEventListener("touchmove",u,{passive:!1}),window.addEventListener("touchend",h),window.addEventListener("touchcancel",h),()=>{window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",h),window.removeEventListener("touchmove",u),window.removeEventListener("touchend",h),window.removeEventListener("touchcancel",h)}},[o,l,u,h]),!t)return null;const g="absolute w-5 h-5 bg-blue-500 border-2 border-white rounded-full shadow-md hover:scale-125 transition-transform touch-none";return r.jsxs("div",{className:"absolute pointer-events-none print-area-overlay",style:{left:t.x,top:t.y,width:t.width,height:t.height},children:[r.jsxs("div",{className:"absolute inset-0 border-2 border-blue-500 border-dashed rounded-sm",children:[r.jsx("div",{className:`${g} -top-2.5 -left-2.5 cursor-nw-resize pointer-events-auto`,onMouseDown:f=>i(f,"nw"),onTouchStart:f=>i(f,"nw")}),r.jsx("div",{className:`${g} -top-2.5 -right-2.5 cursor-ne-resize pointer-events-auto`,onMouseDown:f=>i(f,"ne"),onTouchStart:f=>i(f,"ne")}),r.jsx("div",{className:`${g} -bottom-2.5 -left-2.5 cursor-sw-resize pointer-events-auto`,onMouseDown:f=>i(f,"sw"),onTouchStart:f=>i(f,"sw")}),r.jsx("div",{className:`${g} -bottom-2.5 -right-2.5 cursor-se-resize pointer-events-auto`,onMouseDown:f=>i(f,"se"),onTouchStart:f=>i(f,"se")}),r.jsx("div",{className:`${g} -top-2.5 left-1/2 -translate-x-1/2 cursor-n-resize pointer-events-auto`,onMouseDown:f=>i(f,"n"),onTouchStart:f=>i(f,"n")}),r.jsx("div",{className:`${g} -bottom-2.5 left-1/2 -translate-x-1/2 cursor-s-resize pointer-events-auto`,onMouseDown:f=>i(f,"s"),onTouchStart:f=>i(f,"s")}),r.jsx("div",{className:`${g} top-1/2 -left-2.5 -translate-y-1/2 cursor-w-resize pointer-events-auto`,onMouseDown:f=>i(f,"w"),onTouchStart:f=>i(f,"w")}),r.jsx("div",{className:`${g} top-1/2 -right-2.5 -translate-y-1/2 cursor-e-resize pointer-events-auto`,onMouseDown:f=>i(f,"e"),onTouchStart:f=>i(f,"e")})]}),r.jsxs("div",{className:"absolute -top-6 left-0 bg-blue-500 text-white text-xs px-2 py-0.5 rounded",children:["Print Area (",Math.round(t.width),"  ",Math.round(t.height),")"]})]})}const mu="ucs:darkMode";function gv(e){const t=e.sheets.find(n=>n.id===e.activeSheetId);return(t==null?void 0:t.widgets)||[]}function bv(){var oo,R,se;const e=q(D=>D.activeCharacterId),t=q(D=>D.characters),n=q(D=>D.addWidget),o=q(D=>D.mode),a=q(D=>D.setMode),s=q(D=>D.selectCharacter),i=q(D=>D.updateCharacterName),c=q(D=>D.editingWidgetId),l=q(D=>D.setSelectedWidgetId),u=q(D=>D.reorderWidget),h=q(D=>D.createSheet),g=q(D=>D.selectSheet),f=q(D=>D.deleteSheet),w=q(D=>D.renameSheet),S=q(D=>D.deleteCharacter),y=q(D=>D.createCharacterFromPreset),v=q(D=>D.updateCharacterTheme),m=q(D=>D.undo),d=q(D=>D.redo),b=sn(D=>e?D.canUndo(e):!1),k=sn(D=>e?D.canRedo(e):!1),C=t.find(D=>D.id===e),x=ot(D=>D.tutorialStep),j=ot(D=>D.advanceTutorial),{isActive:E}=rf("sheet"),N=ht(D=>D.printerFriendly),p=ht(D=>D.bordersDisabled),M=ht(D=>D.shadowsDisabled),P=ht(D=>D.printArea),A=ht(D=>D.previousMode),_=ht(D=>D.setPrinterFriendly),O=ht(D=>D.setBordersDisabled),V=ht(D=>D.setShadowsDisabled),z=ht(D=>D.setPrintArea),I=ht(D=>D.setPreviousMode),L=ht(D=>D.calculatePrintAreaFromWidgets),Y=ht(D=>D.resetPrintSettings),[J,$]=T.useState(()=>{const D=localStorage.getItem(mu);return D!==null?D==="true":window.matchMedia("(prefers-color-scheme: dark)").matches});T.useEffect(()=>{const D=ee=>{ee.key===mu&&$(ee.newValue==="true")};return window.addEventListener("storage",D),()=>window.removeEventListener("storage",D)},[]);const F=C?gv(C):[],[X,oe]=T.useState(!0),[H,he]=T.useState(!0),[je,$e]=T.useState(!1),[Se,Qe]=T.useState(""),[Ae,G]=T.useState(null),[ae,de]=T.useState(""),[ce,Ne]=T.useState(!1),[Te,Q]=T.useState(null),[K,Z]=T.useState(!1),[W,B]=T.useState(!1),[re,te]=T.useState(!1),[fe,me]=T.useState(null),[be,Ie]=T.useState(null),[Je,qe]=T.useState(!1),U=T.useRef(null),ue=T.useRef(null),Me=T.useCallback(()=>{l(null),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},[l]),{pan:pe,scale:xe,isPanning:le,setPan:tt,setScale:tr,handleMouseDown:ze,handleMouseMove:kn,handleMouseUp:_t,handleWheel:ra}=Pb({editingWidgetId:c,mode:o,onBackgroundClick:Me}),na=T.useRef(xe),Tr=T.useRef(pe);T.useEffect(()=>{na.current=xe},[xe]),T.useEffect(()=>{Tr.current=pe},[pe]);const Rc=T.useCallback(()=>na.current,[]),oa=T.useCallback(()=>Tr.current,[]),{isTouchPanning:aa}=Rb({mode:o,onPanChange:tt,onScaleChange:tr,onPinchingChange:qe,getScale:Rc,getPan:oa,onBackgroundTouch:Me}),{handleAutoStack:tn}=Db({widgets:F,scale:xe}),{handleFitAllWidgets:mr}=Lb({widgets:F,scale:xe,setScale:tr,setPan:tt});T.useEffect(()=>{const D=ee=>{ee.target instanceof HTMLInputElement||ee.target instanceof HTMLTextAreaElement||(ee.ctrlKey&&ee.key==="z"&&!ee.shiftKey&&(ee.preventDefault(),m()),(ee.ctrlKey&&ee.key==="y"||ee.ctrlKey&&ee.shiftKey&&ee.key==="z"||ee.ctrlKey&&ee.shiftKey&&ee.key==="Z")&&(ee.preventDefault(),d()))};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[m,d]);const sa=T.useCallback(()=>{I(o),a("print");const D=L(F);D&&z(D)},[o,a,I,L,F,z]),jn=T.useCallback(D=>{a(D||A||"play"),Y()},[A,a,Y]);T.useEffect(()=>{if(o==="print"&&!P&&F.length>0){const D=L(F);D&&z(D)}},[o,P,F,L,z]),T.useEffect(()=>{if(o==="print"&&C){const D=document.documentElement,ee=C.theme||"default",ve=dr(ee);if(ve?Po(ve):Fr(ee),N){const ye=Nr.find(Ce=>Ce.id==="default");ye&&(D.style.setProperty("--color-background",ye.colors.background),D.style.setProperty("--color-paper",ye.colors.paper),D.style.setProperty("--color-ink",ye.colors.ink),D.style.setProperty("--color-accent",ye.colors.accent),D.style.setProperty("--color-accent-hover",ye.colors.accentHover),D.style.setProperty("--color-border",ye.colors.border),D.style.setProperty("--color-shadow",ye.colors.shadow),D.style.setProperty("--color-muted",ye.colors.muted),D.style.setProperty("--color-glow",ye.colors.glow))}D.style.setProperty("--card-texture-key","none"),D.style.setProperty("--card-texture","none"),M&&D.style.setProperty("--shadow-style","none")}},[o,C,N,p,M]),T.useEffect(()=>{if(o!=="print"&&C){const D=C.theme||"default",ee=dr(D);ee?Po(ee):Fr(D)}},[o,C==null?void 0:C.theme]);const $s=T.useCallback(()=>{if(!P)return;const D=document.querySelector(".print-canvas-content");if(!D)return;const ee=D.cloneNode(!0);ee.querySelectorAll(".print-area-overlay").forEach(wt=>wt.remove()),ee.querySelectorAll('[data-print-hide="true"]').forEach(wt=>{wt.remove()}),ee.style.transform=`translate(${-P.x}px, ${-P.y}px)`,ee.style.position="absolute",ee.style.left="0",ee.style.top="0";const Ce=document.createElement("div");Ce.className="print-content-wrapper",Ce.style.width=`${P.width}px`,Ce.style.height=`${P.height}px`,Ce.style.overflow="hidden",Ce.style.position="relative",Ce.style.background="var(--color-paper)",Ce.appendChild(ee),document.body.appendChild(Ce),window.print(),setTimeout(()=>{document.body.removeChild(Ce)},100)},[P]);T.useEffect(()=>{var D;if(x===23&&((D=_e[23])==null?void 0:D.id)==="switch-to-play"){const ee=e;y(Tb,"Tutorial Character"),ee&&S(ee),setTimeout(()=>{const ve=q.getState().activeCharacterId;ve&&J&&v(ve,"classic-dark")},0),a("edit"),setTimeout(()=>{mr()},200)}},[x]),T.useEffect(()=>{var ye,Ce,wt;const D=window.innerWidth<640,ee=x===3&&((ye=_e[3])==null?void 0:ye.id)==="welcome-sheet"||x===23&&((Ce=_e[23])==null?void 0:Ce.id)==="switch-to-play",ve=x===4&&((wt=_e[4])==null?void 0:wt.id)==="add-widget";D&&(ee||ve)&&Z(!0)},[x]),T.useEffect(()=>{if(e&&F.length>0){const D=setTimeout(()=>{mr()},100);return()=>clearTimeout(D)}},[e,C==null?void 0:C.activeSheetId]),T.useEffect(()=>{if(C){const D=C.theme||"default",ee=dr(D);ee?Po(ee):Fr(D)}return()=>{Fr("default")}},[C==null?void 0:C.theme,C==null?void 0:C.id]);const rr=D=>{D.preventDefault(),D.dataTransfer.dropEffect="copy"},Nn=D=>{D.preventDefault();const ee=D.dataTransfer.getData("widgetType");if(ee){const ve=(D.clientX-pe.x)/xe,ye=(D.clientY-pe.y)/xe,Ce=10,wt=Ir=>Math.round(Ir/Ce)*Ce,fr=wt(ve),we=wt(ye);n(ee,fr,we)}},rn=D=>{me(D),Ie(D)},Sn=D=>{Ie(D)},As=()=>{if(fe!==null&&be!==null&&fe!==be){const D=F[fe];D&&u(D.id,be)}me(null),Ie(null)};if(!C)return null;const[la,Er]=T.useState(!1);return o==="vertical"?r.jsxs("div",{className:"w-full h-screen overflow-hidden relative bg-theme-background flex flex-col",children:[r.jsxs("div",{className:"bg-theme-paper border-b-[length:var(--border-width)] border-theme-border px-2 py-2 flex items-center gap-2 z-30 shrink-0",children:[r.jsx("button",{onClick:()=>Er(!la),className:"sm:hidden w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink",children:""}),r.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[r.jsx("button",{onClick:()=>s(null),className:"h-8 px-3 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-red-500 text-xs font-body hover:bg-red-500 hover:text-white transition-colors",children:"Exit"}),r.jsx("button",{onClick:()=>a("edit"),className:"h-8 px-3 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"Edit Mode"}),r.jsx("button",{onClick:()=>a("play"),className:"h-8 px-3 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"Grid View"}),r.jsx("button",{onClick:m,disabled:!b,className:`w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${b?"text-theme-ink hover:bg-theme-accent hover:text-theme-paper":"text-theme-muted opacity-50 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M3 7v6h6"}),r.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),r.jsx("button",{onClick:d,disabled:!k,className:`w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${k?"text-theme-ink hover:bg-theme-accent hover:text-theme-paper":"text-theme-muted opacity-50 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M21 7v6h-6"}),r.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"})]})})]}),r.jsx("h1",{className:"font-bold text-sm text-theme-ink font-heading truncate flex-1 min-w-0",children:C.name}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>Ne(!ce),className:"h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-theme px-2 flex items-center gap-1 text-xs",children:[r.jsx("span",{className:"text-theme-ink truncate max-w-[60px]",children:((oo=C.sheets.find(D=>D.id===C.activeSheetId))==null?void 0:oo.name)||"Sheet"}),r.jsx("span",{className:"text-theme-muted",children:""})]}),ce&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>Ne(!1)}),r.jsx("div",{className:"absolute top-full right-0 mt-1 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-theme overflow-hidden z-50 min-w-[120px]",children:C.sheets.map(D=>r.jsx("button",{onClick:()=>{g(D.id),Ne(!1)},className:`w-full px-3 py-2 text-xs text-left font-body transition-colors ${D.id===C.activeSheetId?"bg-theme-accent text-theme-paper":"text-theme-ink hover:bg-theme-accent/20"}`,children:D.name},D.id))})]})]}),r.jsx("button",{onClick:()=>{F.forEach(D=>{localStorage.setItem(`ucs:vertical-collapsed:${D.id}`,"false")}),window.dispatchEvent(new CustomEvent("vertical-collapse-all",{detail:!1}))},className:"w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs",title:"Expand All",children:""}),r.jsx("button",{onClick:()=>{F.forEach(D=>{localStorage.setItem(`ucs:vertical-collapsed:${D.id}`,"true")}),window.dispatchEvent(new CustomEvent("vertical-collapse-all",{detail:!0}))},className:"w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs",title:"Collapse All",children:""}),r.jsxs("div",{className:"sm:hidden flex items-center gap-1",children:[r.jsx("button",{onClick:m,disabled:!b,className:`w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${b?"text-theme-ink hover:bg-theme-accent hover:text-theme-paper":"text-theme-muted opacity-50 cursor-not-allowed"}`,title:"Undo",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M3 7v6h6"}),r.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),r.jsx("button",{onClick:d,disabled:!k,className:`w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${k?"text-theme-ink hover:bg-theme-accent hover:text-theme-paper":"text-theme-muted opacity-50 cursor-not-allowed"}`,title:"Redo",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M21 7v6h-6"}),r.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"})]})})]})]}),la&&r.jsxs("div",{className:"sm:hidden",children:[r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>Er(!1)}),r.jsxs("div",{className:"absolute top-12 left-2 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-theme overflow-hidden z-50 flex flex-col",children:[r.jsx("button",{onClick:()=>{a("play"),Er(!1)},className:"px-4 py-2.5 text-sm text-left font-body text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors whitespace-nowrap",children:"Grid View"}),r.jsx("button",{onClick:()=>{a("edit"),Er(!1)},className:"px-4 py-2.5 text-sm text-left font-body text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors whitespace-nowrap",children:"Edit Mode"}),r.jsx("button",{onClick:()=>{s(null),Er(!1)},className:"px-4 py-2.5 text-sm text-left font-body text-red-500 hover:bg-red-500 hover:text-white transition-colors border-t border-theme-border/50 whitespace-nowrap",children:"Exit to Menu"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:r.jsxs("div",{className:"max-w-md mx-auto px-3 py-4 pb-24",children:[F.map((D,ee)=>r.jsx(uv,{widget:D,index:ee,totalWidgets:F.length,isDragging:fe!==null,draggedIndex:fe,dropTargetIndex:be,onDragStart:rn,onDragOver:Sn,onDragEnd:As},D.id)),F.length===0&&r.jsxs("div",{className:"text-center text-theme-muted py-12",children:[r.jsx("p",{className:"font-body",children:"No widgets on this sheet"}),r.jsx("p",{className:"text-sm mt-2",children:"Switch to Edit mode to add widgets"})]})]})})]}):r.jsxs("div",{ref:U,className:"w-full h-screen overflow-hidden relative bg-theme-background",children:[o==="edit"&&r.jsx(Ab,{collapsed:X,onToggle:()=>oe(!X),viewport:U.current?{pan:pe,scale:xe,width:U.current.clientWidth,height:U.current.clientHeight}:void 0}),o==="edit"&&r.jsx(Ob,{collapsed:H,onToggle:()=>he(!H)}),r.jsx("div",{className:`absolute inset-0 ${le||aa.current?"cursor-grabbing":"cursor-default"} ${Je?"pinch-active":""}`,onMouseDown:ze,onMouseMove:kn,onMouseUp:_t,onWheel:ra,onDragOver:o!=="print"?rr:void 0,onDrop:o!=="print"?Nn:void 0,children:r.jsxs("div",{ref:ue,className:`absolute top-0 left-0 w-full h-full origin-top-left print-canvas-content ${o==="print"?"pointer-events-auto":""}`,style:{transform:`translate(${pe.x}px, ${pe.y}px) scale(${xe})`},children:[o!=="play"&&o!=="print"&&r.jsx("div",{className:"absolute -top-[50000px] -left-[50000px] w-[100000px] h-[100000px] pattern-grid opacity-20 pointer-events-none"}),!(o==="print"&&M)&&r.jsx(pv,{widgets:F,scale:xe}),F.map(D=>r.jsx(dv,{widget:D,scale:xe},D.id)),o==="edit"&&r.jsx(hv,{widgets:F,scale:xe}),o==="print"&&r.jsx(xv,{scale:xe,pan:pe})]})}),o==="print"&&r.jsxs("div",{className:"absolute top-0 left-0 right-0 bg-theme-paper border-b-[length:var(--border-width)] border-theme-border px-2 py-2 flex items-center gap-2 z-30",children:[r.jsx("button",{onClick:()=>B(!W),className:"sm:hidden w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink shrink-0",children:""}),r.jsxs("div",{className:"hidden sm:flex items-center gap-1 shrink-0",children:[r.jsx("button",{onClick:()=>{Y(),s(null)},className:"px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-red-400 rounded-button text-red-600 text-xs font-body hover:bg-red-600 hover:text-white transition-colors",children:"Exit"}),r.jsx("button",{onClick:()=>jn("play"),className:"px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"Play Mode"}),r.jsx("button",{onClick:()=>jn("edit"),className:"px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"Edit Mode"}),r.jsx("div",{className:"w-px h-6 bg-theme-border"}),r.jsx("button",{onClick:()=>_(!N),className:`px-3 h-8 border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${N?"bg-theme-accent text-theme-paper":"bg-theme-background text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,title:"Use printer-friendly colors (black & white)",children:"Printer Friendly Theme"}),r.jsx("button",{onClick:()=>O(!p),className:`px-3 h-8 border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${p?"bg-theme-accent text-theme-paper":"bg-theme-background text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,title:"Hide widget borders",children:"No Borders"}),r.jsx("button",{onClick:()=>V(!M),className:`px-3 h-8 border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${M?"bg-theme-accent text-theme-paper":"bg-theme-background text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,title:"Hide widget shadows",children:"No Shadows"})]}),r.jsx("div",{className:"flex-1"}),r.jsxs("button",{onClick:$s,className:"px-4 h-8 bg-blue-500 text-white border-[length:var(--border-width)] border-blue-600 rounded-button text-xs font-body hover:bg-blue-600 transition-colors flex items-center gap-2",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[r.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),r.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),r.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),"Print"]})]}),W&&o==="print"&&r.jsxs("div",{className:"sm:hidden absolute top-12 left-2 bg-theme-paper border-[length:var(--border-width)] border-theme-border rounded-button shadow-theme z-40 overflow-hidden",children:[r.jsx("button",{onClick:()=>{Y(),s(null),B(!1)},className:"w-full px-4 py-2.5 text-sm text-left font-body text-red-600 hover:bg-red-600 hover:text-white transition-colors whitespace-nowrap",children:"Exit"}),r.jsx("div",{className:"border-t border-theme-border"}),r.jsx("button",{onClick:()=>{jn("play"),B(!1)},className:"w-full px-4 py-2.5 text-sm text-left font-body text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors whitespace-nowrap",children:"Play Mode"}),r.jsx("button",{onClick:()=>{jn("edit"),B(!1)},className:"w-full px-4 py-2.5 text-sm text-left font-body text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors whitespace-nowrap",children:"Edit Mode"}),r.jsx("div",{className:"border-t border-theme-border"}),r.jsxs("button",{onClick:()=>{_(!N),B(!1)},className:`w-full px-4 py-2.5 text-sm text-left font-body transition-colors whitespace-nowrap ${N?"bg-theme-accent text-theme-paper":"text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,children:["Printer Friendly Theme ",N?"":""]}),r.jsxs("button",{onClick:()=>{O(!p),B(!1)},className:`w-full px-4 py-2.5 text-sm text-left font-body transition-colors whitespace-nowrap ${p?"bg-theme-accent text-theme-paper":"text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,children:["No Borders ",p?"":""]}),r.jsxs("button",{onClick:()=>{V(!M),B(!1)},className:`w-full px-4 py-2.5 text-sm text-left font-body transition-colors whitespace-nowrap ${M?"bg-theme-accent text-theme-paper":"text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,children:["No Shadows ",M?"":""]})]}),o!=="print"&&r.jsxs("div",{className:"absolute top-0 left-0 right-0 bg-theme-paper border-b-[length:var(--border-width)] border-theme-border px-2 py-2 flex items-center gap-2 z-30 relative",children:[r.jsx("button",{onClick:()=>Z(!K),className:"lg:hidden w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink shrink-0",children:""}),r.jsxs("div",{className:"hidden lg:flex items-center gap-1 shrink-0",children:[r.jsx("button",{onClick:()=>s(null),className:"px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-red-500 text-xs font-body hover:bg-red-500 hover:text-white hover:border-red-700 transition-colors",children:"Exit"}),r.jsx("button",{"data-tutorial":"edit-mode-button",onClick:()=>{var ee,ve;const D=o==="play"?"edit":"play";a(D),x===3&&((ee=_e[3])==null?void 0:ee.id)==="welcome-sheet"&&D==="edit"&&j(),x===23&&((ve=_e[23])==null?void 0:ve.id)==="switch-to-play"&&D==="play"&&j()},className:`px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors ${x===3&&o==="play"||x===23&&o==="edit"?"outline outline-4 outline-blue-500 outline-offset-2":""}`,children:o==="play"?"Edit Mode":"Play Mode"}),r.jsx("button",{onClick:sa,className:"px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors",title:"Enter print mode to print your character sheet",children:"Print Mode"}),o==="play"&&r.jsx("button",{onClick:()=>a("vertical"),className:"px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"Vertical View"}),o==="edit"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{"data-tutorial":"add-widget-button",onClick:()=>{var ee;const D=X;oe(!X),x===4&&((ee=_e[4])==null?void 0:ee.id)==="add-widget"&&D&&j()},className:`px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors ${x===4?"ring-4 ring-blue-500 ring-offset-2":""}`,children:X?"Add Widget":"Hide Widgets"}),r.jsx("button",{onClick:()=>he(!H),className:"px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"Change Theme"}),r.jsx("button",{onClick:()=>te(!0),className:"px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-theme-ink text-xs font-body hover:bg-theme-accent hover:text-theme-paper transition-colors",children:"Auto Stack"})]}),r.jsx("button",{onClick:m,disabled:!b,className:`w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${b?"text-theme-ink hover:bg-theme-accent hover:text-theme-paper":"text-theme-muted opacity-50 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M3 7v6h6"}),r.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),r.jsx("button",{onClick:d,disabled:!k,className:`w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${k?"text-theme-ink hover:bg-theme-accent hover:text-theme-paper":"text-theme-muted opacity-50 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M21 7v6h-6"}),r.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"})]})})]}),r.jsx("div",{className:"flex-1 min-w-0 2xl:absolute 2xl:left-1/2 2xl:top-1/2 2xl:-translate-x-1/2 2xl:-translate-y-1/2 2xl:max-w-[30%] 2xl:flex-none pointer-events-auto",children:je?r.jsx("input",{type:"text",value:Se,onChange:D=>Qe(D.target.value),onBlur:()=>{Se.trim()&&i(C.id,Se.trim()),$e(!1)},onKeyDown:D=>{D.key==="Enter"?(Se.trim()&&i(C.id,Se.trim()),$e(!1)):D.key==="Escape"&&$e(!1)},autoFocus:!0,className:"font-bold text-sm bg-transparent border-b-[length:var(--border-width)] border-theme-border outline-none w-full text-theme-ink font-heading 2xl:text-center"}):r.jsx("h1",{className:`font-bold text-sm text-theme-ink font-heading truncate 2xl:text-center ${o==="edit"?"cursor-pointer":""}`,onClick:()=>{o==="edit"&&(Qe(C.name),$e(!0))},children:C.name})}),r.jsx("div",{className:"hidden 2xl:block 2xl:flex-1 2xl:min-w-0"}),r.jsx("div",{className:"relative shrink-0",children:r.jsxs("button",{onClick:()=>Ne(!ce),className:"h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-theme px-3 flex items-center gap-1 text-xs font-body",children:[r.jsx("span",{className:"text-theme-ink truncate max-w-[60px]",children:((R=C.sheets.find(D=>D.id===C.activeSheetId))==null?void 0:R.name)||"Sheet"}),r.jsx("span",{className:"text-theme-muted",children:""})]})}),r.jsx("button",{"data-tutorial":"fit-button",onClick:()=>{var D;mr(),x===12&&((D=_e[12])==null?void 0:D.id)==="fit-button"&&j()},className:`px-3 h-8 bg-theme-background border-[length:var(--border-width)] border-theme-border text-xs font-body flex items-center justify-center rounded-button text-theme-ink shrink-0 ${x===12?"outline outline-4 outline-blue-500 outline-offset-2":""}`,children:"Fit"}),r.jsxs("div",{className:"flex items-center gap-1 shrink-0 lg:hidden",children:[r.jsx("button",{onClick:m,disabled:!b,className:`w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${b?"text-theme-ink hover:bg-theme-accent hover:text-theme-paper":"text-theme-muted opacity-50 cursor-not-allowed"}`,title:"Undo",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M3 7v6h6"}),r.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),r.jsx("button",{onClick:d,disabled:!k,className:`w-8 h-8 flex items-center justify-center bg-theme-background border-[length:var(--border-width)] border-theme-border rounded-button text-xs font-body transition-colors ${k?"text-theme-ink hover:bg-theme-accent hover:text-theme-paper":"text-theme-muted opacity-50 cursor-not-allowed"}`,title:"Redo",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M21 7v6h-6"}),r.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"})]})})]})]}),K&&o!=="print"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"lg:hidden fixed inset-0 z-40",onClick:()=>Z(!1)}),r.jsxs("div",{className:"lg:hidden absolute top-12 left-2 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-theme overflow-hidden z-50 flex flex-col",children:[r.jsx("button",{"data-tutorial":"edit-mode-button-mobile",onClick:()=>{var ee,ve;const D=o==="play"?"edit":"play";a(D),Z(!1),x===3&&((ee=_e[3])==null?void 0:ee.id)==="welcome-sheet"&&D==="edit"&&j(),x===23&&((ve=_e[23])==null?void 0:ve.id)==="switch-to-play"&&D==="play"&&j()},className:`px-4 py-2.5 text-sm text-left font-body transition-colors whitespace-nowrap ${x===3&&o==="play"||x===23&&o==="edit"?"bg-blue-500 text-white font-bold":"text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,children:o==="play"?"Edit Mode":"Play Mode"}),r.jsx("button",{onClick:()=>{sa(),Z(!1)},className:"px-4 py-2.5 text-sm text-left font-body text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors whitespace-nowrap",children:"Print Mode"}),o==="play"&&r.jsx("button",{onClick:()=>{a("vertical"),Z(!1)},className:"px-4 py-2.5 text-sm text-left font-body text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors whitespace-nowrap",children:"Vertical View"}),o==="edit"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{"data-tutorial":"add-widget-button-mobile",onClick:()=>{var ee;const D=X;oe(!X),Z(!1),x===4&&((ee=_e[4])==null?void 0:ee.id)==="add-widget"&&D&&j()},className:`px-4 py-2.5 text-sm text-left font-body transition-colors whitespace-nowrap ${x===4?"bg-blue-500 text-white font-bold":"text-theme-ink hover:bg-theme-accent hover:text-theme-paper"}`,children:X?"Add Widget":"Hide Toolbox"}),r.jsx("button",{onClick:()=>{he(!H),Z(!1)},className:"px-4 py-2.5 text-sm text-left font-body text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors whitespace-nowrap",children:H?"Change Theme":"Hide Themes"}),r.jsx("button",{onClick:()=>{te(!0),Z(!1)},className:"px-4 py-2.5 text-sm text-left font-body text-theme-ink hover:bg-theme-accent hover:text-theme-paper transition-colors whitespace-nowrap",children:"Auto Stack"})]}),r.jsx("button",{onClick:()=>{s(null),Z(!1)},className:"px-4 py-2.5 text-sm text-left font-body text-red-500 hover:bg-red-500 hover:text-white transition-colors border-t border-theme-border/50 whitespace-nowrap",children:"Exit to Menu"})]})]}),ce&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>Ne(!1)}),r.jsxs("div",{className:"absolute top-12 right-2 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-theme overflow-hidden z-50 min-w-[150px]",children:[C.sheets.map(D=>r.jsx("div",{className:"group relative",children:Ae===D.id?r.jsx("input",{type:"text",value:ae,onChange:ee=>de(ee.target.value),onBlur:()=>{ae.trim()&&w(D.id,ae.trim()),G(null)},onKeyDown:ee=>{ee.key==="Enter"?(ae.trim()&&w(D.id,ae.trim()),G(null)):ee.key==="Escape"&&G(null)},autoFocus:!0,onClick:ee=>ee.stopPropagation(),className:"w-full px-3 py-2 text-xs bg-transparent border-b border-theme-border outline-none text-theme-ink font-body"}):r.jsxs("button",{onClick:()=>{g(D.id),Ne(!1)},className:`w-full px-3 py-2 text-xs text-left font-body transition-colors flex items-center justify-between ${D.id===C.activeSheetId?"bg-theme-accent text-theme-paper":"text-theme-ink hover:bg-theme-accent/20"}`,children:[r.jsx("span",{children:D.name}),o==="edit"&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{onClick:ee=>{ee.stopPropagation(),de(D.name),G(D.id)},className:`w-5 h-5 rounded-full text-xs flex items-center justify-center ${D.id===C.activeSheetId?"bg-theme-paper/30 text-theme-paper hover:bg-theme-paper/50":"bg-theme-accent/20 text-theme-ink hover:bg-theme-accent/40"}`,children:""}),C.sheets.length>1&&r.jsx("span",{onClick:ee=>{ee.stopPropagation(),Q(D.id)},className:"w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-red-600",children:""})]})]})},D.id)),o==="edit"&&r.jsx("button",{onClick:()=>{h(`Sheet ${C.sheets.length+1}`),Ne(!1)},className:"w-full px-3 py-2 text-xs text-theme-muted hover:text-theme-ink hover:bg-theme-accent/20 text-left font-body border-t border-theme-border/50 transition-colors",children:"+ Add New Sheet"})]})]}),Te&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>Q(null)}),r.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-theme p-4 z-50 min-w-[250px]",children:[r.jsx("h3",{className:"font-heading text-theme-ink font-bold mb-2",children:"Delete Sheet?"}),r.jsxs("p",{className:"text-sm text-theme-muted font-body mb-4",children:['Are you sure you want to delete "',(se=C.sheets.find(D=>D.id===Te))==null?void 0:se.name,'"? This will delete all widgets on this sheet.']}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>Q(null),className:"px-3 py-1.5 text-sm font-body text-theme-ink hover:bg-theme-accent/20 rounded-button transition-colors",children:"Cancel"}),r.jsx("button",{onClick:()=>{f(Te),Q(null),Ne(!1)},className:"px-3 py-1.5 text-sm font-body bg-red-500 text-white hover:bg-red-600 rounded-button transition-colors",children:"Delete"})]})]})]}),re&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>te(!1)}),r.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-theme-paper border-[length:var(--border-width)] border-theme-border shadow-theme rounded-theme p-4 z-50 min-w-[250px]",children:[r.jsx("h3",{className:"font-heading text-theme-ink font-bold mb-2",children:"Auto Stack?"}),r.jsx("p",{className:"text-sm text-theme-muted font-body mb-4",children:"This will automatically rearrange all widgets on this sheet. Your current layout will be replaced."}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>te(!1),className:"px-3 py-1.5 text-sm font-body text-theme-ink hover:bg-theme-accent/20 rounded-button transition-colors",children:"Cancel"}),r.jsx("button",{onClick:()=>{tn(),te(!1)},className:"px-3 py-1.5 text-sm font-body bg-theme-accent text-theme-paper hover:bg-theme-accent-hover rounded-button transition-colors",children:"Auto Stack"})]})]})]}),E&&r.jsx(tf,{darkMode:J})]})}function vv(){const e=q(t=>t.activeCharacterId);return r.jsx("div",{className:"h-full bg-gray-100 text-ink font-mono overflow-hidden",children:e?r.jsx(bv,{}):r.jsx(Mb,{})})}Fr("default");xl.createRoot(document.getElementById("root")).render(r.jsx(xi.StrictMode,{children:r.jsx(vv,{})}));
